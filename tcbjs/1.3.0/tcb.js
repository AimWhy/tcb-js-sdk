!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("tcb",[],t):"object"==typeof exports?exports.tcb=t():e.tcb=t()}(window,function(){return function(e){var t=window.webpackHotUpdatetcb;window.webpackHotUpdatetcb=function(e,n){!function(e,t){if(!w[e]||!v[e])return;for(var n in v[e]=!1,t)Object.prototype.hasOwnProperty.call(t,n)&&(g[n]=t[n]);0==--y&&0===m&&T()}(e,n),t&&t(e,n)};var n,r=!0,o="1ab711274b070aadf68b",i=1e4,s={},a=[],c=[];function u(e){var t=N[e];if(!t)return I;var r=function(r){return t.hot.active?(N[r]?-1===N[r].parents.indexOf(e)&&N[r].parents.push(e):(a=[e],n=r),-1===t.children.indexOf(r)&&t.children.push(r)):(console.warn("[HMR] unexpected require("+r+") from disposed module "+e),a=[]),I(r)},o=function(e){return{configurable:!0,enumerable:!0,get:function(){return I[e]},set:function(t){I[e]=t}}};for(var i in I)Object.prototype.hasOwnProperty.call(I,i)&&"e"!==i&&"t"!==i&&Object.defineProperty(r,i,o(i));return r.e=function(e){return"ready"===h&&d("prepare"),m++,I.e(e).then(t,function(e){throw t(),e});function t(){m--,"prepare"===h&&(b[e]||O(e),0===m&&0===y&&T())}},r.t=function(e,t){return 1&t&&(e=r(e)),I.t(e,-2&t)},r}function f(e){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:n!==e,active:!0,accept:function(e,n){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var r=0;r<e.length;r++)t._acceptedDependencies[e[r]]=n||function(){};else t._acceptedDependencies[e]=n||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var n=0;n<e.length;n++)t._declinedDependencies[e[n]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var n=t._disposeHandlers.indexOf(e);n>=0&&t._disposeHandlers.splice(n,1)},check:S,apply:A,status:function(e){if(!e)return h;l.push(e)},addStatusHandler:function(e){l.push(e)},removeStatusHandler:function(e){var t=l.indexOf(e);t>=0&&l.splice(t,1)},data:s[e]};return n=void 0,t}var l=[],h="idle";function d(e){h=e;for(var t=0;t<l.length;t++)l[t].call(null,e)}var p,g,_,y=0,m=0,b={},v={},w={};function E(e){return+e+""===e?+e:e}function S(e){if("idle"!==h)throw new Error("check() is only allowed in idle status");return r=e,d("check"),(t=i,t=t||1e4,new Promise(function(e,n){if("undefined"==typeof XMLHttpRequest)return n(new Error("No browser support"));try{var r=new XMLHttpRequest,i=I.p+""+o+".hot-update.json";r.open("GET",i,!0),r.timeout=t,r.send(null)}catch(e){return n(e)}r.onreadystatechange=function(){if(4===r.readyState)if(0===r.status)n(new Error("Manifest request to "+i+" timed out."));else if(404===r.status)e();else if(200!==r.status&&304!==r.status)n(new Error("Manifest request to "+i+" failed."));else{try{var t=JSON.parse(r.responseText)}catch(e){return void n(e)}e(t)}}})).then(function(e){if(!e)return d("idle"),null;v={},b={},w=e.c,_=e.h,d("prepare");var t=new Promise(function(e,t){p={resolve:e,reject:t}});g={};return O(0),"prepare"===h&&0===m&&0===y&&T(),t});var t}function O(e){w[e]?(v[e]=!0,y++,function(e){var t=document.createElement("script");t.charset="utf-8",t.src=I.p+""+e+"."+o+".hot-update.js",document.head.appendChild(t)}(e)):b[e]=!0}function T(){d("ready");var e=p;if(p=null,e)if(r)Promise.resolve().then(function(){return A(r)}).then(function(t){e.resolve(t)},function(t){e.reject(t)});else{var t=[];for(var n in g)Object.prototype.hasOwnProperty.call(g,n)&&t.push(E(n));e.resolve(t)}}function A(t){if("ready"!==h)throw new Error("apply() is only allowed in ready status");var n,r,i,c,u;function f(e){for(var t=[e],n={},r=t.map(function(e){return{chain:[e],id:e}});r.length>0;){var o=r.pop(),i=o.id,s=o.chain;if((c=N[i])&&!c.hot._selfAccepted){if(c.hot._selfDeclined)return{type:"self-declined",chain:s,moduleId:i};if(c.hot._main)return{type:"unaccepted",chain:s,moduleId:i};for(var a=0;a<c.parents.length;a++){var u=c.parents[a],f=N[u];if(f){if(f.hot._declinedDependencies[i])return{type:"declined",chain:s.concat([u]),moduleId:i,parentId:u};-1===t.indexOf(u)&&(f.hot._acceptedDependencies[i]?(n[u]||(n[u]=[]),l(n[u],[i])):(delete n[u],t.push(u),r.push({chain:s.concat([u]),id:u})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];-1===e.indexOf(r)&&e.push(r)}}t=t||{};var p={},y=[],m={},b=function(){console.warn("[HMR] unexpected require("+S.moduleId+") to disposed module")};for(var v in g)if(Object.prototype.hasOwnProperty.call(g,v)){var S;u=E(v);var O=!1,T=!1,A=!1,B="";switch((S=g[v]?f(u):{type:"disposed",moduleId:v}).chain&&(B="\nUpdate propagation: "+S.chain.join(" -> ")),S.type){case"self-declined":t.onDeclined&&t.onDeclined(S),t.ignoreDeclined||(O=new Error("Aborted because of self decline: "+S.moduleId+B));break;case"declined":t.onDeclined&&t.onDeclined(S),t.ignoreDeclined||(O=new Error("Aborted because of declined dependency: "+S.moduleId+" in "+S.parentId+B));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(S),t.ignoreUnaccepted||(O=new Error("Aborted because "+u+" is not accepted"+B));break;case"accepted":t.onAccepted&&t.onAccepted(S),T=!0;break;case"disposed":t.onDisposed&&t.onDisposed(S),A=!0;break;default:throw new Error("Unexception type "+S.type)}if(O)return d("abort"),Promise.reject(O);if(T)for(u in m[u]=g[u],l(y,S.outdatedModules),S.outdatedDependencies)Object.prototype.hasOwnProperty.call(S.outdatedDependencies,u)&&(p[u]||(p[u]=[]),l(p[u],S.outdatedDependencies[u]));A&&(l(y,[S.moduleId]),m[u]=b)}var R,D=[];for(r=0;r<y.length;r++)u=y[r],N[u]&&N[u].hot._selfAccepted&&m[u]!==b&&D.push({module:u,errorHandler:N[u].hot._selfAccepted});d("dispose"),Object.keys(w).forEach(function(e){!1===w[e]&&function(e){delete installedChunks[e]}(e)});for(var x,P,C=y.slice();C.length>0;)if(u=C.pop(),c=N[u]){var j={},L=c.hot._disposeHandlers;for(i=0;i<L.length;i++)(n=L[i])(j);for(s[u]=j,c.hot.active=!1,delete N[u],delete p[u],i=0;i<c.children.length;i++){var k=N[c.children[i]];k&&((R=k.parents.indexOf(u))>=0&&k.parents.splice(R,1))}}for(u in p)if(Object.prototype.hasOwnProperty.call(p,u)&&(c=N[u]))for(P=p[u],i=0;i<P.length;i++)x=P[i],(R=c.children.indexOf(x))>=0&&c.children.splice(R,1);for(u in d("apply"),o=_,m)Object.prototype.hasOwnProperty.call(m,u)&&(e[u]=m[u]);var $=null;for(u in p)if(Object.prototype.hasOwnProperty.call(p,u)&&(c=N[u])){P=p[u];var M=[];for(r=0;r<P.length;r++)if(x=P[r],n=c.hot._acceptedDependencies[x]){if(-1!==M.indexOf(n))continue;M.push(n)}for(r=0;r<M.length;r++){n=M[r];try{n(P)}catch(e){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:u,dependencyId:P[r],error:e}),t.ignoreErrored||$||($=e)}}}for(r=0;r<D.length;r++){var U=D[r];u=U.module,a=[u];try{I(u)}catch(e){if("function"==typeof U.errorHandler)try{U.errorHandler(e)}catch(n){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:u,error:n,originalError:e}),t.ignoreErrored||$||($=n),$||($=e)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:u,error:e}),t.ignoreErrored||$||($=e)}}return $?(d("fail"),Promise.reject($)):(d("idle"),new Promise(function(e){e(y)}))}var N={};function I(t){if(N[t])return N[t].exports;var n=N[t]={i:t,l:!1,exports:{},hot:f(t),parents:(c=a,a=[],c),children:[]};return e[t].call(n.exports,n,n.exports,u(t)),n.l=!0,n.exports}return I.m=e,I.c=N,I.d=function(e,t,n){I.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},I.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},I.t=function(e,t){if(1&t&&(e=I(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(I.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)I.d(n,r,function(t){return e[t]}.bind(null,r));return n},I.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return I.d(t,"a",t),t},I.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},I.p="",I.h=function(){return o},u(80)(I.s=80)}([function(e,t,n){e.exports=n(99)},function(e,t){function n(e,t,n,r,o,i,s){try{var a=e[i](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise(function(o,i){var s=e.apply(t,r);function a(e){n(s,o,i,a,c,"next",e)}function c(e){n(s,o,i,a,c,"throw",e)}a(void 0)})}}},function(e,t,n){"use strict";var r=n(47),o=n(84),i=Object.prototype.toString;function s(e){return"[object Array]"===i.call(e)}function a(e){return null!==e&&"object"==typeof e}function c(e){return"[object Function]"===i.call(e)}function u(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),s(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}e.exports={isArray:s,isArrayBuffer:function(e){return"[object ArrayBuffer]"===i.call(e)},isBuffer:o,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:c,isStream:function(e){return a(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:u,merge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]=n}for(var r=0,o=arguments.length;r<o;r++)u(arguments[r],n);return t},deepMerge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]="object"==typeof n?e({},n):n}for(var r=0,o=arguments.length;r<o;r++)u(arguments[r],n);return t},extend:function(e,t,n){return u(t,function(t,o){e[o]=n&&"function"==typeof t?r(t,n):t}),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i});var r=function(e,t){var n=t.split("?")[0],r=[],o=-1!==t.indexOf("?")?t.split("?")[1]:"";if(""!==o){for(var i=(r=o.split("&")).length-1;i>=0;i-=1)r[i].split("=")[0]===e&&r.splice(i,1);n=n+"?"+r.join("&")}return n},o=function(){var e;if(!Promise){(e=function(){}).promise={};var t=function(){throw new Error('Your Node runtime does support ES6 Promises. Set "global.Promise" to your preferred implementation of promises.')};return Object.defineProperty(e.promise,"then",{get:t}),Object.defineProperty(e.promise,"catch",{get:t}),e}var n=new Promise(function(t,n){e=function(e,r){return e?n(e):t(r)}});return e.promise=n,e},i=function(){return function(e,t){if("undefined"==typeof window)return!1;var n=t||window.location.search,r=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),o=n.substr(n.indexOf("?")+1).match(r);return null!=o?o[2]:""}("code")||(e="code",(t=window.location.hash.match(new RegExp("[#?&/]".concat(e,"=([^&#]*)"))))?t[1]:"");var e,t}},function(e,t,n){var r=n(58),o="object"==typeof self&&self&&self.Object===Object&&self,i=r||o||Function("return this")();e.exports=i},function(e,t,n){"use strict";n.d(t,"a",function(){return w});var r=n(16),o=n.n(r),i=n(0),s=n.n(i),a=n(1),c=n.n(a),u=n(3),f=n.n(u),l=n(4),h=n.n(l),d=n(20),p=n.n(d),g=n(9),_=n(28),y=n(12);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(n,!0).forEach(function(t){o()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var v=["auth.getJwt","auth.logout","auth.signInWithTicket"],w=function(){function e(t){f()(this,e),this.config=t,this.cache=new _.a(t.persistence),this.accessTokenKey="".concat(g.a,"_").concat(t.env),this.accessTokenExpireKey="".concat(g.b,"_").concat(t.env),this.refreshTokenKey="".concat(g.d,"_").concat(t.env)}var t,n,r,o;return h()(e,[{key:"refreshAccessToken",value:(o=c()(s.a.mark(function e(){var t,n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.cache.removeStore(this.accessTokenKey),this.cache.removeStore(this.accessTokenExpireKey),t=this.cache.getStore(this.refreshTokenKey)){e.next=5;break}throw new Error("[tcb-js-sdk] 未登录CloudBase");case 5:return e.next=7,this.request("auth.getJwt",{refresh_token:t});case 7:if("SIGN_PARAM_INVALID"!==(n=e.sent).data.code&&"REFRESH_TOKEN_EXPIRED"!==n.data.code){e.next=12;break}throw Object(y.a)("loginStateExpire"),this.cache.removeStore(this.refreshTokenKey),new Error("[tcb-js-sdk] 刷新access token失败：".concat(n.data.code));case 12:if(!n.data.access_token){e.next=17;break}return Object(y.a)("refreshAccessToken"),this.cache.setStore(this.accessTokenKey,n.data.access_token),this.cache.setStore(this.accessTokenExpireKey,n.data.access_token_expire+Date.now()),e.abrupt("return",{accessToken:n.data.access_token,accessTokenExpire:n.data.access_token_expire});case 17:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)})},{key:"getAccessToken",value:(r=c()(s.a.mark(function e(){var t,n,r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.cache.getStore(this.accessTokenKey),n=this.cache.getStore(this.accessTokenExpireKey),r=!0,e.t0=this._shouldRefreshAccessTokenHook,!e.t0){e.next=8;break}return e.next=7,this._shouldRefreshAccessTokenHook(t,n);case 7:e.t0=!e.sent;case 8:if(!e.t0){e.next=10;break}r=!1;case 10:if(t&&n&&!(n<Date.now())||!r){e.next=14;break}return e.abrupt("return",this.refreshAccessToken());case 14:return e.abrupt("return",{accessToken:t,accessTokenExpire:n});case 15:case"end":return e.stop()}},e,this)})),function(){return r.apply(this,arguments)})},{key:"request",value:(n=c()(s.a.mark(function e(t,n,r){var o,i,a,c,u,f,l;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o="application/x-www-form-urlencoded",i=b({action:t,env:this.config.env,dataVersion:"2019-08-16"},n),-1!==v.indexOf(t)){e.next=6;break}return e.next=5,this.getAccessToken();case 5:i.access_token=e.sent.accessToken;case 6:if("storage.uploadFile"===t){for(c in a=new FormData)a.hasOwnProperty(c)&&void 0!==a[c]&&a.append(c,i[c]);o="multipart/form-data"}else o="application/json;charset=UTF-8",a=i;return u={headers:{"content-type":o}},r&&r.onUploadProgress&&(u.onUploadProgress=r.onUploadProgress),f="".concat(g.c,"?env=").concat(this.config.env),e.next=12,p.a.post(f,a,u);case 12:if(l=e.sent,200===Number(l.status)&&l.data){e.next=15;break}throw new Error("network request error");case 15:return e.abrupt("return",l);case 16:case"end":return e.stop()}},e,this)})),function(e,t,r){return n.apply(this,arguments)})},{key:"send",value:(t=c()(s.a.mark(function e(t){var n,r,o,i,a=arguments;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:{},r=setTimeout(function(){console.warn("Database operation is longer than 3s. Please check query performance and your network environment.")},3e3),e.next=4,this.request(t,n,{onUploadProgress:n.onUploadProgress});case 4:if(o=e.sent,clearTimeout(r),"ACCESS_TOKEN_EXPIRED"!==o.data.code||-1!==v.indexOf(t)){e.next=15;break}return e.next=9,this.refreshAccessToken();case 9:return e.next=11,this.request(t,n,{onUploadProgress:n.onUploadProgress});case 11:if(!(i=e.sent).data.code){e.next=14;break}throw new Error("[".concat(i.data.code,"] ").concat(i.data.message));case 14:return e.abrupt("return",i.data);case 15:if(!o.data.code){e.next=17;break}throw new Error("[".concat(o.data.code,"] ").concat(o.data.message));case 17:return e.abrupt("return",o.data);case 18:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})}]),e}()},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var r=n(102),o=n(103),i=n(104);function s(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return l(this,e)}return u(this,e,t,n)}function u(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=h(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(t,n),o=(e=a(e,r)).write(t,n);o!==r&&(e=e.slice(0,o));return e}(e,t,n):function(e,t){if(c.isBuffer(t)){var n=0|d(t.length);return 0===(e=a(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?a(e,0):h(e,t);if("Buffer"===t.type&&i(t.data))return h(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function f(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function l(e,t){if(f(t),e=a(e,t<0?0:0|d(t)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function h(e,t){var n=t.length<0?0:0|d(t.length);e=a(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function d(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function p(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return F(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return z(e).length;default:if(r)return F(e).length;t=(""+t).toLowerCase(),r=!0}}function g(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,n);case"utf8":case"utf-8":return A(this,t,n);case"ascii":return I(this,t,n);case"latin1":case"binary":return B(this,t,n);case"base64":return T(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function _(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function y(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:m(e,t,n,r,o);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):m(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function m(e,t,n,r,o){var i,s=1,a=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,n/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(o){var f=-1;for(i=n;i<a;i++)if(u(e,i)===u(t,-1===f?0:i-f)){if(-1===f&&(f=i),i-f+1===c)return f*s}else-1!==f&&(i-=i-f),f=-1}else for(n+c>a&&(n=a-c),i=n;i>=0;i--){for(var l=!0,h=0;h<c;h++)if(u(e,i+h)!==u(t,h)){l=!1;break}if(l)return i}return-1}function b(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var s=0;s<r;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[n+s]=a}return s}function v(e,t,n,r){return q(F(t,e.length-n),e,n,r)}function w(e,t,n,r){return q(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function E(e,t,n,r){return w(e,t,n,r)}function S(e,t,n,r){return q(z(t),e,n,r)}function O(e,t,n,r){return q(function(e,t){for(var n,r,o,i=[],s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,o=n%256,i.push(o),i.push(r);return i}(t,e.length-n),e,n,r)}function T(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function A(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i,s,a,c,u=e[o],f=null,l=u>239?4:u>223?3:u>191?2:1;if(o+l<=n)switch(l){case 1:u<128&&(f=u);break;case 2:128==(192&(i=e[o+1]))&&(c=(31&u)<<6|63&i)>127&&(f=c);break;case 3:i=e[o+1],s=e[o+2],128==(192&i)&&128==(192&s)&&(c=(15&u)<<12|(63&i)<<6|63&s)>2047&&(c<55296||c>57343)&&(f=c);break;case 4:i=e[o+1],s=e[o+2],a=e[o+3],128==(192&i)&&128==(192&s)&&128==(192&a)&&(c=(15&u)<<18|(63&i)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(f=c)}null===f?(f=65533,l=1):f>65535&&(f-=65536,r.push(f>>>10&1023|55296),f=56320|1023&f),r.push(f),o+=l}return function(e){var t=e.length;if(t<=N)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=N));return n}(r)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,n){return u(null,e,t,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,n){return function(e,t,n,r){return f(t),t<=0?a(e,t):void 0!==n?"string"==typeof r?a(e,t).fill(n,r):a(e,t).fill(n):a(e,t)}(null,e,t,n)},c.allocUnsafe=function(e){return l(null,e)},c.allocUnsafeSlow=function(e){return l(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!i(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=c.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var s=e[n];if(!c.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,o),o+=s.length}return r},c.byteLength=p,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)_(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)_(this,t,t+3),_(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)_(this,t,t+7),_(this,t+1,t+6),_(this,t+2,t+5),_(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?A(this,0,e):g.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,r,o){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(this===e)return 0;for(var i=(o>>>=0)-(r>>>=0),s=(n>>>=0)-(t>>>=0),a=Math.min(i,s),u=this.slice(r,o),f=e.slice(t,n),l=0;l<a;++l)if(u[l]!==f[l]){i=u[l],s=f[l];break}return i<s?-1:s<i?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return y(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return y(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return b(this,e,t,n);case"utf8":case"utf-8":return v(this,e,t,n);case"ascii":return w(this,e,t,n);case"latin1":case"binary":return E(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var N=4096;function I(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function B(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function R(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=t;i<n;++i)o+=U(e[i]);return o}function D(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function x(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function P(e,t,n,r,o,i){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function C(e,t,n,r){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-n,2);o<i;++o)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function j(e,t,n,r){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-n,4);o<i;++o)e[n+o]=t>>>8*(r?o:3-o)&255}function L(e,t,n,r,o,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function k(e,t,n,r,i){return i||L(e,0,n,4),o.write(e,t,n,r,23,4),n+4}function $(e,t,n,r,i){return i||L(e,0,n,8),o.write(e,t,n,r,52,8),n+8}c.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=c.prototype;else{var o=t-e;n=new c(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+e]}return n},c.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||x(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},c.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||x(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},c.prototype.readUInt8=function(e,t){return t||x(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||x(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||x(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||x(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||x(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||x(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||x(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},c.prototype.readInt8=function(e,t){return t||x(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||x(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){t||x(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return t||x(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||x(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||x(e,4,this.length),o.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||x(e,4,this.length),o.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||x(e,8,this.length),o.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||x(e,8,this.length),o.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||P(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},c.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||P(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+n},c.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):C(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):C(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):j(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):j(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);P(this,e,t,n,o-1,-o)}var i=0,s=1,a=0;for(this[t]=255&e;++i<n&&(s*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);P(this,e,t,n,o-1,-o)}var i=n-1,s=1,a=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):C(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):C(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):j(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):j(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,n){return k(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return k(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return $(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return $(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,i=r-n;if(this===e&&n<t&&t<r)for(o=i-1;o>=0;--o)e[o+t]=this[o+n];else if(i<1e3||!c.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},c.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var s=c.isBuffer(e)?e:F(new c(e,r).toString()),a=s.length;for(i=0;i<n-t;++i)this[i+t]=s[i%a]}return this};var M=/[^+\/0-9A-Za-z-_]/g;function U(e){return e<16?"0"+e.toString(16):e.toString(16)}function F(e,t){var n;t=t||1/0;for(var r=e.length,o=null,i=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function z(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(M,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function q(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}}).call(this,n(32))},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"d",function(){return i}),n.d(t,"c",function(){return s});var r="access_token",o="access_token_expire",i="refresh_token",s="//tcb-api.tencentcloudapi.com/web"},function(module,__webpack_exports__,__webpack_require__){"use strict";(function(global,Buffer){__webpack_require__.d(__webpack_exports__,"a",function(){return bson_54});var long__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(17),long__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(long__WEBPACK_IMPORTED_MODULE_0__),buffer__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(8),buffer__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(buffer__WEBPACK_IMPORTED_MODULE_1__),commonjsGlobal="undefined"!=typeof window?window:void 0!==global?global:"undefined"!=typeof self?self:{};function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var map=createCommonjsModule(function(e){if(void 0!==commonjsGlobal.Map)e.exports=commonjsGlobal.Map,e.exports.Map=commonjsGlobal.Map;else{var t=function(e){this._keys=[],this._values={};for(var t=0;t<e.length;t++)if(null!=e[t]){var n=e[t],r=n[0],o=n[1];this._keys.push(r),this._values[r]={v:o,i:this._keys.length-1}}};t.prototype.clear=function(){this._keys=[],this._values={}},t.prototype.delete=function(e){var t=this._values[e];return null!=t&&(delete this._values[e],this._keys.splice(t.i,1),!0)},t.prototype.entries=function(){var e=this,t=0;return{next:function(){var n=e._keys[t++];return{value:void 0!==n?[n,e._values[n].v]:void 0,done:void 0===n}}}},t.prototype.forEach=function(e,t){t=t||this;for(var n=0;n<this._keys.length;n++){var r=this._keys[n];e.call(t,this._values[r].v,r,t)}},t.prototype.get=function(e){return this._values[e]?this._values[e].v:void 0},t.prototype.has=function(e){return null!=this._values[e]},t.prototype.keys=function(){var e=this,t=0;return{next:function(){var n=e._keys[t++];return{value:void 0!==n?n:void 0,done:void 0===n}}}},t.prototype.set=function(e,t){return this._values[e]?(this._values[e].v=t,this):(this._keys.push(e),this._values[e]={v:t,i:this._keys.length-1},this)},t.prototype.values=function(){var e=this,t=0;return{next:function(){var n=e._keys[t++];return{value:void 0!==n?e._values[n].v:void 0,done:void 0===n}}}},Object.defineProperty(t.prototype,"size",{enumerable:!0,get:function(){return this._keys.length}}),e.exports=t}}),map_1=map.Map;long__WEBPACK_IMPORTED_MODULE_0___default.a.prototype.toExtendedJSON=function(e){return e&&e.relaxed?this.toNumber():{$numberLong:this.toString()}},long__WEBPACK_IMPORTED_MODULE_0___default.a.fromExtendedJSON=function(e,t){var n=long__WEBPACK_IMPORTED_MODULE_0___default.a.fromString(e.$numberLong);return t&&t.relaxed?n.toNumber():n},Object.defineProperty(long__WEBPACK_IMPORTED_MODULE_0___default.a.prototype,"_bsontype",{value:"Long"});var long_1=long__WEBPACK_IMPORTED_MODULE_0___default.a;function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var Double=function(){function e(t){_classCallCheck(this,e),this.value=t}return _createClass(e,[{key:"valueOf",value:function(){return this.value}},{key:"toJSON",value:function(){return this.value}},{key:"toExtendedJSON",value:function(e){return e&&e.relaxed&&isFinite(this.value)?this.value:{$numberDouble:this.value.toString()}}}],[{key:"fromExtendedJSON",value:function(t,n){return n&&n.relaxed?parseFloat(t.$numberDouble):new e(parseFloat(t.$numberDouble))}}]),e}();Object.defineProperty(Double.prototype,"_bsontype",{value:"Double"});var double_1=Double;function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$1(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$1(e,t,n){return t&&_defineProperties$1(e.prototype,t),n&&_defineProperties$1(e,n),e}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Timestamp=function(e){function t(e,n){var r;return _classCallCheck$1(this,t),r=long_1.isLong(e)?_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e.low,e.high)):_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n)),_possibleConstructorReturn(r)}return _inherits(t,long_1),_createClass$1(t,[{key:"toJSON",value:function(){return{$timestamp:this.toString()}}},{key:"toExtendedJSON",value:function(){return{$timestamp:{t:this.high,i:this.low}}}}],[{key:"fromInt",value:function(e){return new t(long_1.fromInt(e))}},{key:"fromNumber",value:function(e){return new t(long_1.fromNumber(e))}},{key:"fromBits",value:function(e,n){return new t(e,n)}},{key:"fromString",value:function(e,n){return new t(long_1.fromString(e,n))}},{key:"fromExtendedJSON",value:function(e){return new t(e.$timestamp.i,e.$timestamp.t)}}]),t}();Object.defineProperty(Timestamp.prototype,"_bsontype",{value:"Timestamp"});var timestamp=Timestamp,require$$0={};function normalizedFunctionString(e){return e.toString().replace("function(","function (")}function insecureRandomBytes(e){for(var t=new Uint8Array(e),n=0;n<e;++n)t[n]=Math.floor(256*Math.random());return t}var randomBytes=insecureRandomBytes;if("undefined"!=typeof window&&window.crypto&&window.crypto.getRandomValues)randomBytes=function(e){return window.crypto.getRandomValues(new Uint8Array(e))};else{try{randomBytes=require$$0.randomBytes}catch(e){}null==randomBytes&&(randomBytes=insecureRandomBytes)}var utils={normalizedFunctionString:normalizedFunctionString,randomBytes:randomBytes};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}var cachedSetTimeout=defaultSetTimout,cachedClearTimeout=defaultClearTimeout;function runTimeout(e){if(cachedSetTimeout===setTimeout)return setTimeout(e,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(e,0);try{return cachedSetTimeout(e,0)}catch(t){try{return cachedSetTimeout.call(null,e,0)}catch(t){return cachedSetTimeout.call(this,e,0)}}}function runClearTimeout(e){if(cachedClearTimeout===clearTimeout)return clearTimeout(e);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(e);try{return cachedClearTimeout(e)}catch(t){try{return cachedClearTimeout.call(null,e)}catch(t){return cachedClearTimeout.call(this,e)}}}"function"==typeof global.setTimeout&&(cachedSetTimeout=setTimeout),"function"==typeof global.clearTimeout&&(cachedClearTimeout=clearTimeout);var queue=[],draining=!1,currentQueue,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var e=runTimeout(cleanUpNextTick);draining=!0;for(var t=queue.length;t;){for(currentQueue=queue,queue=[];++queueIndex<t;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,t=queue.length}currentQueue=null,draining=!1,runClearTimeout(e)}}function nextTick(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];queue.push(new Item(e,t)),1!==queue.length||draining||runTimeout(drainQueue)}function Item(e,t){this.fun=e,this.array=t}Item.prototype.run=function(){this.fun.apply(null,this.array)};var title="browser",platform="browser",browser=!0,env={},argv=[],version="",versions={},release={},config={};function noop(){}var on=noop,addListener=noop,once=noop,off=noop,removeListener=noop,removeAllListeners=noop,emit=noop;function binding(e){throw new Error("process.binding is not supported")}function cwd(){return"/"}function chdir(e){throw new Error("process.chdir is not supported")}function umask(){return 0}var performance=global.performance||{},performanceNow=performance.now||performance.mozNow||performance.msNow||performance.oNow||performance.webkitNow||function(){return(new Date).getTime()};function hrtime(e){var t=.001*performanceNow.call(performance),n=Math.floor(t),r=Math.floor(t%1*1e9);return e&&(n-=e[0],(r-=e[1])<0&&(n--,r+=1e9)),[n,r]}var startTime=new Date;function uptime(){return(new Date-startTime)/1e3}var process={nextTick:nextTick,title:title,browser:browser,env:env,argv:argv,version:version,versions:versions,on:on,addListener:addListener,once:once,off:off,removeListener:removeListener,removeAllListeners:removeAllListeners,emit:emit,binding:binding,cwd:cwd,chdir:chdir,umask:umask,hrtime:hrtime,platform:platform,release:release,config:config,uptime:uptime},inherits;inherits="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e};var inherits$1=inherits;function _typeof$1(e){return(_typeof$1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var formatRegExp=/%[sdj%]/g;function format(e){if(!isString(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(inspect(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,o=r.length,i=String(e).replace(formatRegExp,function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}}),s=r[n];n<o;s=r[++n])isNull(s)||!isObject(s)?i+=" "+s:i+=" "+inspect(s);return i}function deprecate(e,t){if(isUndefined(global.process))return function(){return deprecate(e,t).apply(this,arguments)};var n=!1;return function(){return n||(console.error(t),n=!0),e.apply(this,arguments)}}var debugs={},debugEnviron;function debuglog(e){if(isUndefined(debugEnviron)&&(debugEnviron=process.env.NODE_DEBUG||""),e=e.toUpperCase(),!debugs[e])if(new RegExp("\\b"+e+"\\b","i").test(debugEnviron)){debugs[e]=function(){var t=format.apply(null,arguments);console.error("%s %d: %s",e,0,t)}}else debugs[e]=function(){};return debugs[e]}function inspect(e,t){var n={seen:[],stylize:stylizeNoColor};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),isBoolean(t)?n.showHidden=t:t&&_extend(n,t),isUndefined(n.showHidden)&&(n.showHidden=!1),isUndefined(n.depth)&&(n.depth=2),isUndefined(n.colors)&&(n.colors=!1),isUndefined(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=stylizeWithColor),formatValue(n,e,n.depth)}function stylizeWithColor(e,t){var n=inspect.styles[t];return n?"["+inspect.colors[n][0]+"m"+e+"["+inspect.colors[n][1]+"m":e}function stylizeNoColor(e,t){return e}function arrayToHash(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}function formatValue(e,t,n){if(e.customInspect&&t&&isFunction(t.inspect)&&t.inspect!==inspect&&(!t.constructor||t.constructor.prototype!==t)){var r=t.inspect(n,e);return isString(r)||(r=formatValue(e,r,n)),r}var o=formatPrimitive(e,t);if(o)return o;var i=Object.keys(t),s=arrayToHash(i);if(e.showHidden&&(i=Object.getOwnPropertyNames(t)),isError(t)&&(i.indexOf("message")>=0||i.indexOf("description")>=0))return formatError(t);if(0===i.length){if(isFunction(t)){var a=t.name?": "+t.name:"";return e.stylize("[Function"+a+"]","special")}if(isRegExp(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(isDate(t))return e.stylize(Date.prototype.toString.call(t),"date");if(isError(t))return formatError(t)}var c,u="",f=!1,l=["{","}"];(isArray(t)&&(f=!0,l=["[","]"]),isFunction(t))&&(u=" [Function"+(t.name?": "+t.name:"")+"]");return isRegExp(t)&&(u=" "+RegExp.prototype.toString.call(t)),isDate(t)&&(u=" "+Date.prototype.toUTCString.call(t)),isError(t)&&(u=" "+formatError(t)),0!==i.length||f&&0!=t.length?n<0?isRegExp(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),c=f?formatArray(e,t,n,s,i):i.map(function(r){return formatProperty(e,t,n,s,r,f)}),e.seen.pop(),reduceToSingleString(c,u,l)):l[0]+u+l[1]}function formatPrimitive(e,t){if(isUndefined(t))return e.stylize("undefined","undefined");if(isString(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return isNumber(t)?e.stylize(""+t,"number"):isBoolean(t)?e.stylize(""+t,"boolean"):isNull(t)?e.stylize("null","null"):void 0}function formatError(e){return"["+Error.prototype.toString.call(e)+"]"}function formatArray(e,t,n,r,o){for(var i=[],s=0,a=t.length;s<a;++s)hasOwnProperty(t,String(s))?i.push(formatProperty(e,t,n,r,String(s),!0)):i.push("");return o.forEach(function(o){o.match(/^\d+$/)||i.push(formatProperty(e,t,n,r,o,!0))}),i}function formatProperty(e,t,n,r,o,i){var s,a,c;if((c=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?a=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(a=e.stylize("[Setter]","special")),hasOwnProperty(r,o)||(s="["+o+"]"),a||(e.seen.indexOf(c.value)<0?(a=isNull(n)?formatValue(e,c.value,null):formatValue(e,c.value,n-1)).indexOf("\n")>-1&&(a=i?a.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+a.split("\n").map(function(e){return"   "+e}).join("\n")):a=e.stylize("[Circular]","special")),isUndefined(s)){if(i&&o.match(/^\d+$/))return a;(s=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function reduceToSingleString(e,t,n){return e.reduce(function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function isArray(e){return Array.isArray(e)}function isBoolean(e){return"boolean"==typeof e}function isNull(e){return null===e}function isNullOrUndefined(e){return null==e}function isNumber(e){return"number"==typeof e}function isString(e){return"string"==typeof e}function isSymbol(e){return"symbol"===_typeof$1(e)}function isUndefined(e){return void 0===e}function isRegExp(e){return isObject(e)&&"[object RegExp]"===objectToString(e)}function isObject(e){return"object"===_typeof$1(e)&&null!==e}function isDate(e){return isObject(e)&&"[object Date]"===objectToString(e)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction(e){return"function"==typeof e}function isPrimitive(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"===_typeof$1(e)||void 0===e}function isBuffer(e){return Buffer.isBuffer(e)}function objectToString(e){return Object.prototype.toString.call(e)}function pad(e){return e<10?"0"+e.toString(10):e.toString(10)}inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function timestamp$1(){var e=new Date,t=[pad(e.getHours()),pad(e.getMinutes()),pad(e.getSeconds())].join(":");return[e.getDate(),months[e.getMonth()],t].join(" ")}function log(){console.log("%s - %s",timestamp$1(),format.apply(null,arguments))}function _extend(e,t){if(!t||!isObject(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}function hasOwnProperty(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var util={inherits:inherits$1,_extend:_extend,log:log,isBuffer:isBuffer,isPrimitive:isPrimitive,isFunction:isFunction,isError:isError,isDate:isDate,isObject:isObject,isRegExp:isRegExp,isUndefined:isUndefined,isSymbol:isSymbol,isString:isString,isNumber:isNumber,isNullOrUndefined:isNullOrUndefined,isNull:isNull,isBoolean:isBoolean,isArray:isArray,inspect:inspect,deprecate:deprecate,format:format,debuglog:debuglog};function _classCallCheck$2(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$2(e,t,n){return t&&_defineProperties$2(e.prototype,t),n&&_defineProperties$2(e,n),e}var Buffer$1=buffer__WEBPACK_IMPORTED_MODULE_1___default.a.Buffer,randomBytes$1=utils.randomBytes,deprecate$1=util.deprecate,PROCESS_UNIQUE=randomBytes$1(5),checkForHexRegExp=new RegExp("^[0-9a-fA-F]{24}$"),hasBufferType=!1;try{Buffer$1&&Buffer$1.from&&(hasBufferType=!0)}catch(e){hasBufferType=!1}for(var hexTable=[],_i=0;_i<256;_i++)hexTable[_i]=(_i<=15?"0":"")+_i.toString(16);for(var decodeLookup=[],i=0;i<10;)decodeLookup[48+i]=i++;for(;i<16;)decodeLookup[55+i]=decodeLookup[87+i]=i++;var _Buffer=Buffer$1;function convertToHex(e){return e.toString("hex")}function makeObjectIdError(e,t){var n=e[t];return new TypeError('ObjectId string "'.concat(e,'" contains invalid character "').concat(n,'" with character code (').concat(e.charCodeAt(t),"). All character codes for a non-hex string must be less than 256."))}var ObjectId=function(){function e(t){if(_classCallCheck$2(this,e),t instanceof e)return t;if(null==t||"number"==typeof t)return this.id=e.generate(t),void(e.cacheHexString&&(this.__id=this.toString("hex")));var n=e.isValid(t);if(!n&&null!=t)throw new TypeError("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");if(n&&"string"==typeof t&&24===t.length&&hasBufferType)return new e(Buffer$1.from(t,"hex"));if(n&&"string"==typeof t&&24===t.length)return e.createFromHexString(t);if(null==t||12!==t.length){if(null!=t&&t.toHexString)return e.createFromHexString(t.toHexString());throw new TypeError("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters")}this.id=t,e.cacheHexString&&(this.__id=this.toString("hex"))}return _createClass$2(e,[{key:"toHexString",value:function(){if(e.cacheHexString&&this.__id)return this.__id;var t="";if(!this.id||!this.id.length)throw new TypeError("invalid ObjectId, ObjectId.id must be either a string or a Buffer, but is ["+JSON.stringify(this.id)+"]");if(this.id instanceof _Buffer)return t=convertToHex(this.id),e.cacheHexString&&(this.__id=t),t;for(var n=0;n<this.id.length;n++){var r=hexTable[this.id.charCodeAt(n)];if("string"!=typeof r)throw makeObjectIdError(this.id,n);t+=r}return e.cacheHexString&&(this.__id=t),t}},{key:"toString",value:function(e){return this.id&&this.id.copy?this.id.toString("string"==typeof e?e:"hex"):this.toHexString()}},{key:"toJSON",value:function(){return this.toHexString()}},{key:"equals",value:function(t){return t instanceof e?this.toString()===t.toString():"string"==typeof t&&e.isValid(t)&&12===t.length&&this.id instanceof _Buffer?t===this.id.toString("binary"):"string"==typeof t&&e.isValid(t)&&24===t.length?t.toLowerCase()===this.toHexString():"string"==typeof t&&e.isValid(t)&&12===t.length?t===this.id:!(null==t||!(t instanceof e||t.toHexString))&&t.toHexString()===this.toHexString()}},{key:"getTimestamp",value:function(){var e=new Date,t=this.id.readUInt32BE(0);return e.setTime(1e3*Math.floor(t)),e}},{key:"toExtendedJSON",value:function(){return this.toHexString?{$oid:this.toHexString()}:{$oid:this.toString("hex")}}}],[{key:"getInc",value:function(){return e.index=(e.index+1)%16777215}},{key:"generate",value:function(t){"number"!=typeof t&&(t=~~(Date.now()/1e3));var n=e.getInc(),r=Buffer$1.alloc(12);return r[3]=255&t,r[2]=t>>8&255,r[1]=t>>16&255,r[0]=t>>24&255,r[4]=PROCESS_UNIQUE[0],r[5]=PROCESS_UNIQUE[1],r[6]=PROCESS_UNIQUE[2],r[7]=PROCESS_UNIQUE[3],r[8]=PROCESS_UNIQUE[4],r[11]=255&n,r[10]=n>>8&255,r[9]=n>>16&255,r}},{key:"createPk",value:function(){return new e}},{key:"createFromTime",value:function(t){var n=Buffer$1.from([0,0,0,0,0,0,0,0,0,0,0,0]);return n[3]=255&t,n[2]=t>>8&255,n[1]=t>>16&255,n[0]=t>>24&255,new e(n)}},{key:"createFromHexString",value:function(t){if(void 0===t||null!=t&&24!==t.length)throw new TypeError("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");if(hasBufferType)return new e(Buffer$1.from(t,"hex"));for(var n=new _Buffer(12),r=0,o=0;o<24;)n[r++]=decodeLookup[t.charCodeAt(o++)]<<4|decodeLookup[t.charCodeAt(o++)];return new e(n)}},{key:"isValid",value:function(t){return null!=t&&("number"==typeof t||("string"==typeof t?12===t.length||24===t.length&&checkForHexRegExp.test(t):t instanceof e||(t instanceof _Buffer&&12===t.length||!!t.toHexString&&(12===t.id.length||24===t.id.length&&checkForHexRegExp.test(t.id)))))}},{key:"fromExtendedJSON",value:function(t){return new e(t.$oid)}}]),e}();ObjectId.get_inc=deprecate$1(function(){return ObjectId.getInc()},"Please use the static `ObjectId.getInc()` instead"),ObjectId.prototype.get_inc=deprecate$1(function(){return ObjectId.getInc()},"Please use the static `ObjectId.getInc()` instead"),ObjectId.prototype.getInc=deprecate$1(function(){return ObjectId.getInc()},"Please use the static `ObjectId.getInc()` instead"),ObjectId.prototype.generate=deprecate$1(function(e){return ObjectId.generate(e)},"Please use the static `ObjectId.generate(time)` instead"),Object.defineProperty(ObjectId.prototype,"generationTime",{enumerable:!0,get:function(){return this.id[3]|this.id[2]<<8|this.id[1]<<16|this.id[0]<<24},set:function(e){this.id[3]=255&e,this.id[2]=e>>8&255,this.id[1]=e>>16&255,this.id[0]=e>>24&255}}),ObjectId.prototype[util.inspect.custom||"inspect"]=ObjectId.prototype.toString,ObjectId.index=~~(16777215*Math.random()),Object.defineProperty(ObjectId.prototype,"_bsontype",{value:"ObjectID"});var objectid=ObjectId;function _classCallCheck$3(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$3(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$3(e,t,n){return t&&_defineProperties$3(e.prototype,t),n&&_defineProperties$3(e,n),e}function alphabetize(e){return e.split("").sort().join("")}var BSONRegExp=function(){function e(t,n){_classCallCheck$3(this,e),this.pattern=t||"",this.options=n?alphabetize(n):"";for(var r=0;r<this.options.length;r++)if("i"!==this.options[r]&&"m"!==this.options[r]&&"x"!==this.options[r]&&"l"!==this.options[r]&&"s"!==this.options[r]&&"u"!==this.options[r])throw new Error("The regular expression option [".concat(this.options[r],"] is not supported"))}return _createClass$3(e,[{key:"toExtendedJSON",value:function(){return{$regularExpression:{pattern:this.pattern,options:this.options}}}}],[{key:"fromExtendedJSON",value:function(t){return new e(t.$regularExpression.pattern,t.$regularExpression.options.split("").sort().join(""))}}]),e}();Object.defineProperty(BSONRegExp.prototype,"_bsontype",{value:"BSONRegExp"});var regexp=BSONRegExp;function _classCallCheck$4(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$4(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$4(e,t,n){return t&&_defineProperties$4(e.prototype,t),n&&_defineProperties$4(e,n),e}var BSONSymbol=function(){function e(t){_classCallCheck$4(this,e),this.value=t}return _createClass$4(e,[{key:"valueOf",value:function(){return this.value}},{key:"toString",value:function(){return this.value}},{key:"inspect",value:function(){return this.value}},{key:"toJSON",value:function(){return this.value}},{key:"toExtendedJSON",value:function(){return{$symbol:this.value}}}],[{key:"fromExtendedJSON",value:function(t){return new e(t.$symbol)}}]),e}();Object.defineProperty(BSONSymbol.prototype,"_bsontype",{value:"Symbol"});var symbol=BSONSymbol;function _classCallCheck$5(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$5(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$5(e,t,n){return t&&_defineProperties$5(e.prototype,t),n&&_defineProperties$5(e,n),e}var Int32=function(){function e(t){_classCallCheck$5(this,e),this.value=t}return _createClass$5(e,[{key:"valueOf",value:function(){return this.value}},{key:"toJSON",value:function(){return this.value}},{key:"toExtendedJSON",value:function(e){return e&&e.relaxed?this.value:{$numberInt:this.value.toString()}}}],[{key:"fromExtendedJSON",value:function(t,n){return n&&n.relaxed?parseInt(t.$numberInt,10):new e(t.$numberInt)}}]),e}();Object.defineProperty(Int32.prototype,"_bsontype",{value:"Int32"});var int_32=Int32;function _classCallCheck$6(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$6(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$6(e,t,n){return t&&_defineProperties$6(e.prototype,t),n&&_defineProperties$6(e,n),e}var Code=function(){function e(t,n){_classCallCheck$6(this,e),this.code=t,this.scope=n}return _createClass$6(e,[{key:"toJSON",value:function(){return{scope:this.scope,code:this.code}}},{key:"toExtendedJSON",value:function(){return this.scope?{$code:this.code,$scope:this.scope}:{$code:this.code}}}],[{key:"fromExtendedJSON",value:function(t){return new e(t.$code,t.$scope)}}]),e}();Object.defineProperty(Code.prototype,"_bsontype",{value:"Code"});var code=Code,Buffer$2=buffer__WEBPACK_IMPORTED_MODULE_1___default.a.Buffer,PARSE_STRING_REGEXP=/^(\+|-)?(\d+|(\d*\.\d*))?(E|e)?([-+])?(\d+)?$/,PARSE_INF_REGEXP=/^(\+|-)?(Infinity|inf)$/i,PARSE_NAN_REGEXP=/^(\+|-)?NaN$/i,EXPONENT_MAX=6111,EXPONENT_MIN=-6176,EXPONENT_BIAS=6176,MAX_DIGITS=34,NAN_BUFFER=[124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),INF_NEGATIVE_BUFFER=[248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),INF_POSITIVE_BUFFER=[120,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),EXPONENT_REGEX=/^([-+])?(\d+)?$/;function isDigit(e){return!isNaN(parseInt(e,10))}function divideu128(e){var t=long_1.fromNumber(1e9),n=long_1.fromNumber(0);if(!(e.parts[0]||e.parts[1]||e.parts[2]||e.parts[3]))return{quotient:e,rem:n};for(var r=0;r<=3;r++)n=(n=n.shiftLeft(32)).add(new long_1(e.parts[r],0)),e.parts[r]=n.div(t).low,n=n.modulo(t);return{quotient:e,rem:n}}function multiply64x2(e,t){if(!e&&!t)return{high:long_1.fromNumber(0),low:long_1.fromNumber(0)};var n=e.shiftRightUnsigned(32),r=new long_1(e.getLowBits(),0),o=t.shiftRightUnsigned(32),i=new long_1(t.getLowBits(),0),s=n.multiply(o),a=n.multiply(i),c=r.multiply(o),u=r.multiply(i);return s=s.add(a.shiftRightUnsigned(32)),a=new long_1(a.getLowBits(),0).add(c).add(u.shiftRightUnsigned(32)),{high:s=s.add(a.shiftRightUnsigned(32)),low:u=a.shiftLeft(32).add(new long_1(u.getLowBits(),0))}}function lessThan(e,t){var n=e.high>>>0,r=t.high>>>0;return n<r||n===r&&e.low>>>0<t.low>>>0}function invalidErr(e,t){throw new TypeError('"'.concat(e,'" is not a valid Decimal128 string - ').concat(t))}function Decimal128(e){this.bytes=e}Decimal128.fromString=function(e){var t,n=!1,r=!1,o=!1,i=0,s=0,a=0,c=0,u=0,f=[0],l=0,h=0,d=0,p=0,g=0,_=0,y=[0,0],m=[0,0],b=0;if(e.length>=7e3)throw new TypeError(e+" not a valid Decimal128 string");var v=e.match(PARSE_STRING_REGEXP),w=e.match(PARSE_INF_REGEXP),E=e.match(PARSE_NAN_REGEXP);if(!v&&!w&&!E||0===e.length)throw new TypeError(e+" not a valid Decimal128 string");if(v){var S=v[2],O=v[4],T=v[5],A=v[6];O&&void 0===A&&invalidErr(e,"missing exponent power"),O&&void 0===S&&invalidErr(e,"missing exponent base"),void 0===O&&(T||A)&&invalidErr(e,"missing e before exponent")}if("+"!==e[b]&&"-"!==e[b]||(n="-"===e[b++]),!isDigit(e[b])&&"."!==e[b]){if("i"===e[b]||"I"===e[b])return new Decimal128(Buffer$2.from(n?INF_NEGATIVE_BUFFER:INF_POSITIVE_BUFFER));if("N"===e[b])return new Decimal128(Buffer$2.from(NAN_BUFFER))}for(;isDigit(e[b])||"."===e[b];)"."!==e[b]?(l<34&&("0"!==e[b]||o)&&(o||(u=s),o=!0,f[h++]=parseInt(e[b],10),l+=1),o&&(a+=1),r&&(c+=1),s+=1,b+=1):(r&&invalidErr(e,"contains multiple periods"),r=!0,b+=1);if(r&&!s)throw new TypeError(e+" not a valid Decimal128 string");if("e"===e[b]||"E"===e[b]){var N=e.substr(++b).match(EXPONENT_REGEX);if(!N||!N[2])return new Decimal128(Buffer$2.from(NAN_BUFFER));g=parseInt(N[0],10),b+=N[0].length}if(e[b])return new Decimal128(Buffer$2.from(NAN_BUFFER));if(d=0,l){if(p=l-1,1!==(i=a))for(;"0"===e[u+i-1];)i-=1}else d=0,p=0,f[0]=0,a=1,l=1,i=0;for(g<=c&&c-g>16384?g=EXPONENT_MIN:g-=c;g>EXPONENT_MAX;){if((p+=1)-d>MAX_DIGITS){if(f.join("").match(/^0+$/)){g=EXPONENT_MAX;break}invalidErr(e,"overflow")}g-=1}for(;g<EXPONENT_MIN||l<a;){if(0===p&&i<l){g=EXPONENT_MIN,i=0;break}if(l<a?a-=1:p-=1,g<EXPONENT_MAX)g+=1;else{if(f.join("").match(/^0+$/)){g=EXPONENT_MAX;break}invalidErr(e,"overflow")}}if(p-d+1<i){var I=s;r&&(u+=1,I+=1),n&&(u+=1,I+=1);var B=parseInt(e[u+p+1],10),R=0;if(B>=5&&(R=1,5===B))for(R=f[p]%2==1,_=u+p+2;_<I;_++)if(parseInt(e[_],10)){R=1;break}if(R)for(var D=p;D>=0;D--)if(++f[D]>9&&(f[D]=0,0===D)){if(!(g<EXPONENT_MAX))return new Decimal128(Buffer$2.from(n?INF_NEGATIVE_BUFFER:INF_POSITIVE_BUFFER));g+=1,f[D]=1}}if(y=long_1.fromNumber(0),m=long_1.fromNumber(0),0===i)y=long_1.fromNumber(0),m=long_1.fromNumber(0);else if(p-d<17){var x=d;for(m=long_1.fromNumber(f[x++]),y=new long_1(0,0);x<=p;x++)m=(m=m.multiply(long_1.fromNumber(10))).add(long_1.fromNumber(f[x]))}else{var P=d;for(y=long_1.fromNumber(f[P++]);P<=p-17;P++)y=(y=y.multiply(long_1.fromNumber(10))).add(long_1.fromNumber(f[P]));for(m=long_1.fromNumber(f[P++]);P<=p;P++)m=(m=m.multiply(long_1.fromNumber(10))).add(long_1.fromNumber(f[P]))}var C=multiply64x2(y,long_1.fromString("100000000000000000"));C.low=C.low.add(m),lessThan(C.low,m)&&(C.high=C.high.add(long_1.fromNumber(1))),t=g+EXPONENT_BIAS;var j={low:long_1.fromNumber(0),high:long_1.fromNumber(0)};C.high.shiftRightUnsigned(49).and(long_1.fromNumber(1)).equals(long_1.fromNumber(1))?(j.high=j.high.or(long_1.fromNumber(3).shiftLeft(61)),j.high=j.high.or(long_1.fromNumber(t).and(long_1.fromNumber(16383).shiftLeft(47))),j.high=j.high.or(C.high.and(long_1.fromNumber(0x7fffffffffff)))):(j.high=j.high.or(long_1.fromNumber(16383&t).shiftLeft(49)),j.high=j.high.or(C.high.and(long_1.fromNumber(562949953421311)))),j.low=C.low,n&&(j.high=j.high.or(long_1.fromString("9223372036854775808")));var L=Buffer$2.alloc(16);return b=0,L[b++]=255&j.low.low,L[b++]=j.low.low>>8&255,L[b++]=j.low.low>>16&255,L[b++]=j.low.low>>24&255,L[b++]=255&j.low.high,L[b++]=j.low.high>>8&255,L[b++]=j.low.high>>16&255,L[b++]=j.low.high>>24&255,L[b++]=255&j.high.low,L[b++]=j.high.low>>8&255,L[b++]=j.high.low>>16&255,L[b++]=j.high.low>>24&255,L[b++]=255&j.high.high,L[b++]=j.high.high>>8&255,L[b++]=j.high.high>>16&255,L[b++]=j.high.high>>24&255,new Decimal128(L)};var COMBINATION_MASK=31,EXPONENT_MASK=16383,COMBINATION_INFINITY=30,COMBINATION_NAN=31;Decimal128.prototype.toString=function(){for(var e,t,n,r,o,i,s=0,a=new Array(36),c=0;c<a.length;c++)a[c]=0;var u,f,l,h,d,p=0,g=!1,_={parts:new Array(4)},y=[];p=0;var m=this.bytes;if(r=m[p++]|m[p++]<<8|m[p++]<<16|m[p++]<<24,n=m[p++]|m[p++]<<8|m[p++]<<16|m[p++]<<24,t=m[p++]|m[p++]<<8|m[p++]<<16|m[p++]<<24,e=m[p++]|m[p++]<<8|m[p++]<<16|m[p++]<<24,p=0,{low:new long_1(r,n),high:new long_1(t,e)}.high.lessThan(long_1.ZERO)&&y.push("-"),(o=e>>26&COMBINATION_MASK)>>3==3){if(o===COMBINATION_INFINITY)return y.join("")+"Infinity";if(o===COMBINATION_NAN)return"NaN";i=e>>15&EXPONENT_MASK,l=8+(e>>14&1)}else l=e>>14&7,i=e>>17&EXPONENT_MASK;if(u=i-EXPONENT_BIAS,_.parts[0]=(16383&e)+((15&l)<<14),_.parts[1]=t,_.parts[2]=n,_.parts[3]=r,0===_.parts[0]&&0===_.parts[1]&&0===_.parts[2]&&0===_.parts[3])g=!0;else for(d=3;d>=0;d--){var b=0,v=divideu128(_);if(_=v.quotient,b=v.rem.low)for(h=8;h>=0;h--)a[9*d+h]=b%10,b=Math.floor(b/10)}if(g)s=1,a[p]=0;else for(s=36;!a[p];)s-=1,p+=1;if((f=s-1+u)>=34||f<=-7||u>0){if(s>34)return y.push(0),u>0?y.push("E+"+u):u<0&&y.push("E"+u),y.join("");y.push(a[p++]),(s-=1)&&y.push(".");for(var w=0;w<s;w++)y.push(a[p++]);y.push("E"),f>0?y.push("+"+f):y.push(f)}else if(u>=0)for(var E=0;E<s;E++)y.push(a[p++]);else{var S=s+u;if(S>0)for(var O=0;O<S;O++)y.push(a[p++]);else y.push("0");for(y.push(".");S++<0;)y.push("0");for(var T=0;T<s-Math.max(S-1,0);T++)y.push(a[p++])}return y.join("")},Decimal128.prototype.toJSON=function(){return{$numberDecimal:this.toString()}},Decimal128.prototype.toExtendedJSON=function(){return{$numberDecimal:this.toString()}},Decimal128.fromExtendedJSON=function(e){return Decimal128.fromString(e.$numberDecimal)},Object.defineProperty(Decimal128.prototype,"_bsontype",{value:"Decimal128"});var decimal128=Decimal128;function _classCallCheck$7(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$7(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$7(e,t,n){return t&&_defineProperties$7(e.prototype,t),n&&_defineProperties$7(e,n),e}var MinKey=function(){function e(){_classCallCheck$7(this,e)}return _createClass$7(e,[{key:"toExtendedJSON",value:function(){return{$minKey:1}}}],[{key:"fromExtendedJSON",value:function(){return new e}}]),e}();Object.defineProperty(MinKey.prototype,"_bsontype",{value:"MinKey"});var min_key=MinKey;function _classCallCheck$8(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$8(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$8(e,t,n){return t&&_defineProperties$8(e.prototype,t),n&&_defineProperties$8(e,n),e}var MaxKey=function(){function e(){_classCallCheck$8(this,e)}return _createClass$8(e,[{key:"toExtendedJSON",value:function(){return{$maxKey:1}}}],[{key:"fromExtendedJSON",value:function(){return new e}}]),e}();Object.defineProperty(MaxKey.prototype,"_bsontype",{value:"MaxKey"});var max_key=MaxKey;function _classCallCheck$9(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$9(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$9(e,t,n){return t&&_defineProperties$9(e.prototype,t),n&&_defineProperties$9(e,n),e}var DBRef=function(){function e(t,n,r,o){_classCallCheck$9(this,e);var i=t.split(".");2===i.length&&(r=i.shift(),t=i.shift()),this.collection=t,this.oid=n,this.db=r,this.fields=o||{}}return _createClass$9(e,[{key:"toJSON",value:function(){var e=Object.assign({$ref:this.collection,$id:this.oid},this.fields);return null!=this.db&&(e.$db=this.db),e}},{key:"toExtendedJSON",value:function(){var e={$ref:this.collection,$id:this.oid};return this.db&&(e.$db=this.db),e=Object.assign(e,this.fields)}}],[{key:"fromExtendedJSON",value:function(t){var n=Object.assign({},t);return["$ref","$id","$db"].forEach(function(e){return delete n[e]}),new e(t.$ref,t.$id,t.$db,n)}}]),e}();Object.defineProperty(DBRef.prototype,"_bsontype",{value:"DBRef"}),Object.defineProperty(DBRef.prototype,"namespace",{get:function(){return this.collection},set:function(e){this.collection=e},configurable:!1});var db_ref=DBRef;function _classCallCheck$a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$a(e,t,n){return t&&_defineProperties$a(e.prototype,t),n&&_defineProperties$a(e,n),e}var Buffer$3=buffer__WEBPACK_IMPORTED_MODULE_1___default.a.Buffer,Binary=function(){function e(t,n){if(_classCallCheck$a(this,e),!(null==t||"string"==typeof t||Buffer$3.isBuffer(t)||t instanceof Uint8Array||Array.isArray(t)))throw new TypeError("only String, Buffer, Uint8Array or Array accepted");if(this.sub_type=null==n?BSON_BINARY_SUBTYPE_DEFAULT:n,this.position=0,null==t||t instanceof Number)void 0!==Buffer$3?this.buffer=Buffer$3.alloc(e.BUFFER_SIZE):"undefined"!=typeof Uint8Array?this.buffer=new Uint8Array(new ArrayBuffer(e.BUFFER_SIZE)):this.buffer=new Array(e.BUFFER_SIZE);else{if("string"==typeof t)if(void 0!==Buffer$3)this.buffer=Buffer$3.from(t);else{if("undefined"==typeof Uint8Array&&!Array.isArray(t))throw new TypeError("only String, Buffer, Uint8Array or Array accepted");this.buffer=writeStringToArray(t)}else this.buffer=t;this.position=t.length}}return _createClass$a(e,[{key:"put",value:function(t){if(null!=t.length&&"number"!=typeof t&&1!==t.length)throw new TypeError("only accepts single character String, Uint8Array or Array");if("number"!=typeof t&&t<0||t>255)throw new TypeError("only accepts number in a valid unsigned byte range 0-255");var n=null;if(n="string"==typeof t?t.charCodeAt(0):null!=t.length?t[0]:t,this.buffer.length>this.position)this.buffer[this.position++]=n;else if(void 0!==Buffer$3&&Buffer$3.isBuffer(this.buffer)){var r=Buffer$3.alloc(e.BUFFER_SIZE+this.buffer.length);this.buffer.copy(r,0,0,this.buffer.length),this.buffer=r,this.buffer[this.position++]=n}else{var o=null;o=isUint8Array(this.buffer)?new Uint8Array(new ArrayBuffer(e.BUFFER_SIZE+this.buffer.length)):new Array(e.BUFFER_SIZE+this.buffer.length);for(var i=0;i<this.buffer.length;i++)o[i]=this.buffer[i];this.buffer=o,this.buffer[this.position++]=n}}},{key:"write",value:function(e,t){if(t="number"==typeof t?t:this.position,this.buffer.length<t+e.length){var n=null;if(void 0!==Buffer$3&&Buffer$3.isBuffer(this.buffer))n=Buffer$3.alloc(this.buffer.length+e.length),this.buffer.copy(n,0,0,this.buffer.length);else if(isUint8Array(this.buffer)){n=new Uint8Array(new ArrayBuffer(this.buffer.length+e.length));for(var r=0;r<this.position;r++)n[r]=this.buffer[r]}this.buffer=n}if(void 0!==Buffer$3&&Buffer$3.isBuffer(e)&&Buffer$3.isBuffer(this.buffer))e.copy(this.buffer,t,0,e.length),this.position=t+e.length>this.position?t+e.length:this.position;else if(void 0!==Buffer$3&&"string"==typeof e&&Buffer$3.isBuffer(this.buffer))this.buffer.write(e,t,"binary"),this.position=t+e.length>this.position?t+e.length:this.position;else if(isUint8Array(e)||Array.isArray(e)&&"string"!=typeof e){for(var o=0;o<e.length;o++)this.buffer[t++]=e[o];this.position=t>this.position?t:this.position}else if("string"==typeof e){for(var i=0;i<e.length;i++)this.buffer[t++]=e.charCodeAt(i);this.position=t>this.position?t:this.position}}},{key:"read",value:function(e,t){if(t=t&&t>0?t:this.position,this.buffer.slice)return this.buffer.slice(e,e+t);for(var n="undefined"!=typeof Uint8Array?new Uint8Array(new ArrayBuffer(t)):new Array(t),r=0;r<t;r++)n[r]=this.buffer[e++];return n}},{key:"value",value:function(e){if((e=null!=e&&e)&&void 0!==Buffer$3&&Buffer$3.isBuffer(this.buffer)&&this.buffer.length===this.position)return this.buffer;if(void 0!==Buffer$3&&Buffer$3.isBuffer(this.buffer))return e?this.buffer.slice(0,this.position):this.buffer.toString("binary",0,this.position);if(e){if(null!=this.buffer.slice)return this.buffer.slice(0,this.position);for(var t=isUint8Array(this.buffer)?new Uint8Array(new ArrayBuffer(this.position)):new Array(this.position),n=0;n<this.position;n++)t[n]=this.buffer[n];return t}return convertArraytoUtf8BinaryString(this.buffer,0,this.position)}},{key:"length",value:function(){return this.position}},{key:"toJSON",value:function(){return null!=this.buffer?this.buffer.toString("base64"):""}},{key:"toString",value:function(e){return null!=this.buffer?this.buffer.slice(0,this.position).toString(e):""}},{key:"toExtendedJSON",value:function(){var e=Buffer$3.isBuffer(this.buffer)?this.buffer.toString("base64"):Buffer$3.from(this.buffer).toString("base64"),t=Number(this.sub_type).toString(16);return{$binary:{base64:e,subType:1===t.length?"0"+t:t}}}}],[{key:"fromExtendedJSON",value:function(t){var n=t.$binary.subType?parseInt(t.$binary.subType,16):0;return new e(Buffer$3.from(t.$binary.base64,"base64"),n)}}]),e}(),BSON_BINARY_SUBTYPE_DEFAULT=0;function isUint8Array(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)}function writeStringToArray(e){for(var t="undefined"!=typeof Uint8Array?new Uint8Array(new ArrayBuffer(e.length)):new Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}function convertArraytoUtf8BinaryString(e,t,n){for(var r="",o=t;o<n;o++)r+=String.fromCharCode(e[o]);return r}Binary.BUFFER_SIZE=256,Binary.SUBTYPE_DEFAULT=0,Binary.SUBTYPE_FUNCTION=1,Binary.SUBTYPE_BYTE_ARRAY=2,Binary.SUBTYPE_UUID_OLD=3,Binary.SUBTYPE_UUID=4,Binary.SUBTYPE_MD5=5,Binary.SUBTYPE_USER_DEFINED=128,Object.defineProperty(Binary.prototype,"_bsontype",{value:"Binary"});var binary=Binary,constants={BSON_INT32_MAX:2147483647,BSON_INT32_MIN:-2147483648,BSON_INT64_MAX:Math.pow(2,63)-1,BSON_INT64_MIN:-Math.pow(2,63),JS_INT_MAX:9007199254740992,JS_INT_MIN:-9007199254740992,BSON_DATA_NUMBER:1,BSON_DATA_STRING:2,BSON_DATA_OBJECT:3,BSON_DATA_ARRAY:4,BSON_DATA_BINARY:5,BSON_DATA_UNDEFINED:6,BSON_DATA_OID:7,BSON_DATA_BOOLEAN:8,BSON_DATA_DATE:9,BSON_DATA_NULL:10,BSON_DATA_REGEXP:11,BSON_DATA_DBPOINTER:12,BSON_DATA_CODE:13,BSON_DATA_SYMBOL:14,BSON_DATA_CODE_W_SCOPE:15,BSON_DATA_INT:16,BSON_DATA_TIMESTAMP:17,BSON_DATA_LONG:18,BSON_DATA_DECIMAL128:19,BSON_DATA_MIN_KEY:255,BSON_DATA_MAX_KEY:127,BSON_BINARY_SUBTYPE_DEFAULT:0,BSON_BINARY_SUBTYPE_FUNCTION:1,BSON_BINARY_SUBTYPE_BYTE_ARRAY:2,BSON_BINARY_SUBTYPE_UUID:3,BSON_BINARY_SUBTYPE_MD5:4,BSON_BINARY_SUBTYPE_USER_DEFINED:128};function _typeof$2(e){return(_typeof$2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var keysToCodecs={$oid:objectid,$binary:binary,$symbol:symbol,$numberInt:int_32,$numberDecimal:decimal128,$numberDouble:double_1,$numberLong:long_1,$minKey:min_key,$maxKey:max_key,$regularExpression:regexp,$timestamp:timestamp};function deserializeValue(e,t,n,r){if("number"==typeof n){if(r.relaxed)return n;if(Math.floor(n)===n){if(n>=BSON_INT32_MIN&&n<=BSON_INT32_MAX)return new int_32(n);if(n>=BSON_INT64_MIN&&n<=BSON_INT64_MAX)return new long_1.fromNumber(n)}return new double_1(n)}if(null==n||"object"!==_typeof$2(n))return n;if(n.$undefined)return null;for(var o=Object.keys(n).filter(function(e){return e.startsWith("$")&&null!=n[e]}),i=0;i<o.length;i++){var s=keysToCodecs[o[i]];if(s)return s.fromExtendedJSON(n,r)}if(null!=n.$date){var a=n.$date,c=new Date;return"string"==typeof a?c.setTime(Date.parse(a)):long_1.isLong(a)?c.setTime(a.toNumber()):"number"==typeof a&&r.relaxed&&c.setTime(a),c}if(null!=n.$code){var u=Object.assign({},n);return n.$scope&&(u.$scope=deserializeValue(e,null,n.$scope)),code.fromExtendedJSON(n)}if(null!=n.$ref||null!=n.$dbPointer){var f=n.$ref?n:n.$dbPointer;if(f instanceof db_ref)return f;var l=Object.keys(f).filter(function(e){return e.startsWith("$")}),h=!0;if(l.forEach(function(e){-1===["$ref","$id","$db"].indexOf(e)&&(h=!1)}),h)return db_ref.fromExtendedJSON(f)}return n}function parse(e,t){var n=this;return"boolean"==typeof(t=Object.assign({},{relaxed:!0},t)).relaxed&&(t.strict=!t.relaxed),"boolean"==typeof t.strict&&(t.relaxed=!t.strict),JSON.parse(e,function(e,r){return deserializeValue(n,e,r,t)})}var BSON_INT32_MAX=2147483647,BSON_INT32_MIN=-2147483648,BSON_INT64_MAX=0x8000000000000000,BSON_INT64_MIN=-0x8000000000000000;function stringify(e,t,n,r){null!=n&&"object"===_typeof$2(n)&&(r=n,n=0),null==t||"object"!==_typeof$2(t)||Array.isArray(t)||(r=t,t=null,n=0),r=Object.assign({},{relaxed:!0},r);var o=Array.isArray(e)?serializeArray(e,r):serializeDocument(e,r);return JSON.stringify(o,t,n)}function serialize(e,t){return t=t||{},JSON.parse(stringify(e,t))}function deserialize(e,t){return t=t||{},parse(JSON.stringify(e),t)}function serializeArray(e,t){return e.map(function(e){return serializeValue(e,t)})}function getISOString(e){var t=e.toISOString();return 0!==e.getUTCMilliseconds()?t:t.slice(0,-5)+"Z"}function serializeValue(e,t){if(Array.isArray(e))return serializeArray(e,t);if(void 0===e)return null;if(e instanceof Date){var n=e.getTime(),r=n>-1&&n<2534023188e5;return t.relaxed&&r?{$date:getISOString(e)}:{$date:{$numberLong:e.getTime().toString()}}}if("number"==typeof e&&!t.relaxed){if(Math.floor(e)===e){var o=e>=BSON_INT64_MIN&&e<=BSON_INT64_MAX;if(e>=BSON_INT32_MIN&&e<=BSON_INT32_MAX)return{$numberInt:e.toString()};if(o)return{$numberLong:e.toString()}}return{$numberDouble:e.toString()}}if(e instanceof RegExp){var i=e.flags;return void 0===i&&(i=e.toString().match(/[gimuy]*$/)[0]),new regexp(e.source,i).toExtendedJSON()}return null!=e&&"object"===_typeof$2(e)?serializeDocument(e,t):e}var BSON_TYPE_MAPPINGS={Binary:function(e){return new binary(e.value(),e.subtype)},Code:function(e){return new code(e.code,e.scope)},DBRef:function(e){return new db_ref(e.collection||e.namespace,e.oid,e.db,e.fields)},Decimal128:function(e){return new decimal128(e.bytes)},Double:function(e){return new double_1(e.value)},Int32:function(e){return new int_32(e.value)},Long:function(e){return long_1.fromBits(null!=e.low?e.low:e.low_,null!=e.low?e.high:e.high_,null!=e.low?e.unsigned:e.unsigned_)},MaxKey:function(){return new max_key},MinKey:function(){return new min_key},ObjectID:function(e){return new objectid(e)},ObjectId:function(e){return new objectid(e)},BSONRegExp:function(e){return new regexp(e.pattern,e.options)},Symbol:function(e){return new symbol(e.value)},Timestamp:function(e){return timestamp.fromBits(e.low,e.high)}};function serializeDocument(e,t){if(null==e||"object"!==_typeof$2(e))throw new Error("not an object instance");var n=e._bsontype;if(void 0===n){var r={};for(var o in e)r[o]=serializeValue(e[o],t);return r}if("string"==typeof n){var i=e;if("function"!=typeof i.toExtendedJSON){var s=BSON_TYPE_MAPPINGS[n];if(!s)throw new TypeError("Unrecognized or invalid _bsontype: "+n);i=s(i)}return"Code"===n&&i.scope?i=new code(i.code,serializeValue(i.scope,t)):"DBRef"===n&&i.oid&&(i=new db_ref(i.collection,serializeValue(i.oid,t),i.db,i.fields)),i.toExtendedJSON(t)}throw new Error("_bsontype must be a string, but was: "+_typeof$2(n))}var extended_json={parse:parse,deserialize:deserialize,serialize:serialize,stringify:stringify},FIRST_BIT=128,FIRST_TWO_BITS=192,FIRST_THREE_BITS=224,FIRST_FOUR_BITS=240,FIRST_FIVE_BITS=248,TWO_BIT_CHAR=192,THREE_BIT_CHAR=224,FOUR_BIT_CHAR=240,CONTINUING_CHAR=128;function validateUtf8(e,t,n){for(var r=0,o=t;o<n;o+=1){var i=e[o];if(r){if((i&FIRST_TWO_BITS)!==CONTINUING_CHAR)return!1;r-=1}else if(i&FIRST_BIT)if((i&FIRST_THREE_BITS)===TWO_BIT_CHAR)r=1;else if((i&FIRST_FOUR_BITS)===THREE_BIT_CHAR)r=2;else{if((i&FIRST_FIVE_BITS)!==FOUR_BIT_CHAR)return!1;r=3}}return!r}var validateUtf8_1=validateUtf8,validate_utf8={validateUtf8:validateUtf8_1},Buffer$4=buffer__WEBPACK_IMPORTED_MODULE_1___default.a.Buffer,validateUtf8$1=validate_utf8.validateUtf8,JS_INT_MAX_LONG=long_1.fromNumber(constants.JS_INT_MAX),JS_INT_MIN_LONG=long_1.fromNumber(constants.JS_INT_MIN),functionCache={};function deserialize$1(e,t,n){var r=(t=null==t?{}:t)&&t.index?t.index:0,o=e[r]|e[r+1]<<8|e[r+2]<<16|e[r+3]<<24;if(o<5)throw new Error("bson size must be >= 5, is ".concat(o));if(t.allowObjectSmallerThanBufferSize&&e.length<o)throw new Error("buffer length ".concat(e.length," must be >= bson size ").concat(o));if(!t.allowObjectSmallerThanBufferSize&&e.length!==o)throw new Error("buffer length ".concat(e.length," must === bson size ").concat(o));if(o+r>e.length)throw new Error("(bson size ".concat(o," + options.index ").concat(r," must be <= buffer length ").concat(Buffer$4.byteLength(e),")"));if(0!==e[r+o-1])throw new Error("One object, sized correctly, with a spot for an EOO, but the EOO isn't 0x00");return deserializeObject(e,r,t,n)}function deserializeObject(e,t,n,r){var o=null!=n.evalFunctions&&n.evalFunctions,i=null!=n.cacheFunctions&&n.cacheFunctions,s=null!=n.cacheFunctionsCrc32&&n.cacheFunctionsCrc32;if(!s)var a=null;var c=null==n.fieldsAsRaw?null:n.fieldsAsRaw,u=null!=n.raw&&n.raw,f="boolean"==typeof n.bsonRegExp&&n.bsonRegExp,l=null!=n.promoteBuffers&&n.promoteBuffers,h=null==n.promoteLongs||n.promoteLongs,d=null==n.promoteValues||n.promoteValues,p=t;if(e.length<5)throw new Error("corrupt bson message < 5 bytes long");var g=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;if(g<5||g>e.length)throw new Error("corrupt bson message");for(var _=r?[]:{},y=0;;){var m=e[t++];if(0===m)break;for(var b=t;0!==e[b]&&b<e.length;)b++;if(b>=Buffer$4.byteLength(e))throw new Error("Bad BSON Document: illegal CString");var v=r?y++:e.toString("utf8",t,b);if(t=b+1,m===constants.BSON_DATA_STRING){var w=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;if(w<=0||w>e.length-t||0!==e[t+w-1])throw new Error("bad string length in bson");if(!validateUtf8$1(e,t,t+w-1))throw new Error("Invalid UTF-8 string in BSON document");var E=e.toString("utf8",t,t+w-1);_[v]=E,t+=w}else if(m===constants.BSON_DATA_OID){var S=Buffer$4.alloc(12);e.copy(S,0,t,t+12),_[v]=new objectid(S),t+=12}else if(m===constants.BSON_DATA_INT&&!1===d)_[v]=new int_32(e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24);else if(m===constants.BSON_DATA_INT)_[v]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;else if(m===constants.BSON_DATA_NUMBER&&!1===d)_[v]=new double_1(e.readDoubleLE(t)),t+=8;else if(m===constants.BSON_DATA_NUMBER)_[v]=e.readDoubleLE(t),t+=8;else if(m===constants.BSON_DATA_DATE){var O=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24,T=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;_[v]=new Date(new long_1(O,T).toNumber())}else if(m===constants.BSON_DATA_BOOLEAN){if(0!==e[t]&&1!==e[t])throw new Error("illegal boolean type value");_[v]=1===e[t++]}else if(m===constants.BSON_DATA_OBJECT){var A=t,N=e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24;if(N<=0||N>e.length-t)throw new Error("bad embedded document length in bson");_[v]=u?e.slice(t,t+N):deserializeObject(e,A,n,!1),t+=N}else if(m===constants.BSON_DATA_ARRAY){var I=t,B=e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24,R=n,D=t+B;if(c&&c[v]){for(var x in R={},n)R[x]=n[x];R.raw=!0}if(_[v]=deserializeObject(e,I,R,!0),0!==e[(t+=B)-1])throw new Error("invalid array terminator byte");if(t!==D)throw new Error("corrupted array bson")}else if(m===constants.BSON_DATA_UNDEFINED)_[v]=void 0;else if(m===constants.BSON_DATA_NULL)_[v]=null;else if(m===constants.BSON_DATA_LONG){var P=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24,C=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24,j=new long_1(P,C);_[v]=h&&!0===d&&j.lessThanOrEqual(JS_INT_MAX_LONG)&&j.greaterThanOrEqual(JS_INT_MIN_LONG)?j.toNumber():j}else if(m===constants.BSON_DATA_DECIMAL128){var L=Buffer$4.alloc(16);e.copy(L,0,t,t+16),t+=16;var k=new decimal128(L);_[v]=k.toObject?k.toObject():k}else if(m===constants.BSON_DATA_BINARY){var $=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24,M=$,U=e[t++];if($<0)throw new Error("Negative binary type element size found");if($>Buffer$4.byteLength(e))throw new Error("Binary type size larger than document size");if(null!=e.slice){if(U===binary.SUBTYPE_BYTE_ARRAY){if(($=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24)<0)throw new Error("Negative binary type element size found for subtype 0x02");if($>M-4)throw new Error("Binary type with subtype 0x02 contains to long binary size");if($<M-4)throw new Error("Binary type with subtype 0x02 contains to short binary size")}_[v]=l&&d?e.slice(t,t+$):new binary(e.slice(t,t+$),U)}else{var F="undefined"!=typeof Uint8Array?new Uint8Array(new ArrayBuffer($)):new Array($);if(U===binary.SUBTYPE_BYTE_ARRAY){if(($=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24)<0)throw new Error("Negative binary type element size found for subtype 0x02");if($>M-4)throw new Error("Binary type with subtype 0x02 contains to long binary size");if($<M-4)throw new Error("Binary type with subtype 0x02 contains to short binary size")}for(b=0;b<$;b++)F[b]=e[t+b];_[v]=l&&d?F:new binary(F,U)}t+=$}else if(m===constants.BSON_DATA_REGEXP&&!1===f){for(b=t;0!==e[b]&&b<e.length;)b++;if(b>=e.length)throw new Error("Bad BSON Document: illegal CString");var z=e.toString("utf8",t,b);for(b=t=b+1;0!==e[b]&&b<e.length;)b++;if(b>=e.length)throw new Error("Bad BSON Document: illegal CString");var q=e.toString("utf8",t,b);t=b+1;var W=new Array(q.length);for(b=0;b<q.length;b++)switch(q[b]){case"m":W[b]="m";break;case"s":W[b]="g";break;case"i":W[b]="i"}_[v]=new RegExp(z,W.join(""))}else if(m===constants.BSON_DATA_REGEXP&&!0===f){for(b=t;0!==e[b]&&b<e.length;)b++;if(b>=e.length)throw new Error("Bad BSON Document: illegal CString");var Y=e.toString("utf8",t,b);for(b=t=b+1;0!==e[b]&&b<e.length;)b++;if(b>=e.length)throw new Error("Bad BSON Document: illegal CString");var G=e.toString("utf8",t,b);t=b+1,_[v]=new regexp(Y,G)}else if(m===constants.BSON_DATA_SYMBOL){var K=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;if(K<=0||K>e.length-t||0!==e[t+K-1])throw new Error("bad string length in bson");_[v]=e.toString("utf8",t,t+K-1),t+=K}else if(m===constants.BSON_DATA_TIMESTAMP){var H=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24,J=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;_[v]=new timestamp(H,J)}else if(m===constants.BSON_DATA_MIN_KEY)_[v]=new min_key;else if(m===constants.BSON_DATA_MAX_KEY)_[v]=new max_key;else if(m===constants.BSON_DATA_CODE){var V=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;if(V<=0||V>e.length-t||0!==e[t+V-1])throw new Error("bad string length in bson");var X=e.toString("utf8",t,t+V-1);if(o)if(i){var Q=s?a(X):X;_[v]=isolateEvalWithHash(functionCache,Q,X,_)}else _[v]=isolateEval(X);else _[v]=new code(X);t+=V}else if(m===constants.BSON_DATA_CODE_W_SCOPE){var Z=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;if(Z<13)throw new Error("code_w_scope total size shorter minimum expected length");var ee=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;if(ee<=0||ee>e.length-t||0!==e[t+ee-1])throw new Error("bad string length in bson");var te=e.toString("utf8",t,t+ee-1),ne=t+=ee,re=e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24,oe=deserializeObject(e,ne,n,!1);if(t+=re,Z<8+re+ee)throw new Error("code_w_scope total size is to short, truncating scope");if(Z>8+re+ee)throw new Error("code_w_scope total size is to long, clips outer document");if(o){if(i){var ie=s?a(te):te;_[v]=isolateEvalWithHash(functionCache,ie,te,_)}else _[v]=isolateEval(te);_[v].scope=oe}else _[v]=new code(te,oe)}else{if(m!==constants.BSON_DATA_DBPOINTER)throw new Error("Detected unknown BSON type "+m.toString(16)+' for fieldname "'+v+'", are you using the latest BSON parser?');var se=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;if(se<=0||se>e.length-t||0!==e[t+se-1])throw new Error("bad string length in bson");if(!validateUtf8$1(e,t,t+se-1))throw new Error("Invalid UTF-8 string in BSON document");var ae=e.toString("utf8",t,t+se-1);t+=se;var ce=Buffer$4.alloc(12);e.copy(ce,0,t,t+12);var ue=new objectid(ce);t+=12,_[v]=new db_ref(ae,ue)}}if(g!==t-p){if(r)throw new Error("corrupt array bson");throw new Error("corrupt object bson")}var fe=Object.keys(_).filter(function(e){return e.startsWith("$")}),le=!0;if(fe.forEach(function(e){-1===["$ref","$id","$db"].indexOf(e)&&(le=!1)}),!le)return _;if(null!=_.$id&&null!=_.$ref){var he=Object.assign({},_);return delete he.$ref,delete he.$id,delete he.$db,new db_ref(_.$ref,_.$id,_.$db||null,he)}return _}function isolateEvalWithHash(functionCache,hash,functionString,object){var value=null;return null==functionCache[hash]&&(eval("value = "+functionString),functionCache[hash]=value),functionCache[hash].bind(object)}function isolateEval(functionString){var value=null;return eval("value = "+functionString),value}var deserializer=deserialize$1;function readIEEE754(e,t,n,r,o){var i,s,a="big"===n,c=8*o-r-1,u=(1<<c)-1,f=u>>1,l=-7,h=a?0:o-1,d=a?1:-1,p=e[t+h];for(h+=d,i=p&(1<<-l)-1,p>>=-l,l+=c;l>0;i=256*i+e[t+h],h+=d,l-=8);for(s=i&(1<<-l)-1,i>>=-l,l+=r;l>0;s=256*s+e[t+h],h+=d,l-=8);if(0===i)i=1-f;else{if(i===u)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),i-=f}return(p?-1:1)*s*Math.pow(2,i-r)}function writeIEEE754(e,t,n,r,o,i){var s,a,c,u="big"===r,f=8*i-o-1,l=(1<<f)-1,h=l>>1,d=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=u?i-1:0,g=u?-1:1,_=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+h>=1?d/c:d*Math.pow(2,1-h))*c>=2&&(s++,c/=2),s+h>=l?(a=0,s=l):s+h>=1?(a=(t*c-1)*Math.pow(2,o),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,o),s=0)),isNaN(t)&&(a=0);o>=8;)e[n+p]=255&a,p+=g,a/=256,o-=8;for(s=s<<o|a,isNaN(t)&&(s+=8),f+=o;f>0;)e[n+p]=255&s,p+=g,s/=256,f-=8;e[n+p-g]|=128*_}var float_parser={readIEEE754:readIEEE754,writeIEEE754:writeIEEE754};function _typeof$3(e){return(_typeof$3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Buffer$5=buffer__WEBPACK_IMPORTED_MODULE_1___default.a.Buffer,writeIEEE754$1=float_parser.writeIEEE754,normalizedFunctionString$1=utils.normalizedFunctionString,regexp$1=/\x00/,ignoreKeys=new Set(["$db","$ref","$id","$clusterTime"]),isDate$1=function(e){return"object"===_typeof$3(e)&&"[object Date]"===Object.prototype.toString.call(e)},isRegExp$1=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)};function serializeString(e,t,n,r,o){e[r++]=constants.BSON_DATA_STRING;var i=o?e.write(t,r,"ascii"):e.write(t,r,"utf8");e[(r=r+i+1)-1]=0;var s=e.write(n,r+4,"utf8");return e[r+3]=s+1>>24&255,e[r+2]=s+1>>16&255,e[r+1]=s+1>>8&255,e[r]=s+1&255,r=r+4+s,e[r++]=0,r}function serializeNumber(e,t,n,r,o){if(Math.floor(n)===n&&n>=constants.JS_INT_MIN&&n<=constants.JS_INT_MAX)if(n>=constants.BSON_INT32_MIN&&n<=constants.BSON_INT32_MAX)e[r++]=constants.BSON_DATA_INT,r+=o?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0,e[r++]=255&n,e[r++]=n>>8&255,e[r++]=n>>16&255,e[r++]=n>>24&255;else if(n>=constants.JS_INT_MIN&&n<=constants.JS_INT_MAX){e[r++]=constants.BSON_DATA_NUMBER,r+=o?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0,writeIEEE754$1(e,n,r,"little",52,8),r+=8}else{e[r++]=constants.BSON_DATA_LONG,r+=o?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0;var i=long_1.fromNumber(n),s=i.getLowBits(),a=i.getHighBits();e[r++]=255&s,e[r++]=s>>8&255,e[r++]=s>>16&255,e[r++]=s>>24&255,e[r++]=255&a,e[r++]=a>>8&255,e[r++]=a>>16&255,e[r++]=a>>24&255}else e[r++]=constants.BSON_DATA_NUMBER,r+=o?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0,writeIEEE754$1(e,n,r,"little",52,8),r+=8;return r}function serializeNull(e,t,n,r,o){return e[r++]=constants.BSON_DATA_NULL,r+=o?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0,r}function serializeBoolean(e,t,n,r,o){return e[r++]=constants.BSON_DATA_BOOLEAN,r+=o?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0,e[r++]=n?1:0,r}function serializeDate(e,t,n,r,o){e[r++]=constants.BSON_DATA_DATE,r+=o?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0;var i=long_1.fromNumber(n.getTime()),s=i.getLowBits(),a=i.getHighBits();return e[r++]=255&s,e[r++]=s>>8&255,e[r++]=s>>16&255,e[r++]=s>>24&255,e[r++]=255&a,e[r++]=a>>8&255,e[r++]=a>>16&255,e[r++]=a>>24&255,r}function serializeRegExp(e,t,n,r,o){if(e[r++]=constants.BSON_DATA_REGEXP,r+=o?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0,n.source&&null!=n.source.match(regexp$1))throw Error("value "+n.source+" must not contain null bytes");return r+=e.write(n.source,r,"utf8"),e[r++]=0,n.ignoreCase&&(e[r++]=105),n.global&&(e[r++]=115),n.multiline&&(e[r++]=109),e[r++]=0,r}function serializeBSONRegExp(e,t,n,r,o){if(e[r++]=constants.BSON_DATA_REGEXP,r+=o?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0,null!=n.pattern.match(regexp$1))throw Error("pattern "+n.pattern+" must not contain null bytes");return r+=e.write(n.pattern,r,"utf8"),e[r++]=0,r+=e.write(n.options.split("").sort().join(""),r,"utf8"),e[r++]=0,r}function serializeMinMax(e,t,n,r,o){return null===n?e[r++]=constants.BSON_DATA_NULL:"MinKey"===n._bsontype?e[r++]=constants.BSON_DATA_MIN_KEY:e[r++]=constants.BSON_DATA_MAX_KEY,r+=o?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0,r}function serializeObjectId(e,t,n,r,o){if(e[r++]=constants.BSON_DATA_OID,r+=o?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0,"string"==typeof n.id)e.write(n.id,r,"binary");else{if(!n.id||!n.id.copy)throw new TypeError("object ["+JSON.stringify(n)+"] is not a valid ObjectId");n.id.copy(e,r,0,12)}return r+12}function serializeBuffer(e,t,n,r,o){e[r++]=constants.BSON_DATA_BINARY,r+=o?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0;var i=n.length;return e[r++]=255&i,e[r++]=i>>8&255,e[r++]=i>>16&255,e[r++]=i>>24&255,e[r++]=constants.BSON_BINARY_SUBTYPE_DEFAULT,n.copy(e,r,0,i),r+=i}function serializeObject(e,t,n,r,o,i,s,a,c,u){for(var f=0;f<u.length;f++)if(u[f]===n)throw new Error("cyclic dependency detected");u.push(n),e[r++]=Array.isArray(n)?constants.BSON_DATA_ARRAY:constants.BSON_DATA_OBJECT,r+=c?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0;var l=serializeInto(e,n,o,r,i+1,s,a,u);return u.pop(),l}function serializeDecimal128(e,t,n,r,o){return e[r++]=constants.BSON_DATA_DECIMAL128,r+=o?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0,n.bytes.copy(e,r,0,16),r+16}function serializeLong(e,t,n,r,o){e[r++]="Long"===n._bsontype?constants.BSON_DATA_LONG:constants.BSON_DATA_TIMESTAMP,r+=o?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0;var i=n.getLowBits(),s=n.getHighBits();return e[r++]=255&i,e[r++]=i>>8&255,e[r++]=i>>16&255,e[r++]=i>>24&255,e[r++]=255&s,e[r++]=s>>8&255,e[r++]=s>>16&255,e[r++]=s>>24&255,r}function serializeInt32(e,t,n,r,o){return e[r++]=constants.BSON_DATA_INT,r+=o?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0,e[r++]=255&n,e[r++]=n>>8&255,e[r++]=n>>16&255,e[r++]=n>>24&255,r}function serializeDouble(e,t,n,r,o){return e[r++]=constants.BSON_DATA_NUMBER,r+=o?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0,writeIEEE754$1(e,n.value,r,"little",52,8),r+=8}function serializeFunction(e,t,n,r,o,i,s){e[r++]=constants.BSON_DATA_CODE,r+=s?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0;var a=normalizedFunctionString$1(n),c=e.write(a,r+4,"utf8")+1;return e[r]=255&c,e[r+1]=c>>8&255,e[r+2]=c>>16&255,e[r+3]=c>>24&255,r=r+4+c-1,e[r++]=0,r}function serializeCode(e,t,n,r,o,i,s,a,c){if(n.scope&&"object"===_typeof$3(n.scope)){e[r++]=constants.BSON_DATA_CODE_W_SCOPE,r+=c?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0;var u=r,f="string"==typeof n.code?n.code:n.code.toString();r+=4;var l=e.write(f,r+4,"utf8")+1;e[r]=255&l,e[r+1]=l>>8&255,e[r+2]=l>>16&255,e[r+3]=l>>24&255,e[r+4+l-1]=0,r=r+l+4;var h=serializeInto(e,n.scope,o,r,i+1,s,a);r=h-1;var d=h-u;e[u++]=255&d,e[u++]=d>>8&255,e[u++]=d>>16&255,e[u++]=d>>24&255,e[r++]=0}else{e[r++]=constants.BSON_DATA_CODE,r+=c?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0;var p=n.code.toString(),g=e.write(p,r+4,"utf8")+1;e[r]=255&g,e[r+1]=g>>8&255,e[r+2]=g>>16&255,e[r+3]=g>>24&255,r=r+4+g-1,e[r++]=0}return r}function serializeBinary(e,t,n,r,o){e[r++]=constants.BSON_DATA_BINARY,r+=o?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0;var i=n.value(!0),s=n.position;return n.sub_type===binary.SUBTYPE_BYTE_ARRAY&&(s+=4),e[r++]=255&s,e[r++]=s>>8&255,e[r++]=s>>16&255,e[r++]=s>>24&255,e[r++]=n.sub_type,n.sub_type===binary.SUBTYPE_BYTE_ARRAY&&(s-=4,e[r++]=255&s,e[r++]=s>>8&255,e[r++]=s>>16&255,e[r++]=s>>24&255),i.copy(e,r,0,n.position),r+=n.position}function serializeSymbol(e,t,n,r,o){e[r++]=constants.BSON_DATA_SYMBOL,r+=o?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0;var i=e.write(n.value,r+4,"utf8")+1;return e[r]=255&i,e[r+1]=i>>8&255,e[r+2]=i>>16&255,e[r+3]=i>>24&255,r=r+4+i-1,e[r++]=0,r}function serializeDBRef(e,t,n,r,o,i,s){e[r++]=constants.BSON_DATA_OBJECT,r+=s?e.write(t,r,"ascii"):e.write(t,r,"utf8"),e[r++]=0;var a,c=r,u={$ref:n.collection||n.namespace,$id:n.oid};null!=n.db&&(u.$db=n.db);var f=(a=serializeInto(e,u=Object.assign(u,n.fields),!1,r,o+1,i))-c;return e[c++]=255&f,e[c++]=f>>8&255,e[c++]=f>>16&255,e[c++]=f>>24&255,a}function serializeInto(e,t,n,r,o,i,s,a){r=r||0,(a=a||[]).push(t);var c=r+4;if(Array.isArray(t))for(var u=0;u<t.length;u++){var f=""+u,l=t[u];if(l&&l.toBSON){if("function"!=typeof l.toBSON)throw new TypeError("toBSON is not a function");l=l.toBSON()}var h=_typeof$3(l);if("string"===h)c=serializeString(e,f,l,c,!0);else if("number"===h)c=serializeNumber(e,f,l,c,!0);else if("boolean"===h)c=serializeBoolean(e,f,l,c,!0);else if(l instanceof Date||isDate$1(l))c=serializeDate(e,f,l,c,!0);else if(void 0===l)c=serializeNull(e,f,l,c,!0);else if(null===l)c=serializeNull(e,f,l,c,!0);else if("ObjectId"===l._bsontype||"ObjectID"===l._bsontype)c=serializeObjectId(e,f,l,c,!0);else if(Buffer$5.isBuffer(l))c=serializeBuffer(e,f,l,c,!0);else if(l instanceof RegExp||isRegExp$1(l))c=serializeRegExp(e,f,l,c,!0);else if("object"===h&&null==l._bsontype)c=serializeObject(e,f,l,c,n,o,i,s,!0,a);else if("object"===h&&"Decimal128"===l._bsontype)c=serializeDecimal128(e,f,l,c,!0);else if("Long"===l._bsontype||"Timestamp"===l._bsontype)c=serializeLong(e,f,l,c,!0);else if("Double"===l._bsontype)c=serializeDouble(e,f,l,c,!0);else if("function"==typeof l&&i)c=serializeFunction(e,f,l,c,n,o,i,!0);else if("Code"===l._bsontype)c=serializeCode(e,f,l,c,n,o,i,s,!0);else if("Binary"===l._bsontype)c=serializeBinary(e,f,l,c,!0);else if("Symbol"===l._bsontype)c=serializeSymbol(e,f,l,c,!0);else if("DBRef"===l._bsontype)c=serializeDBRef(e,f,l,c,o,i,!0);else if("BSONRegExp"===l._bsontype)c=serializeBSONRegExp(e,f,l,c,!0);else if("Int32"===l._bsontype)c=serializeInt32(e,f,l,c,!0);else if("MinKey"===l._bsontype||"MaxKey"===l._bsontype)c=serializeMinMax(e,f,l,c,!0);else if(void 0!==l._bsontype)throw new TypeError("Unrecognized or invalid _bsontype: "+l._bsontype)}else if(t instanceof map)for(var d=t.entries(),p=!1;!p;){var g=d.next();if(!(p=g.done)){var _=g.value[0],y=g.value[1],m=_typeof$3(y);if("string"==typeof _&&!ignoreKeys.has(_)){if(null!=_.match(regexp$1))throw Error("key "+_+" must not contain null bytes");if(n){if("$"===_[0])throw Error("key "+_+" must not start with '$'");if(~_.indexOf("."))throw Error("key "+_+" must not contain '.'")}}if("string"===m)c=serializeString(e,_,y,c);else if("number"===m)c=serializeNumber(e,_,y,c);else if("boolean"===m)c=serializeBoolean(e,_,y,c);else if(y instanceof Date||isDate$1(y))c=serializeDate(e,_,y,c);else if(null===y||void 0===y&&!1===s)c=serializeNull(e,_,y,c);else if("ObjectId"===y._bsontype||"ObjectID"===y._bsontype)c=serializeObjectId(e,_,y,c);else if(Buffer$5.isBuffer(y))c=serializeBuffer(e,_,y,c);else if(y instanceof RegExp||isRegExp$1(y))c=serializeRegExp(e,_,y,c);else if("object"===m&&null==y._bsontype)c=serializeObject(e,_,y,c,n,o,i,s,!1,a);else if("object"===m&&"Decimal128"===y._bsontype)c=serializeDecimal128(e,_,y,c);else if("Long"===y._bsontype||"Timestamp"===y._bsontype)c=serializeLong(e,_,y,c);else if("Double"===y._bsontype)c=serializeDouble(e,_,y,c);else if("Code"===y._bsontype)c=serializeCode(e,_,y,c,n,o,i,s);else if("function"==typeof y&&i)c=serializeFunction(e,_,y,c,n,o,i);else if("Binary"===y._bsontype)c=serializeBinary(e,_,y,c);else if("Symbol"===y._bsontype)c=serializeSymbol(e,_,y,c);else if("DBRef"===y._bsontype)c=serializeDBRef(e,_,y,c,o,i);else if("BSONRegExp"===y._bsontype)c=serializeBSONRegExp(e,_,y,c);else if("Int32"===y._bsontype)c=serializeInt32(e,_,y,c);else if("MinKey"===y._bsontype||"MaxKey"===y._bsontype)c=serializeMinMax(e,_,y,c);else if(void 0!==y._bsontype)throw new TypeError("Unrecognized or invalid _bsontype: "+y._bsontype)}}else{if(t.toBSON){if("function"!=typeof t.toBSON)throw new TypeError("toBSON is not a function");if(null!=(t=t.toBSON())&&"object"!==_typeof$3(t))throw new TypeError("toBSON function did not return an object")}for(var b in t){var v=t[b];if(v&&v.toBSON){if("function"!=typeof v.toBSON)throw new TypeError("toBSON is not a function");v=v.toBSON()}var w=_typeof$3(v);if("string"==typeof b&&!ignoreKeys.has(b)){if(null!=b.match(regexp$1))throw Error("key "+b+" must not contain null bytes");if(n){if("$"===b[0])throw Error("key "+b+" must not start with '$'");if(~b.indexOf("."))throw Error("key "+b+" must not contain '.'")}}if("string"===w)c=serializeString(e,b,v,c);else if("number"===w)c=serializeNumber(e,b,v,c);else if("boolean"===w)c=serializeBoolean(e,b,v,c);else if(v instanceof Date||isDate$1(v))c=serializeDate(e,b,v,c);else if(void 0===v)!1===s&&(c=serializeNull(e,b,v,c));else if(null===v)c=serializeNull(e,b,v,c);else if("ObjectId"===v._bsontype||"ObjectID"===v._bsontype)c=serializeObjectId(e,b,v,c);else if(Buffer$5.isBuffer(v))c=serializeBuffer(e,b,v,c);else if(v instanceof RegExp||isRegExp$1(v))c=serializeRegExp(e,b,v,c);else if("object"===w&&null==v._bsontype)c=serializeObject(e,b,v,c,n,o,i,s,!1,a);else if("object"===w&&"Decimal128"===v._bsontype)c=serializeDecimal128(e,b,v,c);else if("Long"===v._bsontype||"Timestamp"===v._bsontype)c=serializeLong(e,b,v,c);else if("Double"===v._bsontype)c=serializeDouble(e,b,v,c);else if("Code"===v._bsontype)c=serializeCode(e,b,v,c,n,o,i,s);else if("function"==typeof v&&i)c=serializeFunction(e,b,v,c,n,o,i);else if("Binary"===v._bsontype)c=serializeBinary(e,b,v,c);else if("Symbol"===v._bsontype)c=serializeSymbol(e,b,v,c);else if("DBRef"===v._bsontype)c=serializeDBRef(e,b,v,c,o,i);else if("BSONRegExp"===v._bsontype)c=serializeBSONRegExp(e,b,v,c);else if("Int32"===v._bsontype)c=serializeInt32(e,b,v,c);else if("MinKey"===v._bsontype||"MaxKey"===v._bsontype)c=serializeMinMax(e,b,v,c);else if(void 0!==v._bsontype)throw new TypeError("Unrecognized or invalid _bsontype: "+v._bsontype)}}a.pop(),e[c++]=0;var E=c-r;return e[r++]=255&E,e[r++]=E>>8&255,e[r++]=E>>16&255,e[r++]=E>>24&255,c}var serializer=serializeInto;function _typeof$4(e){return(_typeof$4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Buffer$6=buffer__WEBPACK_IMPORTED_MODULE_1___default.a.Buffer,normalizedFunctionString$2=utils.normalizedFunctionString;function isDate$2(e){return"object"===_typeof$4(e)&&"[object Date]"===Object.prototype.toString.call(e)}function calculateObjectSize(e,t,n){var r=5;if(Array.isArray(e))for(var o=0;o<e.length;o++)r+=calculateElement(o.toString(),e[o],t,!0,n);else for(var i in e.toBSON&&(e=e.toBSON()),e)r+=calculateElement(i,e[i],t,!1,n);return r}function calculateElement(e,t,n,r,o){switch(t&&t.toBSON&&(t=t.toBSON()),_typeof$4(t)){case"string":return 1+Buffer$6.byteLength(e,"utf8")+1+4+Buffer$6.byteLength(t,"utf8")+1;case"number":return Math.floor(t)===t&&t>=constants.JS_INT_MIN&&t<=constants.JS_INT_MAX&&t>=constants.BSON_INT32_MIN&&t<=constants.BSON_INT32_MAX?(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+5:(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+9;case"undefined":return r||!o?(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+1:0;case"boolean":return(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+2;case"object":if(null==t||"MinKey"===t._bsontype||"MaxKey"===t._bsontype)return(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+1;if("ObjectId"===t._bsontype||"ObjectID"===t._bsontype)return(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+13;if(t instanceof Date||isDate$2(t))return(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+9;if(void 0!==Buffer$6&&Buffer$6.isBuffer(t))return(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+6+t.length;if("Long"===t._bsontype||"Double"===t._bsontype||"Timestamp"===t._bsontype)return(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+9;if("Decimal128"===t._bsontype)return(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+17;if("Code"===t._bsontype)return null!=t.scope&&Object.keys(t.scope).length>0?(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+1+4+4+Buffer$6.byteLength(t.code.toString(),"utf8")+1+calculateObjectSize(t.scope,n,o):(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+1+4+Buffer$6.byteLength(t.code.toString(),"utf8")+1;if("Binary"===t._bsontype)return t.sub_type===binary.SUBTYPE_BYTE_ARRAY?(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+(t.position+1+4+1+4):(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+(t.position+1+4+1);if("Symbol"===t._bsontype)return(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+Buffer$6.byteLength(t.value,"utf8")+4+1+1;if("DBRef"===t._bsontype){var i=Object.assign({$ref:t.collection,$id:t.oid},t.fields);return null!=t.db&&(i.$db=t.db),(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+1+calculateObjectSize(i,n,o)}return t instanceof RegExp||"[object RegExp]"===Object.prototype.toString.call(t)?(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+1+Buffer$6.byteLength(t.source,"utf8")+1+(t.global?1:0)+(t.ignoreCase?1:0)+(t.multiline?1:0)+1:"BSONRegExp"===t._bsontype?(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+1+Buffer$6.byteLength(t.pattern,"utf8")+1+Buffer$6.byteLength(t.options,"utf8")+1:(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+calculateObjectSize(t,n,o)+1;case"function":if(t instanceof RegExp||"[object RegExp]"===Object.prototype.toString.call(t)||"[object RegExp]"===String.call(t))return(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+1+Buffer$6.byteLength(t.source,"utf8")+1+(t.global?1:0)+(t.ignoreCase?1:0)+(t.multiline?1:0)+1;if(n&&null!=t.scope&&Object.keys(t.scope).length>0)return(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+1+4+4+Buffer$6.byteLength(normalizedFunctionString$2(t),"utf8")+1+calculateObjectSize(t.scope,n,o);if(n)return(null!=e?Buffer$6.byteLength(e,"utf8")+1:0)+1+4+Buffer$6.byteLength(normalizedFunctionString$2(t),"utf8")+1}return 0}var calculate_size=calculateObjectSize,Buffer$7=buffer__WEBPACK_IMPORTED_MODULE_1___default.a.Buffer,ensure_buffer=function(e){if(e instanceof Buffer$7)return e;if(e instanceof Uint8Array)return Buffer$7.from(e.buffer);throw new TypeError("Must use either Buffer or Uint8Array")},Buffer$8=buffer__WEBPACK_IMPORTED_MODULE_1___default.a.Buffer,MAXSIZE=17825792,buffer$1=Buffer$8.alloc(MAXSIZE);function setInternalBufferSize(e){buffer$1.length<e&&(buffer$1=Buffer$8.alloc(e))}function serialize$1(e,t){var n="boolean"==typeof(t=t||{}).checkKeys&&t.checkKeys,r="boolean"==typeof t.serializeFunctions&&t.serializeFunctions,o="boolean"!=typeof t.ignoreUndefined||t.ignoreUndefined,i="number"==typeof t.minInternalBufferSize?t.minInternalBufferSize:MAXSIZE;buffer$1.length<i&&(buffer$1=Buffer$8.alloc(i));var s=serializer(buffer$1,e,n,0,0,r,o,[]),a=Buffer$8.alloc(s);return buffer$1.copy(a,0,0,a.length),a}function serializeWithBufferAndIndex(e,t,n){var r="boolean"==typeof(n=n||{}).checkKeys&&n.checkKeys,o="boolean"==typeof n.serializeFunctions&&n.serializeFunctions,i="boolean"!=typeof n.ignoreUndefined||n.ignoreUndefined,s="number"==typeof n.index?n.index:0,a=serializer(buffer$1,e,r,0,0,o,i);return buffer$1.copy(t,s,0,a),s+a-1}function deserialize$2(e,t){return e=ensure_buffer(e),deserializer(e,t)}function calculateObjectSize$1(e,t){var n="boolean"==typeof(t=t||{}).serializeFunctions&&t.serializeFunctions,r="boolean"!=typeof t.ignoreUndefined||t.ignoreUndefined;return calculate_size(e,n,r)}function deserializeStream(e,t,n,r,o,i){i=Object.assign({allowObjectSmallerThanBufferSize:!0},i),e=ensure_buffer(e);for(var s=t,a=0;a<n;a++){var c=e[s]|e[s+1]<<8|e[s+2]<<16|e[s+3]<<24;i.index=s,r[o+a]=deserializer(e,i),s+=c}return s}var bson={BSON_INT32_MAX:constants.BSON_INT32_MAX,BSON_INT32_MIN:constants.BSON_INT32_MIN,BSON_INT64_MAX:constants.BSON_INT64_MAX,BSON_INT64_MIN:constants.BSON_INT64_MIN,JS_INT_MAX:constants.JS_INT_MAX,JS_INT_MIN:constants.JS_INT_MIN,BSON_DATA_NUMBER:constants.BSON_DATA_NUMBER,BSON_DATA_STRING:constants.BSON_DATA_STRING,BSON_DATA_OBJECT:constants.BSON_DATA_OBJECT,BSON_DATA_ARRAY:constants.BSON_DATA_ARRAY,BSON_DATA_BINARY:constants.BSON_DATA_BINARY,BSON_DATA_UNDEFINED:constants.BSON_DATA_UNDEFINED,BSON_DATA_OID:constants.BSON_DATA_OID,BSON_DATA_BOOLEAN:constants.BSON_DATA_BOOLEAN,BSON_DATA_DATE:constants.BSON_DATA_DATE,BSON_DATA_NULL:constants.BSON_DATA_NULL,BSON_DATA_REGEXP:constants.BSON_DATA_REGEXP,BSON_DATA_DBPOINTER:constants.BSON_DATA_DBPOINTER,BSON_DATA_CODE:constants.BSON_DATA_CODE,BSON_DATA_SYMBOL:constants.BSON_DATA_SYMBOL,BSON_DATA_CODE_W_SCOPE:constants.BSON_DATA_CODE_W_SCOPE,BSON_DATA_INT:constants.BSON_DATA_INT,BSON_DATA_TIMESTAMP:constants.BSON_DATA_TIMESTAMP,BSON_DATA_LONG:constants.BSON_DATA_LONG,BSON_DATA_DECIMAL128:constants.BSON_DATA_DECIMAL128,BSON_DATA_MIN_KEY:constants.BSON_DATA_MIN_KEY,BSON_DATA_MAX_KEY:constants.BSON_DATA_MAX_KEY,BSON_BINARY_SUBTYPE_DEFAULT:constants.BSON_BINARY_SUBTYPE_DEFAULT,BSON_BINARY_SUBTYPE_FUNCTION:constants.BSON_BINARY_SUBTYPE_FUNCTION,BSON_BINARY_SUBTYPE_BYTE_ARRAY:constants.BSON_BINARY_SUBTYPE_BYTE_ARRAY,BSON_BINARY_SUBTYPE_UUID:constants.BSON_BINARY_SUBTYPE_UUID,BSON_BINARY_SUBTYPE_MD5:constants.BSON_BINARY_SUBTYPE_MD5,BSON_BINARY_SUBTYPE_USER_DEFINED:constants.BSON_BINARY_SUBTYPE_USER_DEFINED,Code:code,Map:map,BSONSymbol:symbol,DBRef:db_ref,Binary:binary,ObjectId:objectid,Long:long_1,Timestamp:timestamp,Double:double_1,Int32:int_32,MinKey:min_key,MaxKey:max_key,BSONRegExp:regexp,Decimal128:decimal128,serialize:serialize$1,serializeWithBufferAndIndex:serializeWithBufferAndIndex,deserialize:deserialize$2,calculateObjectSize:calculateObjectSize$1,deserializeStream:deserializeStream,setInternalBufferSize:setInternalBufferSize,ObjectID:objectid,EJSON:extended_json},bson_1=bson.BSON_INT32_MAX,bson_2=bson.BSON_INT32_MIN,bson_3=bson.BSON_INT64_MAX,bson_4=bson.BSON_INT64_MIN,bson_5=bson.JS_INT_MAX,bson_6=bson.JS_INT_MIN,bson_7=bson.BSON_DATA_NUMBER,bson_8=bson.BSON_DATA_STRING,bson_9=bson.BSON_DATA_OBJECT,bson_10=bson.BSON_DATA_ARRAY,bson_11=bson.BSON_DATA_BINARY,bson_12=bson.BSON_DATA_UNDEFINED,bson_13=bson.BSON_DATA_OID,bson_14=bson.BSON_DATA_BOOLEAN,bson_15=bson.BSON_DATA_DATE,bson_16=bson.BSON_DATA_NULL,bson_17=bson.BSON_DATA_REGEXP,bson_18=bson.BSON_DATA_DBPOINTER,bson_19=bson.BSON_DATA_CODE,bson_20=bson.BSON_DATA_SYMBOL,bson_21=bson.BSON_DATA_CODE_W_SCOPE,bson_22=bson.BSON_DATA_INT,bson_23=bson.BSON_DATA_TIMESTAMP,bson_24=bson.BSON_DATA_LONG,bson_25=bson.BSON_DATA_DECIMAL128,bson_26=bson.BSON_DATA_MIN_KEY,bson_27=bson.BSON_DATA_MAX_KEY,bson_28=bson.BSON_BINARY_SUBTYPE_DEFAULT,bson_29=bson.BSON_BINARY_SUBTYPE_FUNCTION,bson_30=bson.BSON_BINARY_SUBTYPE_BYTE_ARRAY,bson_31=bson.BSON_BINARY_SUBTYPE_UUID,bson_32=bson.BSON_BINARY_SUBTYPE_MD5,bson_33=bson.BSON_BINARY_SUBTYPE_USER_DEFINED,bson_34=bson.Code,bson_35=bson.BSONSymbol,bson_36=bson.DBRef,bson_37=bson.Binary,bson_38=bson.ObjectId,bson_39=bson.Long,bson_40=bson.Timestamp,bson_41=bson.Double,bson_42=bson.Int32,bson_43=bson.MinKey,bson_44=bson.MaxKey,bson_45=bson.BSONRegExp,bson_46=bson.Decimal128,bson_47=bson.serialize,bson_48=bson.serializeWithBufferAndIndex,bson_49=bson.deserialize,bson_50=bson.calculateObjectSize,bson_51=bson.deserializeStream,bson_52=bson.setInternalBufferSize,bson_53=bson.ObjectID,bson_54=bson.EJSON,_unused_webpack_default_export=bson}).call(this,__webpack_require__(32),__webpack_require__(8).Buffer)},function(e,t,n){var r=n(107),o=n(112);e.exports=function(e,t){var n=o(e,t);return r(n)?n:void 0}},function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return s});var r=n(74),o=new r;function i(e,t){o.on(e,t)}function s(e,t){o.emit(e,t)}},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t){var n=Array.isArray;e.exports=n},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t){e.exports=r;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function r(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function o(e){return!0===(e&&e.__isLong__)}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0}),r.isLong=o;var i={},s={};function a(e,t){var n,r,o;return t?(o=0<=(e>>>=0)&&e<256)&&(r=s[e])?r:(n=u(e,(0|e)<0?-1:0,!0),o&&(s[e]=n),n):(o=-128<=(e|=0)&&e<128)&&(r=i[e])?r:(n=u(e,e<0?-1:0,!1),o&&(i[e]=n),n)}function c(e,t){if(isNaN(e))return t?m:y;if(t){if(e<0)return m;if(e>=p)return S}else{if(e<=-g)return O;if(e+1>=g)return E}return e<0?c(-e,t).neg():u(e%d|0,e/d|0,t)}function u(e,t,n){return new r(e,t,n)}r.fromInt=a,r.fromNumber=c,r.fromBits=u;var f=Math.pow;function l(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return y;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return l(e.substring(1),t,n).neg();for(var o=c(f(n,8)),i=y,s=0;s<e.length;s+=8){var a=Math.min(8,e.length-s),u=parseInt(e.substring(s,s+a),n);if(a<8){var h=c(f(n,a));i=i.mul(h).add(c(u))}else i=(i=i.mul(o)).add(c(u))}return i.unsigned=t,i}function h(e,t){return"number"==typeof e?c(e,t):"string"==typeof e?l(e,t):u(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}r.fromString=l,r.fromValue=h;var d=4294967296,p=d*d,g=p/2,_=a(1<<24),y=a(0);r.ZERO=y;var m=a(0,!0);r.UZERO=m;var b=a(1);r.ONE=b;var v=a(1,!0);r.UONE=v;var w=a(-1);r.NEG_ONE=w;var E=u(-1,2147483647,!1);r.MAX_VALUE=E;var S=u(-1,-1,!0);r.MAX_UNSIGNED_VALUE=S;var O=u(0,-2147483648,!1);r.MIN_VALUE=O;var T=r.prototype;T.toInt=function(){return this.unsigned?this.low>>>0:this.low},T.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},T.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(O)){var t=c(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var o=c(f(e,6),this.unsigned),i=this,s="";;){var a=i.div(o),u=(i.sub(a.mul(o)).toInt()>>>0).toString(e);if((i=a).isZero())return u+s;for(;u.length<6;)u="0"+u;s=""+u+s}},T.getHighBits=function(){return this.high},T.getHighBitsUnsigned=function(){return this.high>>>0},T.getLowBits=function(){return this.low},T.getLowBitsUnsigned=function(){return this.low>>>0},T.getNumBitsAbs=function(){if(this.isNegative())return this.eq(O)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},T.isZero=function(){return 0===this.high&&0===this.low},T.eqz=T.isZero,T.isNegative=function(){return!this.unsigned&&this.high<0},T.isPositive=function(){return this.unsigned||this.high>=0},T.isOdd=function(){return 1==(1&this.low)},T.isEven=function(){return 0==(1&this.low)},T.equals=function(e){return o(e)||(e=h(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},T.eq=T.equals,T.notEquals=function(e){return!this.eq(e)},T.neq=T.notEquals,T.ne=T.notEquals,T.lessThan=function(e){return this.comp(e)<0},T.lt=T.lessThan,T.lessThanOrEqual=function(e){return this.comp(e)<=0},T.lte=T.lessThanOrEqual,T.le=T.lessThanOrEqual,T.greaterThan=function(e){return this.comp(e)>0},T.gt=T.greaterThan,T.greaterThanOrEqual=function(e){return this.comp(e)>=0},T.gte=T.greaterThanOrEqual,T.ge=T.greaterThanOrEqual,T.compare=function(e){if(o(e)||(e=h(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},T.comp=T.compare,T.negate=function(){return!this.unsigned&&this.eq(O)?O:this.not().add(b)},T.neg=T.negate,T.add=function(e){o(e)||(e=h(e));var t=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,s=e.high>>>16,a=65535&e.high,c=e.low>>>16,f=0,l=0,d=0,p=0;return d+=(p+=i+(65535&e.low))>>>16,l+=(d+=r+c)>>>16,f+=(l+=n+a)>>>16,f+=t+s,u((d&=65535)<<16|(p&=65535),(f&=65535)<<16|(l&=65535),this.unsigned)},T.subtract=function(e){return o(e)||(e=h(e)),this.add(e.neg())},T.sub=T.subtract,T.multiply=function(e){if(this.isZero())return y;if(o(e)||(e=h(e)),n)return u(n.mul(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned);if(e.isZero())return y;if(this.eq(O))return e.isOdd()?O:y;if(e.eq(O))return this.isOdd()?O:y;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(_)&&e.lt(_))return c(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,r=65535&this.high,i=this.low>>>16,s=65535&this.low,a=e.high>>>16,f=65535&e.high,l=e.low>>>16,d=65535&e.low,p=0,g=0,m=0,b=0;return m+=(b+=s*d)>>>16,g+=(m+=i*d)>>>16,m&=65535,g+=(m+=s*l)>>>16,p+=(g+=r*d)>>>16,g&=65535,p+=(g+=i*l)>>>16,g&=65535,p+=(g+=s*f)>>>16,p+=t*d+r*l+i*f+s*a,u((m&=65535)<<16|(b&=65535),(p&=65535)<<16|(g&=65535),this.unsigned)},T.mul=T.multiply,T.divide=function(e){if(o(e)||(e=h(e)),e.isZero())throw Error("division by zero");var t,r,i;if(n)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?u((this.unsigned?n.div_u:n.div_s)(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?m:y;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return m;if(e.gt(this.shru(1)))return v;i=m}else{if(this.eq(O))return e.eq(b)||e.eq(w)?O:e.eq(O)?b:(t=this.shr(1).div(e).shl(1)).eq(y)?e.isNegative()?b:w:(r=this.sub(e.mul(t)),i=t.add(r.div(e)));if(e.eq(O))return this.unsigned?m:y;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=y}for(r=this;r.gte(e);){t=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(t)/Math.LN2),a=s<=48?1:f(2,s-48),l=c(t),d=l.mul(e);d.isNegative()||d.gt(r);)d=(l=c(t-=a,this.unsigned)).mul(e);l.isZero()&&(l=b),i=i.add(l),r=r.sub(d)}return i},T.div=T.divide,T.modulo=function(e){return o(e)||(e=h(e)),n?u((this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},T.mod=T.modulo,T.rem=T.modulo,T.not=function(){return u(~this.low,~this.high,this.unsigned)},T.and=function(e){return o(e)||(e=h(e)),u(this.low&e.low,this.high&e.high,this.unsigned)},T.or=function(e){return o(e)||(e=h(e)),u(this.low|e.low,this.high|e.high,this.unsigned)},T.xor=function(e){return o(e)||(e=h(e)),u(this.low^e.low,this.high^e.high,this.unsigned)},T.shiftLeft=function(e){return o(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?u(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):u(0,this.low<<e-32,this.unsigned)},T.shl=T.shiftLeft,T.shiftRight=function(e){return o(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?u(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):u(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},T.shr=T.shiftRight,T.shiftRightUnsigned=function(e){if(o(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?u(this.low>>>e|t<<32-e,t>>>e,this.unsigned):u(32===e?t:t>>>e-32,0,this.unsigned)},T.shru=T.shiftRightUnsigned,T.shr_u=T.shiftRightUnsigned,T.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},T.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},T.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},T.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},T.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},r.fromBytes=function(e,t,n){return n?r.fromBytesLE(e,t):r.fromBytesBE(e,t)},r.fromBytesLE=function(e,t){return new r(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},r.fromBytesBE=function(e,t){return new r(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},function(e,t,n){"use strict";var r,o={};n.r(o),n.d(o,"Point",function(){return z}),n.d(o,"LineString",function(){return P}),n.d(o,"Polygon",function(){return C}),n.d(o,"MultiPoint",function(){return j}),n.d(o,"MultiLineString",function(){return L}),n.d(o,"MultiPolygon",function(){return k}),function(e){e.DocIDError="文档ID不合法",e.CollNameError="集合名称不合法",e.OpStrError="操作符不合法",e.DirectionError="排序字符不合法",e.IntergerError="must be integer"}(r||(r={}));const i={String:"String",Number:"Number",Object:"Object",Array:"Array",Boolean:"Boolean",Null:"Null",GeoPoint:"GeoPoint",GeoLineString:"GeoLineString",GeoPolygon:"GeoPolygon",GeoMultiPoint:"GeoMultiPoint",GeoMultiLineString:"GeoMultiLineString",GeoMultiPolygon:"GeoMultiPolygon",Timestamp:"Date",Command:"Command",ServerDate:"ServerDate"},s=["desc","asc"],a=["<","<=","==",">=",">"];var c;!function(e){e.lt="<",e.gt=">",e.lte="<=",e.gte=">=",e.eq="=="}(c||(c={}));const u=[],f={};class l{constructor(e){Object.defineProperties(this,{target:{enumerable:!1,writable:!1,configurable:!1,value:e}})}}class h extends l{constructor(e,t){if(t!==f)throw new TypeError("InternalSymbol cannot be constructed with new operator");super(e)}static for(e){for(let t=0,n=u.length;t<n;t++)if(u[t].target===e)return u[t].instance;const t=new h(e,f);return u.push({target:e,instance:t}),t}}var d=h;const p=d.for("UNSET_FIELD_NAME"),g=d.for("UPDATE_COMMAND"),_=d.for("QUERY_COMMAND"),y=d.for("LOGIC_COMMAND"),m=d.for("GEO_POINT"),b=d.for("SYMBOL_GEO_LINE_STRING"),v=d.for("SYMBOL_GEO_POLYGON"),w=d.for("SYMBOL_GEO_MULTI_POINT"),E=d.for("SYMBOL_GEO_MULTI_LINE_STRING"),S=d.for("SYMBOL_GEO_MULTI_POLYGON"),O=d.for("SERVER_DATE"),T=d.for("REGEXP"),A=e=>Object.prototype.toString.call(e).slice(8,-1).toLowerCase(),N=e=>"object"===A(e),I=e=>"number"===A(e),B=e=>Array.isArray(e),R=e=>"date"===A(e),D=e=>"regexp"===A(e),x=e=>e&&e._internalType instanceof h;class P{constructor(e){if(!B(e))throw new TypeError(`"points" must be of type Point[]. Received type ${typeof e}`);if(e.length<2)throw new Error('"points" must contain 2 points at least');e.forEach(e=>{if(!(e instanceof z))throw new TypeError(`"points" must be of type Point[]. Received type ${typeof e}[]`)}),this.points=e}parse(e){return{[e]:{type:"LineString",coordinates:this.points.map(e=>e.toJSON().coordinates)}}}toJSON(){return{type:"LineString",coordinates:this.points.map(e=>e.toJSON().coordinates)}}static validate(e){if("LineString"!==e.type||!B(e.coordinates))return!1;for(let t of e.coordinates)if(!I(t[0])||!I(t[1]))return!1;return!0}static isClosed(e){const t=e.points[0],n=e.points[e.points.length-1];if(t.latitude===n.latitude&&t.longitude===n.longitude)return!0}get _internalType(){return b}}class C{constructor(e){if(!B(e))throw new TypeError(`"lines" must be of type LineString[]. Received type ${typeof e}`);if(0===e.length)throw new Error("Polygon must contain 1 linestring at least");e.forEach(e=>{if(!(e instanceof P))throw new TypeError(`"lines" must be of type LineString[]. Received type ${typeof e}[]`);if(!P.isClosed(e))throw new Error(`LineString ${e.points.map(e=>e.toReadableString())} is not a closed cycle`)}),this.lines=e}parse(e){return{[e]:{type:"Polygon",coordinates:this.lines.map(e=>e.points.map(e=>[e.longitude,e.latitude]))}}}toJSON(){return{type:"Polygon",coordinates:this.lines.map(e=>e.points.map(e=>[e.longitude,e.latitude]))}}static validate(e){if("Polygon"!==e.type||!B(e.coordinates))return!1;for(let t of e.coordinates){if(!this.isCloseLineString(t))return!1;for(let e of t)if(!I(e[0])||!I(e[1]))return!1}return!0}static isCloseLineString(e){const t=e[0],n=e[e.length-1];return t[0]===n[0]&&t[1]===n[1]}get _internalType(){return S}}class j{constructor(e){if(!B(e))throw new TypeError(`"points" must be of type Point[]. Received type ${typeof e}`);if(0===e.length)throw new Error('"points" must contain 1 point at least');e.forEach(e=>{if(!(e instanceof z))throw new TypeError(`"points" must be of type Point[]. Received type ${typeof e}[]`)}),this.points=e}parse(e){return{[e]:{type:"MultiPoint",coordinates:this.points.map(e=>e.toJSON().coordinates)}}}toJSON(){return{type:"MultiPoint",coordinates:this.points.map(e=>e.toJSON().coordinates)}}static validate(e){if("MultiPoint"!==e.type||!B(e.coordinates))return!1;for(let t of e.coordinates)if(!I(t[0])||!I(t[1]))return!1;return!0}get _internalType(){return w}}class L{constructor(e){if(!B(e))throw new TypeError(`"lines" must be of type LineString[]. Received type ${typeof e}`);if(0===e.length)throw new Error("Polygon must contain 1 linestring at least");e.forEach(e=>{if(!(e instanceof P))throw new TypeError(`"lines" must be of type LineString[]. Received type ${typeof e}[]`)}),this.lines=e}parse(e){return{[e]:{type:"MultiLineString",coordinates:this.lines.map(e=>e.points.map(e=>[e.longitude,e.latitude]))}}}toJSON(){return{type:"MultiLineString",coordinates:this.lines.map(e=>e.points.map(e=>[e.longitude,e.latitude]))}}static validate(e){if("MultiLineString"!==e.type||!B(e.coordinates))return!1;for(let t of e.coordinates)for(let e of t)if(!I(e[0])||!I(e[1]))return!1;return!0}get _internalType(){return E}}class k{constructor(e){if(!B(e))throw new TypeError(`"polygons" must be of type Polygon[]. Received type ${typeof e}`);if(0===e.length)throw new Error("MultiPolygon must contain 1 polygon at least");for(let t of e)if(!(t instanceof C))throw new TypeError(`"polygon" must be of type Polygon[]. Received type ${typeof t}[]`);this.polygons=e}parse(e){return{[e]:{type:"MultiPolygon",coordinates:this.polygons.map(e=>e.lines.map(e=>e.points.map(e=>[e.longitude,e.latitude])))}}}toJSON(){return{type:"MultiPolygon",coordinates:this.polygons.map(e=>e.lines.map(e=>e.points.map(e=>[e.longitude,e.latitude])))}}static validate(e){if("MultiPolygon"!==e.type||!B(e.coordinates))return!1;for(let t of e.coordinates)for(let e of t)for(let t of e)if(!I(t[0])||!I(t[1]))return!1;return!0}get _internalType(){return v}}class ${constructor({offset:e=0}={}){this.offset=e}get _internalType(){return O}parse(){return{$date:{offset:this.offset}}}}function M(e){return new $(e)}class U{}U.formatResDocumentData=e=>e.map(e=>U.formatField(e)),U.formatField=e=>{const t=Object.keys(e);let n={};return Array.isArray(e)&&(n=[]),t.forEach(t=>{const r=e[t];let o;switch(U.whichType(r)){case i.GeoPoint:o=new z(r.coordinates[0],r.coordinates[1]);break;case i.GeoLineString:o=new P(r.coordinates.map(e=>new z(e[0],e[1])));break;case i.GeoPolygon:o=new C(r.coordinates.map(e=>new P(e.map(([e,t])=>new z(e,t)))));break;case i.GeoMultiPoint:o=new j(r.coordinates.map(e=>new z(e[0],e[1])));break;case i.GeoMultiLineString:o=new L(r.coordinates.map(e=>new P(e.map(([e,t])=>new z(e,t)))));break;case i.GeoMultiPolygon:o=new k(r.coordinates.map(e=>new C(e.map(e=>new P(e.map(([e,t])=>new z(e,t)))))));break;case i.Timestamp:o=new Date(1e3*r.$timestamp);break;case i.Object:case i.Array:o=U.formatField(r);break;case i.ServerDate:o=new Date(r.$date);break;default:o=r}Array.isArray(n)?n.push(o):n[t]=o}),n},U.whichType=e=>{let t=Object.prototype.toString.call(e).slice(8,-1);if(t===i.Object){if(e instanceof z)return i.GeoPoint;if(e instanceof Date)return i.Timestamp;if(e instanceof $)return i.ServerDate;e.$timestamp?t=i.Timestamp:e.$date?t=i.ServerDate:z.validate(e)?t=i.GeoPoint:P.validate(e)?t=i.GeoLineString:C.validate(e)?t=i.GeoPolygon:j.validate(e)?t=i.GeoMultiPoint:L.validate(e)?t=i.GeoMultiLineString:k.validate(e)&&(t=i.GeoMultiPolygon)}return t},U.generateDocId=()=>{let e="ABCDEFabcdef0123456789",t="";for(let n=0;n<24;n++)t+=e.charAt(Math.floor(Math.random()*e.length));return t};class F{static isGeopoint(e,t){if(U.whichType(t)!==i.Number)throw new Error("Geo Point must be number type");const n=Math.abs(t);if("latitude"===e&&n>90)throw new Error("latitude should be a number ranges from -90 to 90");if("longitude"===e&&n>180)throw new Error("longitude should be a number ranges from -180 to 180");return!0}static isInteger(e,t){if(!Number.isInteger(t))throw new Error(e+r.IntergerError);return!0}static isFieldOrder(e){if(-1===s.indexOf(e))throw new Error(r.DirectionError);return!0}static isFieldPath(e){if(!/^[a-zA-Z0-9-_\.]/.test(e))throw new Error;return!0}static isOperator(e){if(-1===a.indexOf(e))throw new Error(r.OpStrError);return!0}static isCollName(e){if(!/^[a-zA-Z0-9]([a-zA-Z0-9-_]){1,32}$/.test(e))throw new Error(r.CollNameError);return!0}static isDocID(e){if(!/^([a-fA-F0-9]){24}$/.test(e))throw new Error(r.DocIDError);return!0}}class z{constructor(e,t){F.isGeopoint("longitude",e),F.isGeopoint("latitude",t),this.longitude=e,this.latitude=t}parse(e){return{[e]:{type:"Point",coordinates:[this.longitude,this.latitude]}}}toJSON(){return{type:"Point",coordinates:[this.longitude,this.latitude]}}toReadableString(){return`[${this.longitude},${this.latitude}]`}static validate(e){return"Point"===e.type&&B(e.coordinates)&&F.isGeopoint("longitude",e.coordinates[0])&&F.isGeopoint("latitude",e.coordinates[1])}get _internalType(){return m}}const q=()=>{let e;if(!Promise){(e=()=>{}).promise={};const t=()=>{throw new Error('Your Node runtime does support ES6 Promises. Set "global.Promise" to your preferred implementation of promises.')};return Object.defineProperty(e.promise,"then",{get:t}),Object.defineProperty(e.promise,"catch",{get:t}),e}const t=new Promise((t,n)=>{e=(e,r)=>e?n(e):t(r)});return e.promise=t,e};var W;!function(e){e.SET="set",e.REMOVE="remove",e.INC="inc",e.MUL="mul",e.PUSH="push",e.POP="pop",e.SHIFT="shift",e.UNSHIFT="unshift"}(W||(W={}));class Y{constructor(e,t,n){this._internalType=g,Object.defineProperties(this,{_internalType:{enumerable:!1,configurable:!1}}),this.operator=e,this.operands=t,this.fieldName=n||p}_setFieldName(e){return new Y(this.operator,this.operands,e)}}function G(e){return e&&e instanceof Y&&e._internalType===g}var K;!function(e){e.AND="and",e.OR="or",e.NOT="not",e.NOR="nor"}(K||(K={}));class H{constructor(e,t,n){if(this._internalType=y,Object.defineProperties(this,{_internalType:{enumerable:!1,configurable:!1}}),this.operator=e,this.operands=t,this.fieldName=n||p,this.fieldName!==p){t=t.slice(),this.operands=t;for(let e=0,n=t.length;e<n;e++){const n=t[e];(J(n)||Q(n))&&(t[e]=n._setFieldName(this.fieldName))}}}_setFieldName(e){const t=this.operands.map(t=>t instanceof H?t._setFieldName(e):t);return new H(this.operator,t,e)}and(...e){const t=Array.isArray(arguments[0])?arguments[0]:Array.from(arguments);return t.unshift(this),new H(K.AND,t,this.fieldName)}or(...e){const t=Array.isArray(arguments[0])?arguments[0]:Array.from(arguments);return t.unshift(this),new H(K.OR,t,this.fieldName)}}function J(e){return e&&e instanceof H&&e._internalType===y}var V;!function(e){e.EQ="eq",e.NEQ="neq",e.GT="gt",e.GTE="gte",e.LT="lt",e.LTE="lte",e.IN="in",e.NIN="nin",e.GEO_NEAR="geoNear",e.GEO_WITHIN="geoWithin",e.GEO_INTERSECTS="geoIntersects"}(V||(V={}));class X extends H{constructor(e,t,n){super(e,t,n),this.operator=e,this._internalType=_}_setFieldName(e){return new X(this.operator,this.operands,e)}eq(e){const t=new X(V.EQ,[e],this.fieldName);return this.and(t)}neq(e){const t=new X(V.NEQ,[e],this.fieldName);return this.and(t)}gt(e){const t=new X(V.GT,[e],this.fieldName);return this.and(t)}gte(e){const t=new X(V.GTE,[e],this.fieldName);return this.and(t)}lt(e){const t=new X(V.LT,[e],this.fieldName);return this.and(t)}lte(e){const t=new X(V.LTE,[e],this.fieldName);return this.and(t)}in(e){const t=new X(V.IN,e,this.fieldName);return this.and(t)}nin(e){const t=new X(V.NIN,e,this.fieldName);return this.and(t)}geoNear(e){if(!(e.geometry instanceof z))throw new TypeError(`"geometry" must be of type Point. Received type ${typeof e.geometry}`);if(void 0!==e.maxDistance&&!I(e.maxDistance))throw new TypeError(`"maxDistance" must be of type Number. Received type ${typeof e.maxDistance}`);if(void 0!==e.minDistance&&!I(e.minDistance))throw new TypeError(`"minDistance" must be of type Number. Received type ${typeof e.minDistance}`);const t=new X(V.GEO_NEAR,[e],this.fieldName);return this.and(t)}geoWithin(e){if(!(e.geometry instanceof k||e.geometry instanceof C))throw new TypeError(`"geometry" must be of type Polygon or MultiPolygon. Received type ${typeof e.geometry}`);const t=new X(V.GEO_WITHIN,[e],this.fieldName);return this.and(t)}geoIntersects(e){if(!(e.geometry instanceof z||e.geometry instanceof P||e.geometry instanceof C||e.geometry instanceof j||e.geometry instanceof L||e.geometry instanceof k))throw new TypeError(`"geometry" must be of type Point, LineString, Polygon, MultiPoint, MultiLineString or MultiPolygon. Received type ${typeof e.geometry}`);const t=new X(V.GEO_INTERSECTS,[e],this.fieldName);return this.and(t)}}function Q(e){return e&&e instanceof X&&e._internalType===_}function Z(e){return Q(e)}const ee={};for(const e in V)ee[e]=`$${e.toLowerCase()}`;for(const e in K)ee[e]=`$${e.toLowerCase()}`;for(const e in W)ee[e]=`$${e.toLowerCase()}`;function te(e){return ee[e]||`$${e.toLowerCase()}`}function ne(e){return function e(t,n){if(!x(t)){if(R(t))return{$date:+t};if(D(t))return{$regex:t.source,$options:t.flags};if(B(t))return t.map(t=>{if(n.indexOf(t)>-1)throw new Error("Cannot convert circular structure to JSON");return e(t,[...n,t])});if(N(t)){const r=Object.assign({},t);for(const t in r){if(n.indexOf(r[t])>-1)throw new Error("Cannot convert circular structure to JSON");r[t]=e(r[t],[...n,r[t]])}return r}return t}switch(t._internalType){case m:return t.toJSON();case O:case T:return t.parse();default:return t.toJSON?t.toJSON():t}}(e,[e])}function re(e,t,n,r){const o=Object.assign({},e);for(const i in e){if(/^\$/.test(i))continue;const s=e[i];if(s&&(N(s)&&!t(s))){if(r.indexOf(s)>-1)throw new Error("Cannot convert circular structure to JSON");const e=re(s,t,[...n,i],[...r,s]);o[i]=e;let a=!1;for(const t in e)/^\$/.test(t)?a=!0:(o[`${i}.${t}`]=e[t],delete o[i][t]);a||delete o[i]}}return o}function oe(e){return re(e,se,[],[e])}function ie(e,t,n){t[n]||delete e[n];for(const r in t)e[r]?B(e[r])?e[r].push(t[r]):N(e[r])?N(t[r])?Object.assign(e[r],t[r]):(console.warn(`unmergable condition, query is object but condition is ${A(t)}, can only overwrite`,t,n),e[r]=t[r]):(console.warn(`to-merge query is of type ${A(e)}, can only overwrite`,e,t,n),e[r]=t[r]):e[r]=t[r]}function se(e){return x(e)||R(e)||D(e)}function ae(e){return ne(e)}ee[V.NEQ]="$ne",ee[W.REMOVE]="$unset",ee[W.SHIFT]="$pop",ee[W.UNSHIFT]="$push";class ce{constructor(){}static encode(e){return(new ce).encodeUpdate(e)}encodeUpdate(e){return G(e)?this.encodeUpdateCommand(e):"object"===A(e)?this.encodeUpdateObject(e):e}encodeUpdateCommand(e){if(e.fieldName===p)throw new Error("Cannot encode a comparison command with unset field name");switch(e.operator){case W.SET:case W.REMOVE:case W.INC:case W.MUL:return this.encodeFieldUpdateCommand(e);case W.PUSH:case W.POP:case W.SHIFT:case W.UNSHIFT:return this.encodeArrayUpdateCommand(e);default:return this.encodeFieldUpdateCommand(e)}}encodeFieldUpdateCommand(e){const t=te(e.operator);switch(e.operator){case W.REMOVE:return{[t]:{[e.fieldName]:""}};case W.SET:case W.INC:case W.MUL:default:return{[t]:{[e.fieldName]:e.operands[0]}}}}encodeArrayUpdateCommand(e){const t=te(e.operator);switch(e.operator){case W.PUSH:{const n={$each:e.operands.map(ae)};return{[t]:{[e.fieldName]:n}}}case W.UNSHIFT:{const n={$each:e.operands.map(ae),$position:0};return{[t]:{[e.fieldName]:n}}}case W.POP:return{[t]:{[e.fieldName]:1}};case W.SHIFT:return{[t]:{[e.fieldName]:-1}};default:return{[t]:{[e.fieldName]:ae(e.operands)}}}}encodeUpdateObject(e){const t=oe(e);for(const e in t){if(/^\$/.test(e))continue;let n=t[e];if(G(n)){t[e]=n._setFieldName(e),ie(t,this.encodeUpdateCommand(t[e]),e)}else{t[e]=n=ae(n);const r=new Y(W.SET,[n],e);ie(t,this.encodeUpdateCommand(r),e)}}return t}}var ue=n(76),fe=n.n(ue),le=n(77),he=n.n(le),de=n(78),pe=n.n(de);function ge(e=""){return`${e?`${e}_`:""}${+new Date}_${Math.random()}`}const _e={UNKNOWN_ERROR:"UNKNOWN_ERROR",SDK_DATABASE_REALTIME_LISTENER_INIT_WATCH_FAIL:"SDK_DATABASE_REALTIME_LISTENER_INIT_WATCH_FAIL",SDK_DATABASE_REALTIME_LISTENER_RECONNECT_WATCH_FAIL:"SDK_DATABASE_REALTIME_LISTENER_RECONNECT_WATCH_FAIL",SDK_DATABASE_REALTIME_LISTENER_REBUILD_WATCH_FAIL:"SDK_DATABASE_REALTIME_LISTENER_REBUILD_WATCH_FAIL",SDK_DATABASE_REALTIME_LISTENER_CLOSE_WATCH_FAIL:"SDK_DATABASE_REALTIME_LISTENER_CLOSE_WATCH_FAIL",SDK_DATABASE_REALTIME_LISTENER_SERVER_ERROR_MSG:"SDK_DATABASE_REALTIME_LISTENER_SERVER_ERROR_MSG",SDK_DATABASE_REALTIME_LISTENER_RECEIVE_INVALID_SERVER_DATA:"SDK_DATABASE_REALTIME_LISTENER_RECEIVE_INVALID_SERVER_DATA",SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_ERROR:"SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_ERROR",SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_CLOSED:"SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_CLOSED",SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL:"SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL",SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR:"SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR"};class ye extends Error{constructor(e){super(e.errMsg),this.errCode="UNKNOWN_ERROR",Object.defineProperties(this,{message:{get(){return`errCode: ${this.errCode} ${_e[this.errCode]||""} | errMsg: `+this.errMsg},set(e){this.errMsg=e}}}),this.errCode=e.errCode||"UNKNOWN_ERROR",this.errMsg=e.errMsg}get message(){return`errCode: ${this.errCode} | errMsg: `+this.errMsg}set message(e){this.errMsg=e}}class me extends Error{constructor(e){super(e),this.type="timeout",this.payload=null,this.generic=!0}}const be=e=>"timeout"===e.type;class ve extends Error{constructor(e){super(e),this.type="cancelled",this.payload=null,this.generic=!0}}const we=e=>"cancelled"===e.type,Ee=(e=0)=>new Promise(t=>setTimeout(t,e));class Se{constructor(e){this.close=e.close,this.onChange=e.onChange,this.onError=e.onError,e.debug&&Object.defineProperty(this,"virtualClient",{get:()=>e.virtualClient})}}class Oe{constructor(e){const{id:t,docChanges:n,docs:r,msgType:o,type:i}=e;let s,a;Object.defineProperties(this,{id:{get:()=>t,enumerable:!0},docChanges:{get:()=>(s||(s=JSON.parse(JSON.stringify(n))),s),enumerable:!0},docs:{get:()=>(a||(a=JSON.parse(JSON.stringify(r))),a),enumerable:!0},msgType:{get:()=>o,enumerable:!0},type:{get:()=>i,enumerable:!0}})}}class Te extends Error{constructor(e){super(`Watch Error ${JSON.stringify(e.msgData)} (requestid: ${e.requestId})`),this.isRealtimeErrorMessageError=!0,this.payload=e}}const Ae=e=>e&&e.isRealtimeErrorMessageError;var Ne;!function(e){e.LOGGINGIN="LOGGINGIN",e.INITING="INITING",e.REBUILDING="REBUILDING",e.ACTIVE="ACTIVE",e.ERRORED="ERRORED",e.CLOSING="CLOSING",e.CLOSED="CLOSED",e.PAUSED="PAUSED",e.RESUMING="RESUMING"}(Ne||(Ne={}));const Ie=100,Be=2,Re=2,De=1e4,xe=1e4,Pe=1e4;class Ce{constructor(e){this.watchStatus=Ne.INITING,this._login=async(e,t)=>{this.watchStatus=Ne.LOGGINGIN;const n=await this.login(e,t);return this.envId||(this.envId=n.envId),n},this.initWatch=async e=>{if(this._initWatchPromise)return this._initWatchPromise;this._initWatchPromise=new Promise(async(t,n)=>{try{if(this.watchStatus===Ne.PAUSED)return console.log("[realtime] initWatch cancelled on pause"),t();const{envId:r}=await this._login(this.envId,e);if(this.watchStatus===Ne.PAUSED)return console.log("[realtime] initWatch cancelled on pause"),t();this.watchStatus=Ne.INITING;const o={watchId:this.watchId,requestId:ge(),msgType:"INIT_WATCH",msgData:{envId:r,collName:this.collectionName,query:this.query}},i=await this.send({msg:o,waitResponse:!0,skipOnMessage:!0,timeout:xe}),{events:s,currEvent:a}=i.msgData;if(this.sessionInfo={queryID:i.msgData.queryID,currentEventId:a-1,currentDocs:[]},s.length>0){for(const e of s)e.ID=a;this.handleServerEvents(i)}else{this.sessionInfo.currentEventId=a;const e=new Oe({id:a,docChanges:[],docs:[],type:"init"});this.listener.onChange(e),this.scheduleSendACK()}this.onWatchStart(this,this.sessionInfo.queryID),this.watchStatus=Ne.ACTIVE,this._availableRetries.INIT_WATCH=Be,t()}catch(e){this.handleWatchEstablishmentError(e,{operationName:"INIT_WATCH",resolve:t,reject:n})}});let t=!1;try{await this._initWatchPromise,t=!0}finally{this._initWatchPromise=void 0}console.log(`[realtime] initWatch ${t?"success":"fail"}`)},this.rebuildWatch=async e=>{if(this._rebuildWatchPromise)return this._rebuildWatchPromise;this._rebuildWatchPromise=new Promise(async(t,n)=>{try{if(this.watchStatus===Ne.PAUSED)return console.log("[realtime] rebuildWatch cancelled on pause"),t();const{envId:r}=await this._login(this.envId,e);if(!this.sessionInfo)throw new Error("can not rebuildWatch without a successful initWatch (lack of sessionInfo)");if(this.watchStatus===Ne.PAUSED)return console.log("[realtime] rebuildWatch cancelled on pause"),t();this.watchStatus=Ne.REBUILDING;const o={watchId:this.watchId,requestId:ge(),msgType:"REBUILD_WATCH",msgData:{envId:r,collName:this.collectionName,queryID:this.sessionInfo.queryID,eventID:this.sessionInfo.currentEventId}},i=await this.send({msg:o,waitResponse:!0,skipOnMessage:!1,timeout:Pe});this.handleServerEvents(i),this.watchStatus=Ne.ACTIVE,this._availableRetries.REBUILD_WATCH=Be,t()}catch(e){this.handleWatchEstablishmentError(e,{operationName:"REBUILD_WATCH",resolve:t,reject:n})}});let t=!1;try{await this._rebuildWatchPromise,t=!0}finally{this._rebuildWatchPromise=void 0}console.log(`[realtime] rebuildWatch ${t?"success":"fail"}`)},this.handleWatchEstablishmentError=async(e,t)=>{const n="INIT_WATCH"===t.operationName,r=()=>{this.closeWithError(new ye({errCode:n?_e.SDK_DATABASE_REALTIME_LISTENER_INIT_WATCH_FAIL:_e.SDK_DATABASE_REALTIME_LISTENER_REBUILD_WATCH_FAIL,errMsg:e})),t.reject(e)},o=e=>{this.useRetryTicket(t.operationName)?n?(this._initWatchPromise=void 0,t.resolve(this.initWatch(e))):(this._rebuildWatchPromise=void 0,t.resolve(this.rebuildWatch(e))):r()};this.handleCommonError(e,{onSignError:()=>o(!0),onTimeoutError:()=>o(!1),onNotRetryableError:r,onCancelledError:t.reject,onUnknownError:async()=>{try{const e=async()=>{this.pause(),await this.onceWSConnected(),o(!0)};this.isWSConnected()?(await Ee(Ie),this.watchStatus===Ne.PAUSED?t.reject(new ve(`${t.operationName} cancelled due to pause after unknownError`)):this.isWSConnected()?o(!1):await e()):await e()}catch(e){o(!0)}}})},this.closeWatch=async()=>{const e=this.sessionInfo?this.sessionInfo.queryID:"";if(this.watchStatus!==Ne.ACTIVE)return this.watchStatus=Ne.CLOSED,void this.onWatchClose(this,e);try{this.watchStatus=Ne.CLOSING;const t={watchId:this.watchId,requestId:ge(),msgType:"CLOSE_WATCH",msgData:null};await this.send({msg:t}),this.sessionInfo=void 0,this.watchStatus=Ne.CLOSED}catch(e){this.closeWithError(new ye({errCode:_e.SDK_DATABASE_REALTIME_LISTENER_CLOSE_WATCH_FAIL,errMsg:e}))}finally{this.onWatchClose(this,e)}},this.scheduleSendACK=()=>{this.clearACKSchedule(),this._ackTimeoutId=setTimeout(()=>{this._waitExpectedTimeoutId?this.scheduleSendACK():this.sendACK()},De)},this.clearACKSchedule=()=>{this._ackTimeoutId&&clearTimeout(this._ackTimeoutId)},this.sendACK=async()=>{try{if(this.watchStatus!==Ne.ACTIVE)return void this.scheduleSendACK();if(!this.sessionInfo)return void console.warn("[realtime listener] can not send ack without a successful initWatch (lack of sessionInfo)");const e={watchId:this.watchId,requestId:ge(),msgType:"CHECK_LAST",msgData:{queryID:this.sessionInfo.queryID,eventID:this.sessionInfo.currentEventId}};await this.send({msg:e}),this.scheduleSendACK()}catch(e){if(Ae(e)){const t=e.payload;switch(t.msgData.code){case"CHECK_LOGIN_FAILED":case"SIGN_EXPIRED_ERROR":case"SIGN_INVALID_ERROR":case"SIGN_PARAM_INVALID":return void this.rebuildWatch();case"QUERYID_INVALID_ERROR":case"SYS_ERR":case"INVALIID_ENV":case"COLLECTION_PERMISSION_DENIED":return void this.closeWithError(new ye({errCode:_e.SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL,errMsg:t.msgData.code}))}}this._availableRetries.CHECK_LAST&&this._availableRetries.CHECK_LAST>0?(this._availableRetries.CHECK_LAST--,this.scheduleSendACK()):this.closeWithError(new ye({errCode:_e.SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL,errMsg:e}))}},this.handleCommonError=(e,t)=>{if(Ae(e)){switch(e.payload.msgData.code){case"CHECK_LOGIN_FAILED":case"SIGN_EXPIRED_ERROR":case"SIGN_INVALID_ERROR":case"SIGN_PARAM_INVALID":return void t.onSignError(e);case"QUERYID_INVALID_ERROR":case"SYS_ERR":case"INVALIID_ENV":case"COLLECTION_PERMISSION_DENIED":default:return void t.onNotRetryableError(e)}}else{if(be(e))return void t.onTimeoutError(e);if(we(e))return void t.onCancelledError(e)}t.onUnknownError(e)},this.watchId=`watchid_${+new Date}_${Math.random()}`,this.envId=e.envId,this.collectionName=e.collectionName,this.query=e.query,this.send=e.send,this.login=e.login,this.isWSConnected=e.isWSConnected,this.onceWSConnected=e.onceWSConnected,this.getWaitExpectedTimeoutLength=e.getWaitExpectedTimeoutLength,this.onWatchStart=e.onWatchStart,this.onWatchClose=e.onWatchClose,this.debug=e.debug,this._availableRetries={INIT_WATCH:Be,REBUILD_WATCH:Be,CHECK_LAST:Re},this.listener=new Se({close:this.closeWatch,onChange:e.onChange,onError:e.onError,debug:this.debug,virtualClient:this}),this.initWatch()}useRetryTicket(e){return!!(this._availableRetries[e]&&this._availableRetries[e]>0)&&(this._availableRetries[e]--,console.log(`[realtime] ${e} use a retry ticket, now only ${this._availableRetries[e]} retry left`),!0)}async handleServerEvents(e){try{this.scheduleSendACK(),await this._handleServerEvents(e),this._postHandleServerEventsValidityCheck(e)}catch(e){throw console.error("[realtime listener] internal non-fatal error: handle server events failed with error: ",e),e}}async _handleServerEvents(e){const{requestId:t}=e,{events:n}=e.msgData,{msgType:r}=e;if(!n.length||!this.sessionInfo)return;const o=this.sessionInfo;let i;try{i=n.map(je)}catch(e){return void this.closeWithError(new ye({errCode:_e.SDK_DATABASE_REALTIME_LISTENER_RECEIVE_INVALID_SERVER_DATA,errMsg:e}))}let s=[...o.currentDocs],a=!1;for(let n=0,c=i.length;n<c;n++){const u=i[n];if(o.currentEventId>=u.id)!i[n-1]||u.id>i[n-1].id?console.warn(`[realtime] duplicate event received, cur ${o.currentEventId} but got ${u.id}`):console.error(`[realtime listener] server non-fatal error: events out of order (the latter event's id is smaller than that of the former) (requestId ${t})`);else{if(o.currentEventId!==u.id-1)return console.warn(`[realtime listener] event received is out of order, cur ${this.sessionInfo.currentEventId} but got ${u.id}`),void await this.rebuildWatch();switch(u.dataType){case"update":if(!u.doc)switch(u.queueType){case"update":case"dequeue":{const e=s.find(e=>e._id===u.docId);if(e){const t=pe()(e);if(u.updatedFields)for(const e in u.updatedFields)fe()(t,e,u.updatedFields[e]);if(u.removedFields)for(const e of u.removedFields)he()(t,e);u.doc=t}else console.error("[realtime listener] internal non-fatal server error: unexpected update dataType event where no doc is associated.");break}case"enqueue":{const t=new ye({errCode:_e.SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR,errMsg:`HandleServerEvents: full doc is not provided with dataType="update" and queueType="enqueue" (requestId ${e.requestId})`});throw this.closeWithError(t),t}}break;case"replace":if(!u.doc){const t=new ye({errCode:_e.SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR,errMsg:`HandleServerEvents: full doc is not provided with dataType="replace" (requestId ${e.requestId})`});throw this.closeWithError(t),t}break;case"remove":{const e=s.find(e=>e._id===u.docId);e?u.doc=e:console.error("[realtime listener] internal non-fatal server error: unexpected remove event where no doc is associated.");break}}switch(u.queueType){case"init":a?s.push(u.doc):(a=!0,s=[u.doc]);break;case"enqueue":s.push(u.doc);break;case"dequeue":{const e=s.findIndex(e=>e._id===u.docId);e>-1?s.splice(e,1):console.error("[realtime listener] internal non-fatal server error: unexpected dequeue event where no doc is associated.");break}case"update":{const e=s.findIndex(e=>e._id===u.docId);e>-1?s[e]=u.doc:console.error("[realtime listener] internal non-fatal server error: unexpected queueType update event where no doc is associated.");break}}if(n===c-1||i[n+1]&&i[n+1].id!==u.id){const e=[...s],t=i.slice(0,n+1).filter(e=>e.id===u.id);this.sessionInfo.currentEventId=u.id,this.sessionInfo.currentDocs=s;const o=new Oe({id:u.id,docChanges:t,docs:e,msgType:r});this.listener.onChange(o)}}}}_postHandleServerEventsValidityCheck(e){this.sessionInfo?(this.sessionInfo.expectEventId&&this.sessionInfo.currentEventId>=this.sessionInfo.expectEventId&&this.clearWaitExpectedEvent(),this.sessionInfo.currentEventId<e.msgData.currEvent&&console.warn("[realtime listener] internal non-fatal error: client eventId does not match with server event id after server event handling")):console.error("[realtime listener] internal non-fatal error: sessionInfo lost after server event handling, this should never occur")}clearWaitExpectedEvent(){this._waitExpectedTimeoutId&&(clearTimeout(this._waitExpectedTimeoutId),this._waitExpectedTimeoutId=void 0)}onMessage(e){switch(this.watchStatus){case Ne.PAUSED:if("ERROR"!==e.msgType)return;break;case Ne.LOGGINGIN:case Ne.INITING:case Ne.REBUILDING:return void console.warn(`[realtime listener] internal non-fatal error: unexpected message received while ${this.watchStatus}`);case Ne.CLOSED:return void console.warn("[realtime listener] internal non-fatal error: unexpected message received when the watch has closed");case Ne.ERRORED:return void console.warn("[realtime listener] internal non-fatal error: unexpected message received when the watch has ended with error")}if(this.sessionInfo)switch(this.scheduleSendACK(),e.msgType){case"NEXT_EVENT":console.warn(`nextevent ${e.msgData.currEvent} ignored`,e),this.handleServerEvents(e);break;case"CHECK_EVENT":this.sessionInfo.currentEventId<e.msgData.currEvent&&(this.sessionInfo.expectEventId=e.msgData.currEvent,this.clearWaitExpectedEvent(),this._waitExpectedTimeoutId=setTimeout(()=>{this.rebuildWatch()},this.getWaitExpectedTimeoutLength()),console.log(`[realtime] waitExpectedTimeoutLength ${this.getWaitExpectedTimeoutLength()}`));break;case"ERROR":this.closeWithError(new ye({errCode:_e.SDK_DATABASE_REALTIME_LISTENER_SERVER_ERROR_MSG,errMsg:`${e.msgData.code} - ${e.msgData.message}`}));break;default:console.warn(`[realtime listener] virtual client receive unexpected msg ${e.msgType}: `,e)}else console.warn("[realtime listener] internal non-fatal error: sessionInfo not found while message is received.")}closeWithError(e){this.watchStatus=Ne.ERRORED,this.clearACKSchedule(),this.listener.onError(e),this.onWatchClose(this,this.sessionInfo&&this.sessionInfo.queryID||""),console.log(`[realtime] client closed (${this.collectionName} ${this.query}) (watchId ${this.watchId})`)}pause(){this.watchStatus=Ne.PAUSED,console.log(`[realtime] client paused (${this.collectionName} ${this.query}) (watchId ${this.watchId})`)}async resume(){this.watchStatus=Ne.RESUMING,console.log(`[realtime] client resuming with ${this.sessionInfo?"REBUILD_WATCH":"INIT_WATCH"} (${this.collectionName} ${this.query}) (${this.watchId})`);try{await(this.sessionInfo?this.rebuildWatch():this.initWatch()),console.log(`[realtime] client successfully resumed (${this.collectionName} ${this.query}) (${this.watchId})`)}catch(e){console.error(`[realtime] client resume failed (${this.collectionName} ${this.query}) (${this.watchId})`,e)}}}function je(e){const t={id:e.ID,dataType:e.DataType,queueType:e.QueueType,docId:e.DocID,doc:e.Doc&&"{}"!==e.Doc?JSON.parse(e.Doc):void 0};return"update"===e.DataType&&(e.UpdatedFields&&(t.updatedFields=JSON.parse(e.UpdatedFields)),(e.removedFields||e.RemovedFields)&&(t.removedFields=JSON.parse(e.removedFields))),t}const Le={1e3:{code:1e3,name:"Normal Closure",description:"Normal closure; the connection successfully completed whatever purpose for which it was created."},1001:{code:1001,name:"Going Away",description:"The endpoint is going away, either because of a server failure or because the browser is navigating away from the page that opened the connection."},1002:{code:1002,name:"Protocol Error",description:"The endpoint is terminating the connection due to a protocol error."},1003:{code:1003,name:"Unsupported Data",description:"The connection is being terminated because the endpoint received data of a type it cannot accept (for example, a text-only endpoint received binary data)."},1005:{code:1005,name:"No Status Received",description:"Indicates that no status code was provided even though one was expected."},1006:{code:1006,name:"Abnormal Closure",description:"Used to indicate that a connection was closed abnormally (that is, with no close frame being sent) when a status code is expected."},1007:{code:1007,name:"Invalid frame payload data",description:"The endpoint is terminating the connection because a message was received that contained inconsistent data (e.g., non-UTF-8 data within a text message)."},1008:{code:1008,name:"Policy Violation",description:"The endpoint is terminating the connection because it received a message that violates its policy. This is a generic status code, used when codes 1003 and 1009 are not suitable."},1009:{code:1009,name:"Message too big",description:"The endpoint is terminating the connection because a data frame was received that is too large."},1010:{code:1010,name:"Missing Extension",description:"The client is terminating the connection because it expected the server to negotiate one or more extension, but the server didn't."},1011:{code:1011,name:"Internal Error",description:"The server is terminating the connection because it encountered an unexpected condition that prevented it from fulfilling the request."},1012:{code:1012,name:"Service Restart",description:"The server is terminating the connection because it is restarting."},1013:{code:1013,name:"Try Again Later",description:"The server is terminating the connection due to a temporary condition, e.g. it is overloaded and is casting off some of its clients."},1014:{code:1014,name:"Bad Gateway",description:"The server was acting as a gateway or proxy and received an invalid response from the upstream server. This is similar to 502 HTTP Status Code."},1015:{code:1015,name:"TLS Handshake",description:"Indicates that the connection was closed due to a failure to perform a TLS handshake (e.g., the server certificate can't be verified)."},3e3:{code:3e3,name:"Reconnect WebSocket",description:"The client is terminating the connection because it wants to reconnect"},3001:{code:3001,name:"No Realtime Listeners",description:"The client is terminating the connection because no more realtime listeners exist"},3002:{code:3002,name:"Heartbeat Ping Error",description:"The client is terminating the connection due to its failure in sending heartbeat messages"},3003:{code:3003,name:"Heartbeat Pong Timeout Error",description:"The client is terminating the connection because no heartbeat response is received from the server"},3050:{code:3050,name:"Server Close",description:"The client is terminating the connection because no heartbeat response is received from the server"}};var ke;!function(e){e[e.NormalClosure=1e3]="NormalClosure",e[e.GoingAway=1001]="GoingAway",e[e.ProtocolError=1002]="ProtocolError",e[e.UnsupportedData=1003]="UnsupportedData",e[e.NoStatusReceived=1005]="NoStatusReceived",e[e.AbnormalClosure=1006]="AbnormalClosure",e[e.InvalidFramePayloadData=1007]="InvalidFramePayloadData",e[e.PolicyViolation=1008]="PolicyViolation",e[e.MessageTooBig=1009]="MessageTooBig",e[e.MissingExtension=1010]="MissingExtension",e[e.InternalError=1011]="InternalError",e[e.ServiceRestart=1012]="ServiceRestart",e[e.TryAgainLater=1013]="TryAgainLater",e[e.BadGateway=1014]="BadGateway",e[e.TLSHandshake=1015]="TLSHandshake",e[e.ReconnectWebSocket=3e3]="ReconnectWebSocket",e[e.NoRealtimeListeners=3001]="NoRealtimeListeners",e[e.HeartbeatPingError=3002]="HeartbeatPingError",e[e.HeartbeatPongTimeoutError=3003]="HeartbeatPongTimeoutError",e[e.NoAuthentication=3050]="NoAuthentication"}(ke||(ke={}));const $e=(e,t)=>{const n=Le[e],r=n?`${n.name}, code ${e}, reason ${t||n.description}`:`code ${e}`;return new ye({errCode:_e.SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_CLOSED,errMsg:r})},Me={CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3},Ue=3,Fe=5e3,ze=1e4,qe=5,We=1e4,Ye=2,Ge=2,Ke=5e3;class He{constructor(e){this._virtualWSClient=new Set,this._queryIdClientMap=new Map,this._watchIdClientMap=new Map,this._pingFailed=0,this._pongMissed=0,this._logins=new Map,this._wsReadySubsribers=[],this._wsResponseWait=new Map,this._rttObserved=[],this.initWebSocketConnection=async(e,t=this._maxReconnect)=>{if(e&&this._reconnectState)return;if(e&&(this._reconnectState=!0),this._wsInitPromise)return this._wsInitPromise;console.log(`[realtime] initWebSocketConnection reconnect ${e} availableRetries ${t}`),e&&this.pauseClients(),this.close(ke.ReconnectWebSocket),this._wsInitPromise=new Promise(async(n,r)=>{try{console.log("[realtime] initWebSocketConnection start throwErrorIfNetworkOffline"),console.log("[realtime] initWebSocketConnection start getSignature"),await this.getAccessToken(),console.log("[realtime] initWebSocketConnection getSignature success"),console.log("[realtime] initWebSocketConnection start connectSocket"),await new Promise(e=>{this._ws=new WebSocket("wss://tcb-ws.tencentcloudapi.com"),e()}),console.log("[realtime] initWebSocketConnection connectSocket successfully fired"),await this.initWebSocketEvent(),n(),e&&(this.resumeClients(),this._reconnectState=!1)}catch(o){if(console.error("[realtime] initWebSocketConnection connect fail",o),t>0){const r=!0;console.log("[realtime] initWebSocketConnection waiting for network online"),console.log("[realtime] initWebSocketConnection network online"),this._wsInitPromise=void 0,r&&(console.log(`[realtime] initWebSocketConnection sleep ${this._reconnectInterval}ms`),await Ee(this._reconnectInterval),e&&(this._reconnectState=!1)),n(this.initWebSocketConnection(e,t-1))}else r(o),e&&this.closeAllClients(new ye({errCode:_e.SDK_DATABASE_REALTIME_LISTENER_RECONNECT_WATCH_FAIL,errMsg:o}))}});let n=!1;try{await this._wsInitPromise,n=!0,this._wsReadySubsribers.forEach(({resolve:e})=>e())}catch(e){this._wsReadySubsribers.forEach(({reject:e})=>e())}finally{this._wsInitPromise=void 0,this._wsReadySubsribers=[]}console.log(`[realtime] initWebSocketConnection ${n?"success":"fail"}`)},this.initWebSocketEvent=()=>new Promise((e,t)=>{if(!this._ws)throw new Error("can not initWebSocketEvent, ws not exists");let n=!1;this._ws.onopen=t=>{console.warn("[realtime] ws event: open",t),n=!0,e()},this._ws.onerror=e=>{this._logins=new Map,n?(console.error("[realtime] ws event: error",e),this.clearHeartbeat(),this._virtualWSClient.forEach(t=>t.closeWithError(new ye({errCode:_e.SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_ERROR,errMsg:e})))):(console.error("[realtime] ws open failed with ws event: error",e),t(e))},this._ws.onclose=e=>{switch(console.warn("[realtime] ws event: close",e),this._logins=new Map,this.clearHeartbeat(),e.code){case ke.ReconnectWebSocket:case ke.NoRealtimeListeners:break;case ke.HeartbeatPingError:case ke.HeartbeatPongTimeoutError:case ke.NormalClosure:case ke.AbnormalClosure:this._maxReconnect>0?this.initWebSocketConnection(!0,this._maxReconnect):this.closeAllClients($e(e.code));break;case ke.NoAuthentication:this.closeAllClients($e(e.code,e.reason));break;default:this._maxReconnect>0?this.initWebSocketConnection(!0,this._maxReconnect):this.closeAllClients($e(e.code))}},this._ws.onmessage=e=>{const t=e.data;let n;this.heartbeat();try{n=JSON.parse(t)}catch(e){throw new Error(`[realtime] onMessage parse res.data error: ${e}`)}if(console.log(`[realtime] onMessage ${n.msgType} (${(new Date).toLocaleString()})`,n),"ERROR"===n.msgType){let e=null;this._virtualWSClient.forEach(t=>{t.watchId===n.watchId&&(e=t)}),e&&e.listener.onError(n)}const r=this._wsResponseWait.get(n.requestId);if(r){try{"ERROR"===n.msgType?r.reject(new Te(n)):r.resolve(n)}catch(e){console.error("ws onMessage responseWaitSpec.resolve(msg) errored:",e)}finally{this._wsResponseWait.delete(n.requestId)}if(r.skipOnMessage)return}if("PONG"===n.msgType){if(this._lastPingSendTS){const e=Date.now()-this._lastPingSendTS;if(e>ze)return void console.warn(`[realtime] untrusted rtt observed: ${e}`);this._rttObserved.length>=Ue&&this._rttObserved.splice(0,this._rttObserved.length-Ue+1),this._rttObserved.push(e)}return}let o=n.watchId&&this._watchIdClientMap.get(n.watchId);if(o)o.onMessage(n);else switch(console.error(`[realtime] no realtime listener found responsible for watchId ${n.watchId}: `,n),n.msgType){case"INIT_EVENT":case"NEXT_EVENT":case"CHECK_EVENT":(o=this._queryIdClientMap.get(n.msgData.queryID))&&o.onMessage(n);break;default:for(const[e,t]of this._watchIdClientMap){console.log("watchid*****",e),t.onMessage(n);break}}},this.heartbeat()}),this.isWSConnected=()=>Boolean(this._ws&&this._ws.readyState===Me.OPEN),this.onceWSConnected=async()=>{if(!this.isWSConnected())return this._wsInitPromise?this._wsInitPromise:new Promise((e,t)=>{this._wsReadySubsribers.push({resolve:e,reject:t})})},this.webLogin=async(e,t)=>{if(!t)if(e){const t=this._logins.get(e);if(t){if(t.loggedIn&&t.loginResult)return console.log("[realtime] login: already logged in"),t.loginResult;if(t.loggingInPromise)return t.loggingInPromise}}else{const e=this._logins.get("");if(e&&e.loggingInPromise)return e.loggingInPromise}console.log("[realtime] login: logging in");const n=new Promise(async(e,t)=>{try{const n=await this.getAccessToken(),r={watchId:void 0,requestId:ge(),msgType:"LOGIN",msgData:{envId:n.env||"",accessToken:n.accessToken,referrer:"web",sdkVersion:"",dataVersion:""}},o=await this.send({msg:r,waitResponse:!0,skipOnMessage:!0,timeout:Ke});o.msgData.code?t(new Error(`${o.msgData.code} ${o.msgData.message}`)):e({envId:n.env})}catch(e){t(e)}});let r=e&&this._logins.get(e);const o=Date.now();r?(r.loggedIn=!1,r.loggingInPromise=n,r.loginStartTS=o):(r={loggedIn:!1,loggingInPromise:n,loginStartTS:o},this._logins.set(e||"",r));try{const t=await n,i=e&&this._logins.get(e);if(i&&i===r&&i.loginStartTS===o)return r.loggedIn=!0,r.loggingInPromise=void 0,r.loginStartTS=void 0,r.loginResult=t,t;if(i){if(i.loggedIn&&i.loginResult)return i.loginResult;if(i.loggingInPromise)return i.loggingInPromise;throw new Error("ws unexpected login info")}throw new Error("ws login info reset")}catch(e){throw r.loggedIn=!1,r.loggingInPromise=void 0,r.loginStartTS=void 0,r.loginResult=void 0,e}},this.getAccessToken=async()=>this._context.appConfig.getAccessToken(),this.getWaitExpectedTimeoutLength=()=>this._rttObserved.length?this._rttObserved.reduce((e,t)=>e+t)/this._rttObserved.length*1.5:Fe,this.ping=async()=>{const e={watchId:void 0,requestId:ge(),msgType:"PING",msgData:null};await this.send({msg:e}),console.log("ping sent")},this.send=e=>new Promise(async(t,n)=>{let r,o=!1,i=!1;const s=e=>{o=!0,r&&clearTimeout(r),t(e)},a=e=>{i=!0,r&&clearTimeout(r),n(e)};e.timeout&&(r=setTimeout(async()=>{o&&i||(await Ee(0),o&&i||a(new me("wsclient.send timedout")))},e.timeout));try{if(console.log(`[realtime] ws send ${e.msg.msgType} (${(new Date).toLocaleString()}): `,e),this._wsInitPromise&&await this._wsInitPromise,!this._ws)return void a(new Error("invalid state: ws connection not exists, can not send message"));if(this._ws.readyState!==Me.OPEN)return void a(new Error(`ws readyState invalid: ${this._ws.readyState}, can not send message`));e.waitResponse&&this._wsResponseWait.set(e.msg.requestId,{resolve:s,reject:a,skipOnMessage:e.skipOnMessage}),console.log("send msg:",e.msg);try{this._ws.send(JSON.stringify(e.msg)),e.waitResponse||s()}catch(t){t&&(a(t),e.waitResponse&&this._wsResponseWait.delete(e.msg.requestId))}}catch(e){a(e)}}),this.closeAllClients=e=>{this._virtualWSClient.forEach(t=>{t.closeWithError(e)})},this.pauseClients=e=>{(e||this._virtualWSClient).forEach(e=>{e.pause()})},this.resumeClients=e=>{(e||this._virtualWSClient).forEach(e=>{e.resume()})},this.onWatchStart=(e,t)=>{this._queryIdClientMap.set(t,e)},this.onWatchClose=(e,t)=>{t&&this._queryIdClientMap.delete(t),this._watchIdClientMap.delete(e.watchId),this._virtualWSClient.delete(e),this._virtualWSClient.size||this.close(ke.NoRealtimeListeners)},this._maxReconnect=e.maxReconnect||qe,this._reconnectInterval=e.reconnectInterval||We,this._context=e.context}heartbeat(e){this.clearHeartbeat(),this._pingTimeoutId=setTimeout(async()=>{try{if(!this._ws||this._ws.readyState!==Me.OPEN)return;this._lastPingSendTS=Date.now(),await this.ping(),this._pingFailed=0,this._pongTimeoutId=setTimeout(()=>{console.error("pong timed out"),this._pongMissed<Ge?(this._pongMissed++,this.heartbeat(!0)):this.initWebSocketConnection(!0)},this._context.appConfig.realtimePongWaitTimeout)}catch(e){this._pingFailed<Ye?(this._pingFailed++,this.heartbeat()):this.close(ke.HeartbeatPingError)}},e?0:this._context.appConfig.realtimePingInterval)}clearHeartbeat(){this._pingTimeoutId&&clearTimeout(this._pingTimeoutId),this._pongTimeoutId&&clearTimeout(this._pongTimeoutId)}close(e){this.clearHeartbeat(),this._ws&&(this._ws.close(e,Le[e].name),this._ws=void 0)}watch(e){this._ws||this._wsInitPromise||this.initWebSocketConnection(!1);const t=new Ce(Object.assign(Object.assign({},e),{send:this.send,login:this.webLogin,isWSConnected:this.isWSConnected,onceWSConnected:this.onceWSConnected,getWaitExpectedTimeoutLength:this.getWaitExpectedTimeoutLength,onWatchStart:this.onWatchStart,onWatchClose:this.onWatchClose,debug:!0}));return this._virtualWSClient.add(t),this._watchIdClientMap.set(t.watchId,t),t.listener}}class Je{constructor(e,t,n,r={}){this.watch=e=>(gt.ws||(gt.ws=new He({context:{appConfig:{docSizeLimit:1e3,realtimePingInterval:1e4,realtimePongWaitTimeout:5e3,getAccessToken:this._getAccessToken}}})),gt.ws.watch(Object.assign(Object.assign({},e),{envId:this._db.config.env,collectionName:this._coll,query:JSON.stringify({_id:this.id})}))),this._db=e,this._coll=t,this.id=n,this.request=new gt.reqClass(this._db.config),this.projection=r,this._getAccessToken=gt.getAccessToken}create(e,t){t=t||q();let n={collectionName:this._coll,data:ne(e)};return this.id&&(n._id=this.id),this.request.send("database.addDocument",n).then(e=>{e.code?t(0,e):t(0,{id:e.data._id,requestId:e.requestId})}).catch(e=>{t(e)}),t.promise}set(e,t){if(t=t||q(),!this.id)return Promise.resolve({code:"INVALID_PARAM",message:"docId不能为空"});if(!e||"object"!=typeof e)return Promise.resolve({code:"INVALID_PARAM",message:"参数必需是非空对象"});if(e.hasOwnProperty("_id"))return Promise.resolve({code:"INVALID_PARAM",message:"不能更新_id的值"});let n=!1;const r=e=>{if("object"==typeof e)for(let t in e)e[t]instanceof Y?n=!0:"object"==typeof e[t]&&r(e[t])};if(r(e),n)return Promise.resolve({code:"DATABASE_REQUEST_FAILED",message:"update operator complicit"});let o={collectionName:this._coll,data:ne(e),multi:!1,merge:!1,upsert:!0};return this.id&&(o.query={_id:this.id}),this.request.send("database.updateDocument",o).then(e=>{e.code?t(0,e):t(0,{updated:e.data.updated,upsertedId:e.data.upserted_id,requestId:e.requestId})}).catch(e=>{t(e)}),t.promise}update(e,t){if(t=t||q(),!e||"object"!=typeof e)return Promise.resolve({code:"INVALID_PARAM",message:"参数必需是非空对象"});if(e.hasOwnProperty("_id"))return Promise.resolve({code:"INVALID_PARAM",message:"不能更新_id的值"});const n={_id:this.id},r={collectionName:this._coll,data:ce.encode(e),query:n,multi:!1,merge:!0,upsert:!1};return this.request.send("database.updateDocument",r).then(e=>{e.code?t(0,e):t(0,{updated:e.data.updated,upsertedId:e.data.upserted_id,requestId:e.requestId})}).catch(e=>{t(e)}),t.promise}remove(e){e=e||q();const t={_id:this.id},n={collectionName:this._coll,query:t,multi:!1};return this.request.send("database.deleteDocument",n).then(t=>{t.code?e(0,t):e(0,{deleted:t.data.deleted,requestId:t.requestId})}).catch(t=>{e(t)}),e.promise}get(e){e=e||q();const t={_id:this.id},n={collectionName:this._coll,query:t,multi:!1,projection:this.projection};return this.request.send("database.queryDocument",n).then(t=>{if(t.code)e(0,t);else{const n=U.formatResDocumentData(t.data.list);e(0,{data:n,requestId:t.requestId,total:t.TotalCount,limit:t.Limit,offset:t.Offset})}}).catch(t=>{e(t)}),e.promise}field(e){for(let t in e)e[t]?e[t]=1:e[t]=0;return new Je(this._db,this._coll,this.id,e)}}class Ve{constructor(){}static encode(e){return(new Xe).encodeQuery(e)}}class Xe{encodeQuery(e,t){return se(e)?J(e)?this.encodeLogicCommand(e):Q(e)?this.encodeQueryCommand(e):{[t]:this.encodeQueryObject(e)}:N(e)?this.encodeQueryObject(e):e}encodeLogicCommand(e){switch(e.operator){case K.AND:case K.OR:return{[te(e.operator)]:e.operands.map(t=>this.encodeQuery(t,e.fieldName))};default:{const t=te(e.operator);if(1===e.operands.length){return{[t]:this.encodeQuery(e.operands[0])}}return{[t]:e.operands.map(this.encodeQuery.bind(this))}}}}encodeQueryCommand(e){return Z(e),this.encodeComparisonCommand(e)}encodeComparisonCommand(e){if(e.fieldName===p)throw new Error("Cannot encode a comparison command with unset field name");const t=te(e.operator);switch(e.operator){case V.EQ:case V.NEQ:case V.LT:case V.LTE:case V.GT:case V.GTE:return{[e.fieldName]:{[t]:ae(e.operands[0])}};case V.IN:case V.NIN:return{[e.fieldName]:{[t]:ae(e.operands)}};case V.GEO_NEAR:{const t=e.operands[0];return{[e.fieldName]:{$nearSphere:{$geometry:t.geometry.toJSON(),$maxDistance:t.maxDistance,$minDistance:t.minDistance}}}}case V.GEO_WITHIN:{const t=e.operands[0];return{[e.fieldName]:{$geoWithin:{$geometry:t.geometry.toJSON()}}}}case V.GEO_INTERSECTS:{const t=e.operands[0];return{[e.fieldName]:{$geoIntersects:{$geometry:t.geometry.toJSON()}}}}default:return{[e.fieldName]:{[t]:ae(e.operands[0])}}}}encodeQueryObject(e){const t=oe(e);for(const e in t){const n=t[e];if(J(n)){t[e]=n._setFieldName(e);const r=this.encodeLogicCommand(t[e]);this.mergeConditionAfterEncode(t,r,e)}else if(Z(n)){t[e]=n._setFieldName(e);const r=this.encodeComparisonCommand(t[e]);this.mergeConditionAfterEncode(t,r,e)}else se(n)&&(t[e]=ae(n))}return t}mergeConditionAfterEncode(e,t,n){t[n]||delete e[n];for(const r in t)e[r]?B(e[r])?e[r]=e[r].concat(t[r]):N(e[r])?N(t[r])?Object.assign(e,t):(console.warn(`unmergable condition, query is object but condition is ${A(t)}, can only overwrite`,t,n),e[r]=t[r]):(console.warn(`to-merge query is of type ${A(e)}, can only overwrite`,e,t,n),e[r]=t[r]):e[r]=t[r]}}class Qe{constructor(e,t,n,r,o){this.watch=e=>(gt.ws||(gt.ws=new He({context:{appConfig:{docSizeLimit:1e3,realtimePingInterval:1e4,realtimePongWaitTimeout:5e3,getAccessToken:this._getAccessToken}}})),gt.ws.watch(Object.assign(Object.assign({},e),{envId:this._db.config.env,collectionName:this._coll,query:JSON.stringify(this._fieldFilters)}))),this._db=e,this._coll=t,this._fieldFilters=n,this._fieldOrders=r||[],this._queryOptions=o||{},this._request=new gt.reqClass(this._db.config),this._getAccessToken=gt.getAccessToken}get(e){e=e||q();let t=[];this._fieldOrders&&this._fieldOrders.forEach(e=>{t.push(e)});let n={collectionName:this._coll};return this._fieldFilters&&(n.query=this._fieldFilters),t.length>0&&(n.order=t),this._queryOptions.offset&&(n.offset=this._queryOptions.offset),this._queryOptions.limit?n.limit=this._queryOptions.limit<100?this._queryOptions.limit:100:n.limit=100,this._queryOptions.projection&&(n.projection=this._queryOptions.projection),this._request.send("database.queryDocument",n).then(t=>{if(t.code)e(0,t);else{const n={data:U.formatResDocumentData(t.data.list),requestId:t.requestId};t.TotalCount&&(n.total=t.TotalCount),t.Limit&&(n.limit=t.Limit),t.Offset&&(n.offset=t.Offset),e(0,n)}}).catch(t=>{e(t)}),e.promise}count(e){e=e||q();let t={collectionName:this._coll};return this._fieldFilters&&(t.query=this._fieldFilters),this._request.send("database.countDocument",t).then(t=>{t.code?e(0,t):e(0,{requestId:t.requestId,total:t.data.total})}),e.promise}where(e){return new Qe(this._db,this._coll,Ve.encode(e),this._fieldOrders,this._queryOptions)}orderBy(e,t){F.isFieldPath(e),F.isFieldOrder(t);const n={field:e,direction:t},r=this._fieldOrders.concat(n);return new Qe(this._db,this._coll,this._fieldFilters,r,this._queryOptions)}limit(e){F.isInteger("limit",e);let t=Object.assign({},this._queryOptions);return t.limit=e,new Qe(this._db,this._coll,this._fieldFilters,this._fieldOrders,t)}skip(e){F.isInteger("offset",e);let t=Object.assign({},this._queryOptions);return t.offset=e,new Qe(this._db,this._coll,this._fieldFilters,this._fieldOrders,t)}update(e,t){if(t=t||q(),!e||"object"!=typeof e)return Promise.resolve({code:"INVALID_PARAM",message:"参数必需是非空对象"});if(e.hasOwnProperty("_id"))return Promise.resolve({code:"INVALID_PARAM",message:"不能更新_id的值"});let n={collectionName:this._coll,query:this._fieldFilters,multi:!0,merge:!0,upsert:!1,data:ce.encode(e)};return this._request.send("database.updateDocument",n).then(e=>{e.code?t(0,e):t(0,{requestId:e.requestId,updated:e.data.updated,upsertId:e.data.upsert_id})}),t.promise}field(e){for(let t in e)e[t]?e[t]=1:e[t]=0;let t=Object.assign({},this._queryOptions);return t.projection=e,new Qe(this._db,this._coll,this._fieldFilters,this._fieldOrders,t)}remove(e){e=e||q(),Object.keys(this._queryOptions).length>0&&console.warn("`offset`, `limit` and `projection` are not supported in remove() operation"),this._fieldOrders.length>0&&console.warn("`orderBy` is not supported in remove() operation");const t={collectionName:this._coll,query:Ve.encode(this._fieldFilters),multi:!0};return this._request.send("database.deleteDocument",t).then(t=>{t.code?e(0,t):e(0,{requestId:t.requestId,deleted:t.data.deleted})}),e.promise}}var Ze=n(10);class et{constructor(e,t){this._db=e,this._request=new gt.reqClass(this._db.config),this._stages=[],this._collectionName=t}async end(){const e=await this._request.send("database.aggregate",{collectionName:this._collectionName,stages:this._stages});return e&&e.data&&e.data.list?{requestId:e.requestId,data:JSON.parse(e.data.list).map(Ze.a.parse)}:e}unwrap(){return this._stages}}["addFields","bucket","bucketAuto","count","geoNear","group","limit","match","project","lookup","replaceRoot","sample","skip","sort","sortByCount","unwind"].forEach(e=>{et.prototype[e]=function(t){return this._stages.push({stageKey:`$${e}`,stageValue:JSON.stringify(t)}),this}});class tt extends Qe{constructor(e,t){super(e,t)}get name(){return this._coll}doc(e){return new Je(this._db,this._coll,e)}add(e,t){return this.doc().create(e,t)}aggregate(){return new et(this._db,this._coll)}}const nt={eq:e=>new X(V.EQ,[e]),neq:e=>new X(V.NEQ,[e]),lt:e=>new X(V.LT,[e]),lte:e=>new X(V.LTE,[e]),gt:e=>new X(V.GT,[e]),gte:e=>new X(V.GTE,[e]),in:e=>new X(V.IN,e),nin:e=>new X(V.NIN,e),geoNear:e=>new X(V.GEO_NEAR,[e]),geoWithin:e=>new X(V.GEO_WITHIN,[e]),geoIntersects:e=>new X(V.GEO_INTERSECTS,[e]),and(...e){const t=B(arguments[0])?arguments[0]:Array.from(arguments);return new H(K.AND,t)},or(...e){const t=B(arguments[0])?arguments[0]:Array.from(arguments);return new H(K.OR,t)},set:e=>new Y(W.SET,[e]),remove:()=>new Y(W.REMOVE,[]),inc:e=>new Y(W.INC,[e]),mul:e=>new Y(W.MUL,[e]),push(...e){const t=B(arguments[0])?arguments[0]:Array.from(arguments);return new Y(W.PUSH,t)},pop:()=>new Y(W.POP,[]),shift:()=>new Y(W.SHIFT,[]),unshift(...e){const t=B(arguments[0])?arguments[0]:Array.from(arguments);return new Y(W.UNSHIFT,t)},aggregate:{}};["abs","add","ceil","divide","exp","floor","ln","log","log10","mod","multiply","pow","sqrt","subtract","trunc","arrayElemAt","arrayToObject","concatArrays","filter","in","indexOfArray","isArray","map","objectToArray","range","reduce","reverseArray","size","slice","zip","and","not","or","cmp","eq","gt","gte","lt","lte","ne","cond","ifNull","switch","dayOfWeek","dateFromParts","dateFromString","dayOfMonth","dayOfWeek","dayOfYear","isoDayOfWeek","isoWeek","isoWeekYear","millisecond","minute","month","second","hour","week","year","literal","mergeObjects","objectToArray","allElementsTrue","anyElementTrue","setDifference","setEquals","setIntersection","setIsSubset","setUnion","concat","dateToString","indexOfBytes","indexOfCP","split","strLenBytes","strLenCP","strcasecmp","substr","substrBytes","substrCP","toLower","toUpper","meta","addToSet","avg","first","last","max","min","push","stdDevPop","stdDevSamp","sum","let"].forEach(e=>{let t=e;"ne"===e&&(t="neq"),nt.aggregate[t]=function(t){return{[`$${e}`]:t}}});class rt{constructor({regexp:e,options:t}){if(!e)throw new TypeError("regexp must be a string");this.$regex=e,this.$options=t}parse(){return{$regex:this.$regex,$options:this.$options}}get _internalType(){return T}}function ot(e){return new rt(e)}class it{constructor(e,t){this._data=e,this.requestId=t}data(){return this._data}}const st="database.startTransaction",at="database.commitTransaction",ct="database.abortTransaction",ut="database.getInTransaction",ft="database.updateDocInTransaction",lt="database.deleteDocInTransaction";class ht{constructor(e){this._db=e,this._request=new gt.reqClass(this._db.config)}async init(){const e=await this._request.send(st);if(e.code)throw e;this._id=e.transactionId}async get(e){const t={collectionName:e._coll,transactionId:this._id,_id:e.id},n=await this._request.send(ut,t);if(n.code)throw n;return new it(Ze.a.parse(n.data),n.requestId)}async set(e,t){const n={collectionName:e._coll,transactionId:this._id,_id:e.id,data:Ze.a.stringify(t,{relaxed:!1}),upsert:!0},r=await this._request.send(ft,n);if(r.code)throw r;return Object.assign(Object.assign({},r),{updated:Ze.a.parse(r.updated),upserted:r.upserted?JSON.parse(r.upserted):null})}async update(e,t){const n={collectionName:e._coll,transactionId:this._id,_id:e.id,data:Ze.a.stringify({$set:t},{relaxed:!1})},r=await this._request.send(ft,n);if(r.code)throw r;return Object.assign(Object.assign({},r),{updated:Ze.a.parse(r.updated)})}async delete(e){const t={collectionName:e._coll,transactionId:this._id,_id:e.id},n=await this._request.send(lt,t);if(n.code)throw n;return Object.assign(Object.assign({},n),{deleted:Ze.a.parse(n.deleted)})}async commit(){const e={transactionId:this._id},t=await this._request.send(at,e);if(t.code)throw t;return t}async rollback(){const e={transactionId:this._id},t=await this._request.send(ct,e);if(t.code)throw t;return t}}async function dt(){const e=new ht(this);return await e.init(),e}async function pt(e,t=3){if(!(t<=0))try{const n=new ht(this);await e(n),await n.commit()}catch(n){arguments.callee(e,--t)}}n.d(t,"a",function(){return gt});class gt{constructor(e){this.config=e,this.Geo=o,this.serverDate=M,this.command=nt,this.RegExp=ot,this.startTransaction=dt,this.runTransaction=pt}collection(e){if(!e)throw new Error("Collection name is required");return new tt(this,e)}createCollection(e){const t={collectionName:e};return new gt.reqClass(this.config).send("database.addCollection",t)}}},function(e,t,n){var r=n(22),o=n(108),i=n(109),s="[object Null]",a="[object Undefined]",c=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?a:s:c&&c in Object(e)?o(e):i(e)}},function(e,t,n){e.exports=n(83)},function(e,t,n){"use strict";n.d(t,"d",function(){return u}),n.d(t,"a",function(){return f}),n.d(t,"c",function(){return l}),n.d(t,"b",function(){return h});var r=n(46),o=n.n(r),i=n(20),s=n.n(i),a=n(7),c=n(5),u=function(e,t){t=t||Object(c.a)();var n=new a.a(this.config),r=e.cloudPath,o=e.filePath,i=e.onUploadProgress;return n.send("storage.getUploadMetadata",{path:r}).then(function(e){var n=e.data,a=n.url,c=n.authorization,u=n.token,f=n.fileId,l=n.cosFileId,h=e.requestId,d=new FormData;d.append("key",r),d.append("signature",c),d.append("x-cos-meta-fileid",l),d.append("success_action_status","201"),d.append("x-cos-security-token",u),d.append("file",o),s.a.post(a,d,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:i}).then(function(e){201===e.status?t(null,{fileID:f,requestId:h}):t(new Error("STORAGE_REQUEST_FAIL: ".concat(e.data)))}).catch(function(e){t(e)})}).catch(function(e){t(e)}),t.promise},f=function(e,t){var n=e.fileList;if(t=t||Object(c.a)(),!n||!Array.isArray(n))return{code:"INVALID_PARAM",message:"fileList必须是非空的数组"};var r=!0,o=!1,i=void 0;try{for(var s,u=n[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var f=s.value;if(!f||"string"!=typeof f)return{code:"INVALID_PARAM",message:"fileList的元素必须是非空的字符串"}}}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}var l={fileid_list:n};return new a.a(this.config).send("storage.batchDeleteFile",l).then(function(e){e.code?t(null,e):t(null,{fileList:e.data.delete_list,requestId:e.requestId})}).catch(function(e){t(e)}),t.promise},l=function(e,t){var n=e.fileList;t=t||Object(c.a)(),n&&Array.isArray(n)||t(null,{code:"INVALID_PARAM",message:"fileList必须是非空的数组"});var r=[],i=!0,s=!1,u=void 0;try{for(var f,l=n[Symbol.iterator]();!(i=(f=l.next()).done);i=!0){var h=f.value;"object"===o()(h)?(h.hasOwnProperty("fileID")&&h.hasOwnProperty("maxAge")||t(null,{code:"INVALID_PARAM",message:"fileList的元素必须是包含fileID和maxAge的对象"}),r.push({fileid:h.fileID,max_age:h.maxAge})):"string"==typeof h?r.push({fileid:h}):t(null,{code:"INVALID_PARAM",message:"fileList的元素必须是字符串"})}}catch(e){s=!0,u=e}finally{try{i||null==l.return||l.return()}finally{if(s)throw u}}var d={file_list:r};return new a.a(this.config).send("storage.batchGetDownloadUrl",d).then(function(e){e.code?t(null,e):t(null,{fileList:e.data.download_list,requestId:e.requestId})}).catch(function(e){t(e)}),t.promise},h=function(e,t){var n=e.fileID;return t=t||Object(c.a)(),l.call(this,{fileList:[{fileID:n,maxAge:600}]}).then(function(e){var n=e.fileList[0];if("SUCCESS"===n.code){var r=n.download_url;r=encodeURI(r),s.a.get(r,{responseType:"blob"}).then(function(e){var t=window.URL.createObjectURL(new Blob([e.data])),n=document.createElement("a");n.href=t,n.setAttribute("download","file.pdf"),document.body.appendChild(n),n.click()})}else t(n)}),t.promise}},function(e,t,n){var r=n(6).Symbol;e.exports=r},function(e,t,n){var r=n(11)(Object,"create");e.exports=r},function(e,t,n){var r=n(124),o=n(125),i=n(126),s=n(127),a=n(128);function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=s,c.prototype.set=a,e.exports=c},function(e,t,n){var r=n(60);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},function(e,t,n){var r=n(130);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},function(e,t,n){var r=n(33),o=n(56);e.exports=function(e,t,n,i){var s=!n;n||(n={});for(var a=-1,c=t.length;++a<c;){var u=t[a],f=i?i(n[u],e[u],u,n,e):void 0;void 0===f&&(f=e[u]),s?o(n,u,f):r(n,u,f)}return n}},function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return a});var r=n(3),o=n.n(r),i=n(4),s=n.n(i),a=function(){function t(e){o()(this,t),this.storageClass="local"===e?localStorage:"none"===e?new c:sessionStorage}return s()(t,[{key:"setStore",value:function(e,t,n){try{if(!this.storageClass)return}catch(e){return}var r,o={};o.version=n||"localCachev1",o.content=t,r=JSON.stringify(o);try{this.storageClass.setItem(e,r)}catch(e){return}}},{key:"getStore",value:function(t,n){try{if(e&&e.env&&e.env.tcb_token)return e.env.tcb_token;if(!this.storageClass)return}catch(e){return""}n=n||"localCachev1";var r=this.storageClass.getItem(t);return r&&r.indexOf(n)>=0?JSON.parse(r).content:""}},{key:"removeStore",value:function(e){this.storageClass.removeItem(e)}}]),t}(),c=function(){function e(){o()(this,e),window.tcbObject||(window.tcbObject={})}return s()(e,[{key:"setItem",value:function(e,t){window.tcbObject[e]=t}},{key:"getItem",value:function(e){return window.tcbObject[e]}},{key:"removeItem",value:function(e){delete window.tcbObject[e]}},{key:"clear",value:function(){delete window.tcbObject}}]),e}()}).call(this,n(51))},function(e,t,n){var r=n(46),o=n(100);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?o(e):t}},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t,n){var r=n(101);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=n(56),o=n(60),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var s=e[t];i.call(e,t)&&o(s,n)&&(void 0!==n||t in e)||r(e,t,n)}},function(e,t,n){var r=n(14),o=n(113),i=n(114),s=n(134);e.exports=function(e,t){return r(e)?e:o(e,t)?[e]:i(s(e))}},function(e,t,n){var r=n(19),o=n(15),i="[object Symbol]";e.exports=function(e){return"symbol"==typeof e||o(e)&&r(e)==i}},function(e,t,n){var r=n(11)(n(6),"Map");e.exports=r},function(e,t,n){var r=n(35),o=1/0;e.exports=function(e){if("string"==typeof e||r(e))return e;var t=e+"";return"0"==t&&1/e==-o?"-0":t}},function(e,t,n){var r=n(63),o=n(157),i=n(67);e.exports=function(e){return i(e)?r(e):o(e)}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){e.exports=function(e){return function(t){return e(t)}}},function(e,t,n){(function(e){var r=n(58),o=t&&!t.nodeType&&t,i=o&&"object"==typeof e&&e&&!e.nodeType&&e,s=i&&i.exports===o&&r.process,a=function(){try{var e=i&&i.require&&i.require("util").types;return e||s&&s.binding&&s.binding("util")}catch(e){}}();e.exports=a}).call(this,n(39)(e))},function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},function(e,t,n){var r=n(165),o=n(69),i=Object.prototype.propertyIsEnumerable,s=Object.getOwnPropertySymbols,a=s?function(e){return null==e?[]:(e=Object(e),r(s(e),function(t){return i.call(e,t)}))}:o;e.exports=a},function(e,t,n){var r=n(169),o=n(36),i=n(170),s=n(171),a=n(172),c=n(19),u=n(59),f=u(r),l=u(o),h=u(i),d=u(s),p=u(a),g=c;(r&&"[object DataView]"!=g(new r(new ArrayBuffer(1)))||o&&"[object Map]"!=g(new o)||i&&"[object Promise]"!=g(i.resolve())||s&&"[object Set]"!=g(new s)||a&&"[object WeakMap]"!=g(new a))&&(g=function(e){var t=c(e),n="[object Object]"==t?e.constructor:void 0,r=n?u(n):"";if(r)switch(r){case f:return"[object DataView]";case l:return"[object Map]";case h:return"[object Promise]";case d:return"[object Set]";case p:return"[object WeakMap]"}return t}),e.exports=g},function(e,t,n){var r=n(175);e.exports=function(e){var t=new e.constructor(e.byteLength);return new r(t).set(new r(e)),t}},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(t){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?e.exports=r=function(e){return n(e)}:e.exports=r=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)},r(t)}e.exports=r},function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},function(e,t,n){"use strict";var r=n(2);function o(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var i;if(n)i=n(t);else if(r.isURLSearchParams(t))i=t.toString();else{var s=[];r.forEach(t,function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),s.push(o(t)+"="+o(e))}))}),i=s.join("&")}if(i){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}},function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";(function(t){var r=n(2),o=n(89),i={"Content-Type":"application/x-www-form-urlencoded"};function s(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var a,c={adapter:(void 0!==t&&"[object process]"===Object.prototype.toString.call(t)?a=n(52):"undefined"!=typeof XMLHttpRequest&&(a=n(52)),a),transformRequest:[function(e,t){return o(t,"Accept"),o(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(s(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)?(s(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};c.headers={common:{Accept:"application/json, text/plain, */*"}},r.forEach(["delete","get","head"],function(e){c.headers[e]={}}),r.forEach(["post","put","patch"],function(e){c.headers[e]=r.merge(i)}),e.exports=c}).call(this,n(51))},function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var c,u=[],f=!1,l=-1;function h(){f&&c&&(f=!1,c.length?u=c.concat(u):l=-1,u.length&&d())}function d(){if(!f){var e=a(h);f=!0;for(var t=u.length;t;){for(c=u,u=[];++l<t;)c&&c[l].run();l=-1,t=u.length}c=null,f=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new p(e,t)),1!==u.length||f||a(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t,n){"use strict";var r=n(2),o=n(90),i=n(48),s=n(92),a=n(93),c=n(53);e.exports=function(e){return new Promise(function(t,u){var f=e.data,l=e.headers;r.isFormData(f)&&delete l["Content-Type"];var h=new XMLHttpRequest;if(e.auth){var d=e.auth.username||"",p=e.auth.password||"";l.Authorization="Basic "+btoa(d+":"+p)}if(h.open(e.method.toUpperCase(),i(e.url,e.params,e.paramsSerializer),!0),h.timeout=e.timeout,h.onreadystatechange=function(){if(h&&4===h.readyState&&(0!==h.status||h.responseURL&&0===h.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in h?s(h.getAllResponseHeaders()):null,r={data:e.responseType&&"text"!==e.responseType?h.response:h.responseText,status:h.status,statusText:h.statusText,headers:n,config:e,request:h};o(t,u,r),h=null}},h.onabort=function(){h&&(u(c("Request aborted",e,"ECONNABORTED",h)),h=null)},h.onerror=function(){u(c("Network Error",e,null,h)),h=null},h.ontimeout=function(){u(c("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",h)),h=null},r.isStandardBrowserEnv()){var g=n(94),_=(e.withCredentials||a(e.url))&&e.xsrfCookieName?g.read(e.xsrfCookieName):void 0;_&&(l[e.xsrfHeaderName]=_)}if("setRequestHeader"in h&&r.forEach(l,function(e,t){void 0===f&&"content-type"===t.toLowerCase()?delete l[t]:h.setRequestHeader(t,e)}),e.withCredentials&&(h.withCredentials=!0),e.responseType)try{h.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&h.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&h.upload&&h.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){h&&(h.abort(),u(e),h=null)}),void 0===f&&(f=null),h.send(f)})}},function(e,t,n){"use strict";var r=n(91);e.exports=function(e,t,n,o,i){var s=new Error(e);return r(s,t,n,o,i)}},function(e,t,n){"use strict";var r=n(2);e.exports=function(e,t){t=t||{};var n={};return r.forEach(["url","method","params","data"],function(e){void 0!==t[e]&&(n[e]=t[e])}),r.forEach(["headers","auth","proxy"],function(o){r.isObject(t[o])?n[o]=r.deepMerge(e[o],t[o]):void 0!==t[o]?n[o]=t[o]:r.isObject(e[o])?n[o]=r.deepMerge(e[o]):void 0!==e[o]&&(n[o]=e[o])}),r.forEach(["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"],function(r){void 0!==t[r]?n[r]=t[r]:void 0!==e[r]&&(n[r]=e[r])}),n}},function(e,t,n){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r},function(e,t,n){var r=n(106);e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},function(e,t,n){var r=n(19),o=n(13),i="[object AsyncFunction]",s="[object Function]",a="[object GeneratorFunction]",c="[object Proxy]";e.exports=function(e){if(!o(e))return!1;var t=r(e);return t==s||t==a||t==i||t==c}},function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,n(32))},function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t,n){var r=n(117),o=n(129),i=n(131),s=n(132),a=n(133);function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=s,c.prototype.set=a,e.exports=c},function(e,t){var n=9007199254740991,r=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var o=typeof e;return!!(t=null==t?n:t)&&("number"==o||"symbol"!=o&&r.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t,n){var r=n(151),o=n(152),i=n(14),s=n(64),a=n(62),c=n(155),u=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=i(e),f=!n&&o(e),l=!n&&!f&&s(e),h=!n&&!f&&!l&&c(e),d=n||f||l||h,p=d?r(e.length,String):[],g=p.length;for(var _ in e)!t&&!u.call(e,_)||d&&("length"==_||l&&("offset"==_||"parent"==_)||h&&("buffer"==_||"byteLength"==_||"byteOffset"==_)||a(_,g))||p.push(_);return p}},function(e,t,n){(function(e){var r=n(6),o=n(154),i=t&&!t.nodeType&&t,s=i&&"object"==typeof e&&e&&!e.nodeType&&e,a=s&&s.exports===i?r.Buffer:void 0,c=(a?a.isBuffer:void 0)||o;e.exports=c}).call(this,n(39)(e))},function(e,t){var n=9007199254740991;e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}},function(e,t){e.exports=function(e,t){return function(n){return e(t(n))}}},function(e,t,n){var r=n(57),o=n(65);e.exports=function(e){return null!=e&&o(e.length)&&!r(e)}},function(e,t,n){var r=n(63),o=n(160),i=n(67);e.exports=function(e){return i(e)?r(e,!0):o(e)}},function(e,t){e.exports=function(){return[]}},function(e,t,n){var r=n(71),o=n(72),i=n(43),s=n(69),a=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)r(t,i(e)),e=o(e);return t}:s;e.exports=a},function(e,t){e.exports=function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}},function(e,t,n){var r=n(66)(Object.getPrototypeOf,Object);e.exports=r},function(e,t,n){var r=n(71),o=n(14);e.exports=function(e,t,n){var i=t(e);return o(e)?i:r(i,n(e))}},function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,o="~";function i(){}function s(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function a(e,t,n,r,i){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new s(n,r||e,i),c=o?o+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function c(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function u(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(o=!1)),u.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)r.call(e,t)&&n.push(o?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},u.prototype.listeners=function(e){var t=o?o+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,i=n.length,s=new Array(i);r<i;r++)s[r]=n[r].fn;return s},u.prototype.listenerCount=function(e){var t=o?o+e:e,n=this._events[t];return n?n.fn?1:n.length:0},u.prototype.emit=function(e,t,n,r,i,s){var a=o?o+e:e;if(!this._events[a])return!1;var c,u,f=this._events[a],l=arguments.length;if(f.fn){switch(f.once&&this.removeListener(e,f.fn,void 0,!0),l){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,t),!0;case 3:return f.fn.call(f.context,t,n),!0;case 4:return f.fn.call(f.context,t,n,r),!0;case 5:return f.fn.call(f.context,t,n,r,i),!0;case 6:return f.fn.call(f.context,t,n,r,i,s),!0}for(u=1,c=new Array(l-1);u<l;u++)c[u-1]=arguments[u];f.fn.apply(f.context,c)}else{var h,d=f.length;for(u=0;u<d;u++)switch(f[u].once&&this.removeListener(e,f[u].fn,void 0,!0),l){case 1:f[u].fn.call(f[u].context);break;case 2:f[u].fn.call(f[u].context,t);break;case 3:f[u].fn.call(f[u].context,t,n);break;case 4:f[u].fn.call(f[u].context,t,n,r);break;default:if(!c)for(h=1,c=new Array(l-1);h<l;h++)c[h-1]=arguments[h];f[u].fn.apply(f[u].context,c)}}return!0},u.prototype.on=function(e,t,n){return a(this,e,t,n,!1)},u.prototype.once=function(e,t,n){return a(this,e,t,n,!0)},u.prototype.removeListener=function(e,t,n,r){var i=o?o+e:e;if(!this._events[i])return this;if(!t)return c(this,i),this;var s=this._events[i];if(s.fn)s.fn!==t||r&&!s.once||n&&s.context!==n||c(this,i);else{for(var a=0,u=[],f=s.length;a<f;a++)(s[a].fn!==t||r&&!s[a].once||n&&s[a].context!==n)&&u.push(s[a]);u.length?this._events[i]=1===u.length?u[0]:u:c(this,i)}return this},u.prototype.removeAllListeners=function(e){var t;return e?(t=o?o+e:e,this._events[t]&&c(this,t)):(this._events=new i,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=o,u.EventEmitter=u,e.exports=u},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(7),o=n(5),i=function(e,t){var n=e.name,i=e.data;t=t||Object(o.a)();try{i=i?JSON.stringify(i):""}catch(e){return Promise.reject(e)}if(!n)return Promise.reject(new Error("函数名不能为空"));var s={function_name:n,request_data:i};return new r.a(this.config).send("functions.invokeFunction",s).then(function(e){if(e.code)t(null,e);else{var n=e.data.response_data;try{n=JSON.parse(e.data.response_data),t(null,{result:n,requestId:e.requestId})}catch(e){t(new Error("response data must be json"))}}return t.promise}).catch(function(e){t(e)}),t.promise}},function(e,t,n){var r=n(105);e.exports=function(e,t,n){return null==e?e:r(e,t,n)}},function(e,t,n){var r=n(137);e.exports=function(e,t){return null==e||r(e,t)}},function(e,t,n){var r=n(142),o=1,i=4;e.exports=function(e){return r(e,o|i)}},function(e,t,n){"use strict";var r,o,i=n(16),s=n.n(i),a=n(0),c=n.n(a),u=n(1),f=n.n(u),l=n(3),h=n.n(l),d=n(4),p=n.n(d),g=n(29),_=n.n(g),y=n(30),m=n.n(y),b=n(31),v=n.n(b),w=n(5),E=n(7),S=n(28),O=n(9),T=function(){function e(t){h()(this,e),this.httpRequest=new E.a(t),this.cache=new S.a(t.persistence),this.accessTokenKey="".concat(O.a,"_").concat(t.env),this.accessTokenExpireKey="".concat(O.b,"_").concat(t.env),this.refreshTokenKey="".concat(O.d,"_").concat(t.env)}var t;return p()(e,[{key:"setRefreshToken",value:function(e){this.cache.removeStore(this.accessTokenKey),this.cache.removeStore(this.accessTokenExpireKey),this.cache.setStore(this.refreshTokenKey,e)}},{key:"getRefreshTokenByWXCode",value:(t=f()(c.a.mark(function e(t,n,r){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.httpRequest.send("auth.getJwt",{appid:t,loginType:n,code:r}).then(function(e){if(e.code)throw new Error("[tcb-js-sdk] 微信登录失败: ".concat(e.code));if(e.refresh_token)return{refreshToken:e.refresh_token};throw new Error("[tcb-js-sdk] getJwt未返回refreshToken")}));case 2:case"end":return e.stop()}},e,this)})),function(e,n,r){return t.apply(this,arguments)})}]),e}();!function(e){e.snsapi_base="snsapi_base",e.snsapi_userinfo="snsapi_userinfo",e.snsapi_login="snsapi_login"}(r||(r={})),function(e){e.redirect="redirect",e.prompt="prompt"}(o||(o={}));var A=function(e){function t(e,n,r,o,i){var s;return h()(this,t),(s=_()(this,m()(t).call(this,e))).config=e,s.appid=n,s.scope=r,s.state=i||"weixin",s.loginMode=o||"redirect",s}var n;return v()(t,e),p()(t,[{key:"signIn",value:(n=f()(c.a.mark(function e(){var t,n,o,i,s,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.cache.getStore(this.accessTokenKey),n=this.cache.getStore(this.accessTokenExpireKey),!t){e.next=9;break}if(!(n&&n>Date.now())){e.next=7;break}return e.abrupt("return",{credential:{accessToken:t,refreshToken:this.cache.getStore(this.refreshTokenKey)}});case 7:this.cache.removeStore(this.accessTokenKey),this.cache.removeStore(this.accessTokenExpireKey);case 9:if(!1!==Object.values(r).includes(r[this.scope])){e.next=11;break}throw new Error("错误的scope类型");case 11:if(o=w.b()){e.next=14;break}return e.abrupt("return",this.redirect());case 14:return i="snsapi_login"===this.scope?"WECHAT-OPEN":"WECHAT-PUBLIC",e.next=17,this.getRefreshTokenByWXCode(this.appid,i,o);case 17:return s=e.sent,a=s.refreshToken,this.cache.setStore(this.refreshTokenKey,a),e.abrupt("return",{credential:{refreshToken:a}});case 21:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"redirect",value:function(){var e=w.c("code",location.href);e=w.c("state",e),e=encodeURIComponent(e);var t="//open.weixin.qq.com/connect/oauth2/authorize";"snsapi_login"===this.scope&&(t="//open.weixin.qq.com/connect/qrconnect"),"redirect"===o[this.loginMode]&&(location.href="".concat(t,"?appid=").concat(this.appid,"&redirect_uri=").concat(e,"&response_type=code&scope=").concat(this.scope,"&state=").concat(this.state,"#wechat_redirect"))}}]),t}(T),N=n(12);function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}n.d(t,"a",function(){return B});var B=function(e){function t(e){var n;return h()(this,t),(n=_()(this,m()(t).call(this,e))).config=e,n.customAuthProvider=new T(n.config),n}var n,r,o,i;return v()(t,e),p()(t,[{key:"weixinAuthProvider",value:function(e){var t=e.appid,n=e.scope,r=e.loginMode,o=e.state;return new A(this.config,t,n,r,o)}},{key:"signOut",value:(i=f()(c.a.mark(function e(){var t,n,r,o,i;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.httpRequest,n=t.cache,r=t.refreshTokenKey,o=t.accessTokenKey,i=t.accessTokenExpireKey,e.next=4,this.httpRequest.send("auth.logout",{refresh_token:n.getStore(r)});case 4:return n.removeStore(r),n.removeStore(o),n.removeStore(i),e.abrupt("return");case 8:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)})},{key:"getAccessToken",value:(o=f()(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.httpRequest.getAccessToken();case 2:return e.t0=e.sent.accessToken,e.t1=this.config.env,e.abrupt("return",{accessToken:e.t0,env:e.t1});case 5:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)})},{key:"onLoginStateExpire",value:function(e){Object(N.b)("loginStateExpire",e)}},{key:"getLoginState",value:(r=f()(c.a.mark(function e(){var t,n,r,o,i;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.httpRequest,n=t.cache,r=t.refreshTokenKey,o=t.accessTokenKey,!(i=n.getStore(r))){e.next=14;break}return e.prev=3,e.next=6,this.httpRequest.refreshAccessToken();case 6:e.next=11;break;case 8:return e.prev=8,e.t0=e.catch(3),e.abrupt("return");case 11:return e.abrupt("return",{credential:{refreshToken:i,accessToken:n.getStore(o)}});case 14:return e.abrupt("return");case 15:case"end":return e.stop()}},e,this,[[3,8]])})),function(){return r.apply(this,arguments)})},{key:"signInWithTicket",value:(n=f()(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t){e.next=2;break}throw new Error("ticket must be a string");case 2:return e.next=4,this.httpRequest.send("auth.signInWithTicket",{ticket:t});case 4:if(!(n=e.sent).refresh_token){e.next=10;break}return this.customAuthProvider.setRefreshToken(n.refresh_token),e.abrupt("return",{credential:{refreshToken:n.refresh_token}});case 10:throw new Error("[tcb-js-sdk] 自定义登录失败");case 11:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"shouldRefreshAccessToken",value:function(e){this.httpRequest._shouldRefreshAccessTokenHook=e.bind(this)}},{key:"getUserInfo",value:function(){return this.httpRequest.send("auth.getUserInfo",{}).then(function(e){return e.code?e:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(n,!0).forEach(function(t){s()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e.data,{requestId:e.seqId})})}}]),t}(T)},function(e,t,n){e.exports=n(81)},function(e,t,n){"use strict";n.r(t),function(e){var r=n(16),o=n.n(r),i=n(3),s=n.n(i),a=n(4),c=n.n(a),u=n(21),f=n(79),l=n(75),h=n(7),d=n(12),p=n(18);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var _=new(function(){function e(t){s()(this,e),this.config=t||this.config,this.authObj=void 0}return c()(e,[{key:"init",value:function(t){return this.config={env:t.env,timeout:t.timeout||15e3},new e(this.config)}},{key:"database",value:function(e){if(p.a.reqClass=h.a,this.authObj)return p.a.getAccessToken=this.authObj.getAccessToken.bind(this.authObj),p.a.ws||(p.a.ws=null),new p.a(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(n,!0).forEach(function(t){o()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},this.config,{},e));console.warn("需要app.auth()授权")}},{key:"auth",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.persistence;return this.authObj?(console.warn("tcb实例只存在一个auth对象"),this.authObj):(Object.assign(this.config,{persistence:t||"session"}),this.authObj=new f.a(this.config),this.authObj)}},{key:"on",value:function(e,t){return d.b.apply(this,[e,t])}},{key:"callFunction",value:function(e,t){return l.a.apply(this,[e,t])}},{key:"deleteFile",value:function(e,t){return u.a.apply(this,[e,t])}},{key:"getTempFileURL",value:function(e,t){return u.c.apply(this,[e,t])}},{key:"downloadFile",value:function(e,t){return u.b.apply(this,[e,t])}},{key:"uploadFile",value:function(e,t){return u.d.apply(this,[e,t])}}]),e}());try{window.tcb=_}catch(e){}t.default=_,e.exports=_}.call(this,n(82)(e))},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,n){"use strict";var r=n(2),o=n(47),i=n(85),s=n(54);function a(e){var t=new i(e),n=o(i.prototype.request,t);return r.extend(n,i.prototype,t),r.extend(n,t),n}var c=a(n(50));c.Axios=i,c.create=function(e){return a(s(c.defaults,e))},c.Cancel=n(55),c.CancelToken=n(97),c.isCancel=n(49),c.all=function(e){return Promise.all(e)},c.spread=n(98),e.exports=c,e.exports.default=c},function(e,t){
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}},function(e,t,n){"use strict";var r=n(2),o=n(48),i=n(86),s=n(87),a=n(54);function c(e){this.defaults=e,this.interceptors={request:new i,response:new i}}c.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=a(this.defaults,e)).method=e.method?e.method.toLowerCase():"get";var t=[s,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)n=n.then(t.shift(),t.shift());return n},c.prototype.getUri=function(e){return e=a(this.defaults,e),o(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],function(e){c.prototype[e]=function(t,n){return this.request(r.merge(n||{},{method:e,url:t}))}}),r.forEach(["post","put","patch"],function(e){c.prototype[e]=function(t,n,o){return this.request(r.merge(o||{},{method:e,url:t,data:n}))}}),e.exports=c},function(e,t,n){"use strict";var r=n(2);function o(){this.handlers=[]}o.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},o.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},o.prototype.forEach=function(e){r.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=o},function(e,t,n){"use strict";var r=n(2),o=n(88),i=n(49),s=n(50),a=n(95),c=n(96);function u(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return u(e),e.baseURL&&!a(e.url)&&(e.url=c(e.baseURL,e.url)),e.headers=e.headers||{},e.data=o(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),r.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]}),(e.adapter||s.adapter)(e).then(function(t){return u(e),t.data=o(t.data,t.headers,e.transformResponse),t},function(t){return i(t)||(u(e),t&&t.response&&(t.response.data=o(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},function(e,t,n){"use strict";var r=n(2);e.exports=function(e,t,n){return r.forEach(n,function(n){e=n(e,t)}),e}},function(e,t,n){"use strict";var r=n(2);e.exports=function(e,t){r.forEach(e,function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])})}},function(e,t,n){"use strict";var r=n(53);e.exports=function(e,t,n){var o=n.config.validateStatus;!o||o(n.status)?e(n):t(r("Request failed with status code "+n.status,n.config,null,n.request,n))}},function(e,t,n){"use strict";e.exports=function(e,t,n,r,o){return e.config=t,n&&(e.code=n),e.request=r,e.response=o,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},function(e,t,n){"use strict";var r=n(2),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,i,s={};return e?(r.forEach(e.split("\n"),function(e){if(i=e.indexOf(":"),t=r.trim(e.substr(0,i)).toLowerCase(),n=r.trim(e.substr(i+1)),t){if(s[t]&&o.indexOf(t)>=0)return;s[t]="set-cookie"===t?(s[t]?s[t]:[]).concat([n]):s[t]?s[t]+", "+n:n}}),s):s}},function(e,t,n){"use strict";var r=n(2);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function o(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=o(window.location.href),function(t){var n=r.isString(t)?o(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},function(e,t,n){"use strict";var r=n(2);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,o,i,s){var a=[];a.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),r.isString(o)&&a.push("path="+o),r.isString(i)&&a.push("domain="+i),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";var r=n(55);function o(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var n=this;e(function(e){n.reason||(n.reason=new r(e),t(n.reason))})}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.source=function(){var e;return{token:new o(function(t){e=t}),cancel:e}},e.exports=o},function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,n){var r=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",a=o.toStringTag||"@@toStringTag";function c(e,t,n,r){var o=t&&t.prototype instanceof g?t:g,i=Object.create(o.prototype),s=new N(r||[]);return i._invoke=function(e,t,n){var r=f;return function(o,i){if(r===h)throw new Error("Generator is already running");if(r===d){if("throw"===o)throw i;return B()}for(n.method=o,n.arg=i;;){var s=n.delegate;if(s){var a=O(s,n);if(a){if(a===p)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=h;var c=u(e,t,n);if("normal"===c.type){if(r=n.done?d:l,c.arg===p)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=d,n.method="throw",n.arg=c.arg)}}}(e,n,s),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var f="suspendedStart",l="suspendedYield",h="executing",d="completed",p={};function g(){}function _(){}function y(){}var m={};m[i]=function(){return this};var b=Object.getPrototypeOf,v=b&&b(b(I([])));v&&v!==n&&r.call(v,i)&&(m=v);var w=y.prototype=g.prototype=Object.create(m);function E(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function S(e){var t;this._invoke=function(n,o){function i(){return new Promise(function(t,i){!function t(n,o,i,s){var a=u(e[n],e,o);if("throw"!==a.type){var c=a.arg,f=c.value;return f&&"object"==typeof f&&r.call(f,"__await")?Promise.resolve(f.__await).then(function(e){t("next",e,i,s)},function(e){t("throw",e,i,s)}):Promise.resolve(f).then(function(e){c.value=e,i(c)},function(e){return t("throw",e,i,s)})}s(a.arg)}(n,o,t,i)})}return t=t?t.then(i,i):i()}}function O(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method))return p;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var o=u(r,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,p;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,p):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function I(e){if(e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,s=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return s.next=s}}return{next:B}}function B(){return{value:t,done:!0}}return _.prototype=w.constructor=y,y.constructor=_,y[a]=_.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,a in e||(e[a]="GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},E(S.prototype),S.prototype[s]=function(){return this},e.AsyncIterator=S,e.async=function(t,n,r,o){var i=new S(c(t,n,r,o));return e.isGeneratorFunction(n)?i:i.next().then(function(e){return e.done?e.value:i.next()})},E(w),w[a]="Generator",w[i]=function(){return this},w.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=I,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return a.type="throw",a.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],a=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=r.call(s,"catchLoc"),u=r.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;A(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:I(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),p}},e}(e.exports);try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,r)}e.exports=n},function(e,t,n){"use strict";t.byteLength=function(e){var t=u(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=u(e),s=r[0],a=r[1],c=new i(function(e,t,n){return 3*(t+n)/4-n}(0,s,a)),f=0,l=a>0?s-4:s;for(n=0;n<l;n+=4)t=o[e.charCodeAt(n)]<<18|o[e.charCodeAt(n+1)]<<12|o[e.charCodeAt(n+2)]<<6|o[e.charCodeAt(n+3)],c[f++]=t>>16&255,c[f++]=t>>8&255,c[f++]=255&t;2===a&&(t=o[e.charCodeAt(n)]<<2|o[e.charCodeAt(n+1)]>>4,c[f++]=255&t);1===a&&(t=o[e.charCodeAt(n)]<<10|o[e.charCodeAt(n+1)]<<4|o[e.charCodeAt(n+2)]>>2,c[f++]=t>>8&255,c[f++]=255&t);return c},t.fromByteArray=function(e){for(var t,n=e.length,o=n%3,i=[],s=0,a=n-o;s<a;s+=16383)i.push(f(e,s,s+16383>a?a:s+16383));1===o?(t=e[n-1],i.push(r[t>>2]+r[t<<4&63]+"==")):2===o&&(t=(e[n-2]<<8)+e[n-1],i.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return i.join("")};for(var r=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,c=s.length;a<c;++a)r[a]=s[a],o[s.charCodeAt(a)]=a;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function f(e,t,n){for(var o,i,s=[],a=t;a<n;a+=3)o=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(r[(i=o)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return s.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,o){var i,s,a=8*o-r-1,c=(1<<a)-1,u=c>>1,f=-7,l=n?o-1:0,h=n?-1:1,d=e[t+l];for(l+=h,i=d&(1<<-f)-1,d>>=-f,f+=a;f>0;i=256*i+e[t+l],l+=h,f-=8);for(s=i&(1<<-f)-1,i>>=-f,f+=r;f>0;s=256*s+e[t+l],l+=h,f-=8);if(0===i)i=1-u;else{if(i===c)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,r),i-=u}return(d?-1:1)*s*Math.pow(2,i-r)},t.write=function(e,t,n,r,o,i){var s,a,c,u=8*i-o-1,f=(1<<u)-1,l=f>>1,h=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:i-1,p=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=f):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+l>=1?h/c:h*Math.pow(2,1-l))*c>=2&&(s++,c/=2),s+l>=f?(a=0,s=f):s+l>=1?(a=(t*c-1)*Math.pow(2,o),s+=l):(a=t*Math.pow(2,l-1)*Math.pow(2,o),s=0));o>=8;e[n+d]=255&a,d+=p,a/=256,o-=8);for(s=s<<o|a,u+=o;u>0;e[n+d]=255&s,d+=p,s/=256,u-=8);e[n+d-p]|=128*g}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){var r=n(33),o=n(34),i=n(62),s=n(13),a=n(37);e.exports=function(e,t,n,c){if(!s(e))return e;for(var u=-1,f=(t=o(t,e)).length,l=f-1,h=e;null!=h&&++u<f;){var d=a(t[u]),p=n;if(u!=l){var g=h[d];void 0===(p=c?c(g,d,h):void 0)&&(p=s(g)?g:i(t[u+1])?[]:{})}r(h,d,p),h=h[d]}return e}},function(e,t,n){var r=n(11),o=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=o},function(e,t,n){var r=n(57),o=n(110),i=n(13),s=n(59),a=/^\[object .+?Constructor\]$/,c=Function.prototype,u=Object.prototype,f=c.toString,l=u.hasOwnProperty,h=RegExp("^"+f.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!i(e)||o(e))&&(r(e)?h:a).test(s(e))}},function(e,t,n){var r=n(22),o=Object.prototype,i=o.hasOwnProperty,s=o.toString,a=r?r.toStringTag:void 0;e.exports=function(e){var t=i.call(e,a),n=e[a];try{e[a]=void 0;var r=!0}catch(e){}var o=s.call(e);return r&&(t?e[a]=n:delete e[a]),o}},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t,n){var r,o=n(111),i=(r=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";e.exports=function(e){return!!i&&i in e}},function(e,t,n){var r=n(6)["__core-js_shared__"];e.exports=r},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t,n){var r=n(14),o=n(35),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;e.exports=function(e,t){if(r(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!o(e))||(s.test(e)||!i.test(e)||null!=t&&e in Object(t))}},function(e,t,n){var r=n(115),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,s=r(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(o,function(e,n,r,o){t.push(r?o.replace(i,"$1"):n||e)}),t});e.exports=s},function(e,t,n){var r=n(116),o=500;e.exports=function(e){var t=r(e,function(e){return n.size===o&&n.clear(),e}),n=t.cache;return t}},function(e,t,n){var r=n(61),o="Expected a function";function i(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(o);var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var s=e.apply(this,r);return n.cache=i.set(o,s)||i,s};return n.cache=new(i.Cache||r),n}i.Cache=r,e.exports=i},function(e,t,n){var r=n(118),o=n(24),i=n(36);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(i||o),string:new r}}},function(e,t,n){var r=n(119),o=n(120),i=n(121),s=n(122),a=n(123);function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=s,c.prototype.set=a,e.exports=c},function(e,t,n){var r=n(23);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},function(e,t,n){var r=n(23),o="__lodash_hash_undefined__",i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return n===o?void 0:n}return i.call(t,e)?t[e]:void 0}},function(e,t,n){var r=n(23),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:o.call(t,e)}},function(e,t,n){var r=n(23),o="__lodash_hash_undefined__";e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?o:t,this}},function(e,t){e.exports=function(){this.__data__=[],this.size=0}},function(e,t,n){var r=n(25),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0)&&(n==t.length-1?t.pop():o.call(t,n,1),--this.size,!0)}},function(e,t,n){var r=n(25);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},function(e,t,n){var r=n(25);e.exports=function(e){return r(this.__data__,e)>-1}},function(e,t,n){var r=n(25);e.exports=function(e,t){var n=this.__data__,o=r(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this}},function(e,t,n){var r=n(26);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},function(e,t){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},function(e,t,n){var r=n(26);e.exports=function(e){return r(this,e).get(e)}},function(e,t,n){var r=n(26);e.exports=function(e){return r(this,e).has(e)}},function(e,t,n){var r=n(26);e.exports=function(e,t){var n=r(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this}},function(e,t,n){var r=n(135);e.exports=function(e){return null==e?"":r(e)}},function(e,t,n){var r=n(22),o=n(136),i=n(14),s=n(35),a=1/0,c=r?r.prototype:void 0,u=c?c.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(i(t))return o(t,e)+"";if(s(t))return u?u.call(t):"";var n=t+"";return"0"==n&&1/t==-a?"-0":n}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}},function(e,t,n){var r=n(34),o=n(138),i=n(139),s=n(37);e.exports=function(e,t){return t=r(t,e),null==(e=i(e,t))||delete e[s(o(t))]}},function(e,t){e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},function(e,t,n){var r=n(140),o=n(141);e.exports=function(e,t){return t.length<2?e:r(e,o(t,0,-1))}},function(e,t,n){var r=n(34),o=n(37);e.exports=function(e,t){for(var n=0,i=(t=r(t,e)).length;null!=e&&n<i;)e=e[o(t[n++])];return n&&n==i?e:void 0}},function(e,t){e.exports=function(e,t,n){var r=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var i=Array(o);++r<o;)i[r]=e[r+t];return i}},function(e,t,n){var r=n(143),o=n(149),i=n(33),s=n(150),a=n(159),c=n(162),u=n(163),f=n(164),l=n(166),h=n(167),d=n(168),p=n(44),g=n(173),_=n(174),y=n(180),m=n(14),b=n(64),v=n(182),w=n(13),E=n(184),S=n(38),O=1,T=2,A=4,N="[object Arguments]",I="[object Function]",B="[object GeneratorFunction]",R="[object Object]",D={};D[N]=D["[object Array]"]=D["[object ArrayBuffer]"]=D["[object DataView]"]=D["[object Boolean]"]=D["[object Date]"]=D["[object Float32Array]"]=D["[object Float64Array]"]=D["[object Int8Array]"]=D["[object Int16Array]"]=D["[object Int32Array]"]=D["[object Map]"]=D["[object Number]"]=D[R]=D["[object RegExp]"]=D["[object Set]"]=D["[object String]"]=D["[object Symbol]"]=D["[object Uint8Array]"]=D["[object Uint8ClampedArray]"]=D["[object Uint16Array]"]=D["[object Uint32Array]"]=!0,D["[object Error]"]=D[I]=D["[object WeakMap]"]=!1,e.exports=function e(t,n,x,P,C,j){var L,k=n&O,$=n&T,M=n&A;if(x&&(L=C?x(t,P,C,j):x(t)),void 0!==L)return L;if(!w(t))return t;var U=m(t);if(U){if(L=g(t),!k)return u(t,L)}else{var F=p(t),z=F==I||F==B;if(b(t))return c(t,k);if(F==R||F==N||z&&!C){if(L=$||z?{}:y(t),!k)return $?l(t,a(L,t)):f(t,s(L,t))}else{if(!D[F])return C?t:{};L=_(t,F,k)}}j||(j=new r);var q=j.get(t);if(q)return q;j.set(t,L),E(t)?t.forEach(function(r){L.add(e(r,n,x,r,t,j))}):v(t)&&t.forEach(function(r,o){L.set(o,e(r,n,x,o,t,j))});var W=M?$?d:h:$?keysIn:S,Y=U?void 0:W(t);return o(Y||t,function(r,o){Y&&(r=t[o=r]),i(L,o,e(r,n,x,o,t,j))}),L}},function(e,t,n){var r=n(24),o=n(144),i=n(145),s=n(146),a=n(147),c=n(148);function u(e){var t=this.__data__=new r(e);this.size=t.size}u.prototype.clear=o,u.prototype.delete=i,u.prototype.get=s,u.prototype.has=a,u.prototype.set=c,e.exports=u},function(e,t,n){var r=n(24);e.exports=function(){this.__data__=new r,this.size=0}},function(e,t){e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},function(e,t){e.exports=function(e){return this.__data__.get(e)}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t,n){var r=n(24),o=n(36),i=n(61),s=200;e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var a=n.__data__;if(!o||a.length<s-1)return a.push([e,t]),this.size=++n.size,this;n=this.__data__=new i(a)}return n.set(e,t),this.size=n.size,this}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}},function(e,t,n){var r=n(27),o=n(38);e.exports=function(e,t){return e&&r(t,o(t),e)}},function(e,t){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},function(e,t,n){var r=n(153),o=n(15),i=Object.prototype,s=i.hasOwnProperty,a=i.propertyIsEnumerable,c=r(function(){return arguments}())?r:function(e){return o(e)&&s.call(e,"callee")&&!a.call(e,"callee")};e.exports=c},function(e,t,n){var r=n(19),o=n(15),i="[object Arguments]";e.exports=function(e){return o(e)&&r(e)==i}},function(e,t){e.exports=function(){return!1}},function(e,t,n){var r=n(156),o=n(40),i=n(41),s=i&&i.isTypedArray,a=s?o(s):r;e.exports=a},function(e,t,n){var r=n(19),o=n(65),i=n(15),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,e.exports=function(e){return i(e)&&o(e.length)&&!!s[r(e)]}},function(e,t,n){var r=n(42),o=n(158),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return o(e);var t=[];for(var n in Object(e))i.call(e,n)&&"constructor"!=n&&t.push(n);return t}},function(e,t,n){var r=n(66)(Object.keys,Object);e.exports=r},function(e,t,n){var r=n(27),o=n(68);e.exports=function(e,t){return e&&r(t,o(t),e)}},function(e,t,n){var r=n(13),o=n(42),i=n(161),s=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return i(e);var t=o(e),n=[];for(var a in e)("constructor"!=a||!t&&s.call(e,a))&&n.push(a);return n}},function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},function(e,t,n){(function(e){var r=n(6),o=t&&!t.nodeType&&t,i=o&&"object"==typeof e&&e&&!e.nodeType&&e,s=i&&i.exports===o?r.Buffer:void 0,a=s?s.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=a?a(n):new e.constructor(n);return e.copy(r),r}}).call(this,n(39)(e))},function(e,t){e.exports=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}},function(e,t,n){var r=n(27),o=n(43);e.exports=function(e,t){return r(e,o(e),t)}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=0,i=[];++n<r;){var s=e[n];t(s,n,e)&&(i[o++]=s)}return i}},function(e,t,n){var r=n(27),o=n(70);e.exports=function(e,t){return r(e,o(e),t)}},function(e,t,n){var r=n(73),o=n(43),i=n(38);e.exports=function(e){return r(e,i,o)}},function(e,t,n){var r=n(73),o=n(70),i=n(68);e.exports=function(e){return r(e,i,o)}},function(e,t,n){var r=n(11)(n(6),"DataView");e.exports=r},function(e,t,n){var r=n(11)(n(6),"Promise");e.exports=r},function(e,t,n){var r=n(11)(n(6),"Set");e.exports=r},function(e,t,n){var r=n(11)(n(6),"WeakMap");e.exports=r},function(e,t){var n=Object.prototype.hasOwnProperty;e.exports=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&n.call(e,"index")&&(r.index=e.index,r.input=e.input),r}},function(e,t,n){var r=n(45),o=n(176),i=n(177),s=n(178),a=n(179),c="[object Boolean]",u="[object Date]",f="[object Map]",l="[object Number]",h="[object RegExp]",d="[object Set]",p="[object String]",g="[object Symbol]",_="[object ArrayBuffer]",y="[object DataView]",m="[object Float32Array]",b="[object Float64Array]",v="[object Int8Array]",w="[object Int16Array]",E="[object Int32Array]",S="[object Uint8Array]",O="[object Uint8ClampedArray]",T="[object Uint16Array]",A="[object Uint32Array]";e.exports=function(e,t,n){var N=e.constructor;switch(t){case _:return r(e);case c:case u:return new N(+e);case y:return o(e,n);case m:case b:case v:case w:case E:case S:case O:case T:case A:return a(e,n);case f:return new N;case l:case p:return new N(e);case h:return i(e);case d:return new N;case g:return s(e)}}},function(e,t,n){var r=n(6).Uint8Array;e.exports=r},function(e,t,n){var r=n(45);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}},function(e,t){var n=/\w*$/;e.exports=function(e){var t=new e.constructor(e.source,n.exec(e));return t.lastIndex=e.lastIndex,t}},function(e,t,n){var r=n(22),o=r?r.prototype:void 0,i=o?o.valueOf:void 0;e.exports=function(e){return i?Object(i.call(e)):{}}},function(e,t,n){var r=n(45);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},function(e,t,n){var r=n(181),o=n(72),i=n(42);e.exports=function(e){return"function"!=typeof e.constructor||i(e)?{}:r(o(e))}},function(e,t,n){var r=n(13),o=Object.create,i=function(){function e(){}return function(t){if(!r(t))return{};if(o)return o(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();e.exports=i},function(e,t,n){var r=n(183),o=n(40),i=n(41),s=i&&i.isMap,a=s?o(s):r;e.exports=a},function(e,t,n){var r=n(44),o=n(15),i="[object Map]";e.exports=function(e){return o(e)&&r(e)==i}},function(e,t,n){var r=n(185),o=n(40),i=n(41),s=i&&i.isSet,a=s?o(s):r;e.exports=a},function(e,t,n){var r=n(44),o=n(15),i="[object Set]";e.exports=function(e){return o(e)&&r(e)==i}}])});